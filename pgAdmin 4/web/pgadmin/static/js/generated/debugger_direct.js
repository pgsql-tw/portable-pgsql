define(["translations","pgadmin.browser.endpoints","pgadmin.browser.utils","pgadmin.browser.messages"],(function(e,t,r,n){return function(e){function t(t){for(var n,o,s=t[0],l=t[1],u=t[2],c=0,f=[];c<s.length;c++)o=s[c],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(d&&d(t);f.length;)f.shift()();return i.push.apply(i,u||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,s=1;s<r.length;s++){var l=r[s];0!==a[l]&&(n=!1)}n&&(i.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},a={7:0},i=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",Object.defineProperty(o,"p",{get:function(){try{if("function"!=typeof getChunkURL)throw new Error("WebpackRequireFrom: 'getChunkURL' is not a function or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");return getChunkURL()}catch(e){return""}}});var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var d=l;return i.push([233,2,3,1,0]),r()}({107:function(e,t,r){"use strict";r(108),r(11),r(4),Object.defineProperty(t,"__esModule",{value:!0}),t.initializeToolbar=function(e,t){l=e,a.default.each(u,(function(e){c(e)})),a.default.each(d,(function(e){c(e)})),e.on(t.EVENT.BUTTON,(function(e){"name"in e&&e.name===(0,n.default)("Query Tool")?i.default.DataGrid.show_query_tool("",i.default.Browser.tree.selected()):"name"in e&&e.name===(0,n.default)("View Data")?i.default.DataGrid.show_data_grid({mnuid:3},i.default.Browser.tree.selected()):"name"in e&&e.name===(0,n.default)("Filtered Rows")&&i.default.DataGrid.show_filtered_row({mnuid:4},i.default.Browser.tree.selected())}))},t.enable=function(e,t){e in s?l.buttonEnable(e,t):console.warn("Developer warning: No tool button found with label: "+e)};var n=o(r(2)),a=o(r(1)),i=o(r(3));function o(e){return e&&e.__esModule?e:{default:e}}var s={},l=null,u=[{label:(0,n.default)("Query Tool"),ariaLabel:(0,n.default)("Query Tool"),btnClass:"pg-font-icon icon-query-tool",text:"",toggled:!1,toggleClass:"",parentClass:"pg-toolbar-btn btn-secondary",enabled:!1},{label:(0,n.default)("View Data"),ariaLabel:(0,n.default)("View Data"),btnClass:"fa fa-table",text:"",toggled:!1,toggleClass:"",parentClass:"pg-toolbar-btn btn-secondary",enabled:!1},{label:(0,n.default)("Filtered Rows"),ariaLabel:(0,n.default)("Filtered Rows"),btnClass:"pg-font-icon icon-filter-table-toolbar",text:"",toggled:!1,toggleClass:"",parentClass:"pg-toolbar-btn btn-secondary",enabled:!1}],d=[];function c(e){e.label in s&&!(a.default.findIndex(l._buttonList,{name:e.label})<0)||(l.addButton(e.label,e.btnClass,e.text,e.label,e.toggled,e.toggleClass,e.parentClass,e.enabled,e.ariaLabel),s[e.label]=e)}},109:function(e,t,r){"use strict";r(8),r(15),r(4),r(7);var n=o(r(0)),a=o(r(96)),i=r(22);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dialogContainer=t,this.tabSwitching=!1,this.tabs=this.dialogContainer.find(".nav-tabs:visible"),this.tabs.length>0&&(this.tabs=this.tabs[0]),this.dialogTabBackward=(0,i.parseShortcutValue)(r),this.dialogTabForward=(0,i.parseShortcutValue)(n),(0,a.default)(this.dialogContainer[0]).bind(this.dialogTabBackward,this.onKeyboardEvent.bind(this)),(0,a.default)(this.dialogContainer[0]).bind(this.dialogTabForward,this.onKeyboardEvent.bind(this))}var t,r,o;return t=e,(r=[{key:"onKeyboardEvent",value:function(e,t){var r=this.dialogContainer.find(".tab-content:first > .tab-pane.active:first:visible"),n=this.isActivePaneHasChildTabs(r);this.tabSwitching||(this.tabSwitching=!0,n&&this.navigate(t,n.childTab,n.childTabPane,e)||this.navigate(t,this.tabs,r,e))}},{key:"isActivePaneHasChildTabs",value:function(e){var t=e.find(".nav-tabs:first:visible");return t.length>0?{childTab:t,childTabPane:e.find(".tab-content:first > .tab-pane.active:first:visible")}:null}},{key:"navigate",value:function(e,t,r,n){return e==this.dialogTabBackward?this.navigateBackward(t,r,n):e==this.dialogTabForward&&this.navigateForward(t,r,n)}},{key:"navigateBackward",value:function(e,t,r){var a,o,s=this,l=(0,n.default)(e).find("li").has("a.active").prev("li");return l.length>0?(l.find("a").tab("show"),(o=(a=t.prev()).find(".tab-content:first > .tab-pane.active:first:visible")).length>0?(0,i.findAndSetFocus)(o):(0,i.findAndSetFocus)(a),setTimeout((function(){s.tabSwitching=!1}),200),r.stopPropagation(),!0):(this.tabSwitching=!1,!1)}},{key:"navigateForward",value:function(e,t,r){var a,o,s=this,l=(0,n.default)(e).find("li").has("a.active").next("li");return l.length>0?(l.find("a").tab("show"),(o=(a=t.next()).find(".tab-content:first > .tab-pane.active:first:visible")).length>0?(0,i.findAndSetFocus)(o):(0,i.findAndSetFocus)(a),setTimeout((function(){s.tabSwitching=!1}),200),r.stopPropagation(),!0):(this.tabSwitching=!1,!1)}},{key:"detach",value:function(){(0,a.default)(this.dialogContainer[0]).unbind(this.dialogTabBackward),(0,a.default)(this.dialogContainer[0]).unbind(this.dialogTabForward)}}])&&s(t.prototype,r),o&&s(t,o),e}();e.exports={dialogTabNavigator:l}},117:function(e,t,r){"use strict";(function(e){r(19),r(26),r(27),r(38),r(8),r(42),r(17),r(21),r(15),r(118),r(62),r(4),r(31),r(63),r(41),r(12),r(5),r(23),r(9),r(29),r(74),r(50),r(20),r(7),Object.defineProperty(t,"__esModule",{value:!0}),t.isValidTreeNodeData=t.Tree=t.TreeNode=void 0;var n=r(22),a=o(r(0)),i=o(r(13));function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e}var g=function(){function e(t,r,n,a){d(this,e),this.id=t,this.data=r,this.setParent(a),this.children=[],this.domNode=n}return f(e,[{key:"hasParent",value:function(){return null!==this.parentNode&&void 0!==this.parentNode}},{key:"parent",value:function(){return this.parentNode}},{key:"setParent",value:function(e){this.parentNode=e,this.path=this.id,null!=e&&void 0!==e.path&&(this.path=e.path+"."+this.id)}},{key:"getData",value:function(){if(void 0!==this.data)return null===this.data?null:Object.assign({},this.data)}},{key:"getHtmlIdentifier",value:function(){return this.domNode}},{key:"reload",value:function(e){var t=this;this.unload(e),e.aciTreeApi.setInode(this.domNode),e.aciTreeApi.deselect(this.domNode),setTimeout((function(){e.selectNode(t.domNode)}),0)}},{key:"unload",value:function(e){this.children=[],e.aciTreeApi.unload(this.domNode)}},{key:"ancestorNode",value:function(e){for(var t=this;t.hasParent();)if(e(t=t.parent()))return t;return null}},{key:"anyFamilyMember",value:function(e){return!!e(this)||null!==this.ancestorNode(e)}},{key:"anyParent",value:function(e){return null!==this.ancestorNode(e)}}]),e}();t.TreeNode=g;var p=function(){function t(){d(this,t),this.rootNode=new g(void 0,{}),this.aciTreeApi=void 0,this.draggableTypes={}}return f(t,[{key:"registerDraggableType",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;"object"==u(e)?Object.keys(e).forEach((function(r){t.registerDraggableType(r,e[r])})):null!=r&&e.replace(/ +/," ").split(" ").forEach((function(e){t.draggableTypes[e]=r}))}},{key:"getDraggable",value:function(e){return this.draggableTypes[e]?this.draggableTypes[e]:null}},{key:"prepareDraggable",value:function(t,r){var n=this.getDraggable(t._type);null!=n&&r.find(".aciTreeItem").attr("draggable",!0)[0].addEventListener("dragstart",(function(i){var o=n(t,r);if("string"==typeof o?o={text:o,cur:{from:o.length,to:o.length}}:o.cur||(o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},o,{cur:{from:o.text.length,to:o.text.length}})),i.dataTransfer.setData("text",JSON.stringify(o)),i.dataTransfer.dropEffect&&(i.dataTransfer.dropEffect="move"),i.dataTransfer.setDragImage){var u=(0,a.default)('\n              <div class="drag-tree-node">\n                <span>'.concat(e.escape(o.text),"</span>\n              </div>"));(0,a.default)("body .drag-tree-node").remove(),(0,a.default)("body").append(u),i.dataTransfer.setDragImage(u[0],0,0)}}))}},{key:"addNewNode",value:function(e,t,r,n){var a=this.findNode(n);return this.createOrUpdateNode(e,t,a,r)}},{key:"findNode",value:function(e){return null==e||0===e.length?this.rootNode:function(e,t){if(null===t)return e;return function e(r){if(void 0!==r.path&&void 0!==t&&!t.startsWith(r.path))return null;for(var n=0,a=r.children.length;n<a;n++){var i=e(r.children[n]);if(null!==i)return i}return r.path===t?r:null}(e)}(this.rootNode,e.join("."))}},{key:"findNodeByDomElement",value:function(e){var t=this.translateTreeNodeIdFromACITree(e);if(t&&t[0])return this.findNode(t)}},{key:"selected",value:function(){return this.aciTreeApi.selected()}},{key:"selectNode",value:function(e){this.aciTreeApi.select(e)}},{key:"createOrUpdateNode",value:function(e,t,r,n){var a=[e];null!=r&&(a=[r.path,e]);var i=this.findNode(a);if(null!==i)return i.data=t,i;var o=new g(e,t,n,r);return r===this.rootNode&&(o.parentNode=null),r.children.push(o),o}},{key:"register",value:function(e){e.on("acitree",function(e,t,r,n){if(t.isItem(r)&&("added"===n||"idset"===n)){var a=t.getId(r),o=t.itemData(r);"added"===n&&this.prepareDraggable(o,r);var s=this.translateTreeNodeIdFromACITree(t.parent(r));this.addNewNode(a,o,r,s),o.errmsg&&i.default.error(o.errmsg)}}.bind(this)),this.aciTreeApi=e.aciTree("api")}},{key:"translateTreeNodeIdFromACITree",value:function(e){for(var t=e,r=[];null!=t&&t.length>0&&(r.unshift(this.aciTreeApi.getId(t)),this.aciTreeApi.hasParent(t));)t=this.aciTreeApi.parent(t);return r}}]),t}();t.Tree=p;var _=n.isValidData;t.isValidTreeNodeData=_}).call(this,r(1))},121:function(e,t){e.exports=r},140:function(e,t,r){"use strict";r(56),r(4),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(e.showOnScroll){var t=n.default.fn.select2.amd.require("select2/utils"),r=function(e,t){this.$element=e,this.options=t,this._dataToConvert=t.get("data")||[]},i=null;i=null!=e.data?n.default.fn.select2.amd.require("select2/data/array"):n.default.fn.select2.amd.require("select2/data/select"),t.Extend(r,i),r.prototype.query=function(e,t){var r=[],a=this;e.page||(e.page=1);this.$element.children().each((function(){var t=(0,n.default)(this);if(t.is("option")||t.is("optgroup")){var i=a.item(t),o=a.matches(e,i);null!==o&&r.push(o)}})),t({results:r.slice(20*(e.page-1),20*e.page),pagination:{more:r.length>=20*e.page}})},e.minimumInputLength>0&&(r=t.Decorate(r,n.default.fn.select2.amd.require("select2/data/minimumInputLength"))),e.maximumInputLength>0&&(r=t.Decorate(r,n.default.fn.select2.amd.require("select2/data/maximumInputLength"))),e.maximumSelectionLength>0&&(r=t.Decorate(r,n.default.fn.select2.amd.require("select2/data/maximumSelectionLength"))),e.tags&&(r=t.Decorate(r,n.default.fn.select2.amd.require("select2/data/tags"))),null==e.tokenSeparators&&null==e.tokenizer||(r=t.Decorate(r,n.default.fn.select2.amd.require("select2/data/tokenizer"))),e.dataAdapter=r,a.default.isUndefined(e.ajax)&&(e.ajax={})}return e},r(104);var n=i(r(0)),a=i(r(1));function i(e){return e&&e.__esModule?e:{default:e}}},142:function(e,t,r){"use strict";r(4),r(5),r(9),Object.defineProperty(t,"__esModule",{value:!0}),t.getHelpUrl=function(e,t,r){var n=Math.floor(r/1e4),a=Math.floor(r/100)-100*n,i="";i=n>=10?e.replace("$VERSION$",n):e.replace("$VERSION$",n+"."+a);"/"!=i.substr(-1)&&(i+="/");return i+t}},145:function(e,t,r){"use strict";r(28);var n,a=(n=r(1))&&n.__esModule?n:{default:n};e.exports={generate_url:function(e,t,r,n,i,o){var s="";return a.default.each(a.default.sortBy(a.default.pick(t,i),(function(e){return e.priority})),(function(e){s="".concat(s,"/").concat(encodeURI(e._id))})),s=o?"".concat(s,"/").concat(o):"".concat(s,"/"),"".concat(e).concat(n,"/").concat(r).concat(s)}}},147:function(e,t,r){"use strict";r(19),r(26),r(27),r(8),r(189),r(16),r(122),r(17),r(21),r(47),r(32),r(4),r(12),r(5),r(43),r(23),r(61),r(29),r(20),r(7),Object.defineProperty(t,"__esModule",{value:!0}),t.browserTreeState=t.pgBrowser=void 0;var n=l(r(1)),a=l(r(0)),i=l(r(6)),o=l(r(2)),s=l(r(3));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var d=s.default.Browser=s.default.Browser||{};t.pgBrowser=d;var c=d.browserTreeState=d.browserTreeState||{};t.browserTreeState=c,n.default.extend(d.browserTreeState,{parent:"server",orig_parent:"server_group",stored_state:{},last_state:{},current_state:{},init:function(){var e=d.get_preference("browser","browser_tree_state_save_interval");n.default.isUndefined(e)||-1===e.value?n.default.isUndefined(e)||a.default.ajax({url:(0,i.default)("settings.reset_tree_state"),type:"DELETE"}).fail((function(e){var t=e.responseText;if(417==e.status||410==e.status||500==e.status)try{t=JSON.parse(e.responseText).errormsg}catch(e){console.warn(e.stack||e)}console.warn((0,o.default)('Error resetting the tree saved state."'),t)})):(setInterval(this.save_state,1e3*e.value),this.fetch_state.apply(this),d.Events.on("pgadmin:browser:tree:expand-from-previous-tree-state",this.expand_from_previous_state,this),d.Events.on("pgadmin:browser:tree:remove-from-tree-state",this.remove_from_cache,this),d.Events.on("pgadmin:browser:tree:update-tree-state",this.update_cache,this))},save_state:function(){var e=d.browserTreeState;e.last_state!=JSON.stringify(e.current_state)&&a.default.ajax({url:(0,i.default)("settings.save_tree_state"),type:"POST",contentType:"application/json",data:JSON.stringify(e.current_state)}).done((function(){e.last_state=JSON.stringify(e.current_state)})).fail((function(e){var t=e.responseText;if(417==e.status||410==e.status||500==e.status)try{t=JSON.parse(e.responseText).errormsg}catch(e){console.warn(e.stack||e)}console.warn((0,o.default)('Error saving the tree state."'),t)}))},fetch_state:function(){var e=this;a.default.ajax({url:(0,i.default)("settings.get_tree_state"),type:"GET",dataType:"json",contentType:"application/json"}).done((function(t){e.stored_state=t})).fail((function(e){var t=e.responseText;if(417==e.status||410==e.status||500==e.status)try{t=JSON.parse(e.responseText).errormsg}catch(e){console.warn(e.stack||e)}console.warn((0,o.default)("Error fetching the tree state."),t)}))},update_cache:function(e){var t,r=e&&d.tree.itemData(e),a=(r&&d.Nodes[r._type]).getTreeNodeHierarchy(e),i=d.tree.pathId(e),o=i.join(),s=[],l=-1;if(d.tree.hasParent(e)&&this.parent in a){if(t=a[this.parent]._id,d.tree.isOpen(e)){i.push(r.id),s=i.join(),t in this.current_state||(this.current_state[t]={paths:[],selected:{},conn_status:{},is_opened:{}});var u=n.default.find(this.current_state[t].paths,(function(e){return-1!==e.search(s)}));n.default.isUndefined(u)&&(n.default.isUndefined(this.current_state[t].paths)?this.current_state[t].paths=[]:l=this.current_state[t].paths.indexOf(o),-1!==l?this.current_state[t].paths[l]=s:this.current_state[t].paths.push(s))}this.update_database_status(e),this.update_current_selected_item(a)}},remove_from_cache:function(e){var t=this,r=t.stored_state||{},a=e&&d.tree.itemData(e),i=a&&d.Nodes[a._type],o=i&&i.getTreeNodeHierarchy(e);if(null!==o&&d.tree.hasParent(e)&&t.parent in o){var s=o&&o[t.parent]._id,l=o&&o[t.orig_parent].id;if(this.update_database_status(e),a._type!=t.parent&&"database"!=a._type){if(d.tree.isClosed(e)){var u=t.current_state[s].paths,c=void 0;if("database"in o&&(c=o.database.id),!n.default.isUndefined(u)&&!n.default.isUndefined(u.length)){var f=0,g=void 0;n.default.each(u,(function(e){if(!n.default.isUndefined(e)){var r=e.split(",");if(-1!==r.indexOf(a.id)&&(void 0===c||void 0!==c&&-1!==r.indexOf(c))){var i=r.indexOf(a.id);r.splice(i),(g=r.join())==l?t.current_state[s].paths.splice(e,1):t.current_state[s].paths[f]=g}f++}}))}}}else s in r&&"paths"in r[s]&&(r[s].paths=t.current_state[s].paths,t.save_state())}},expand_from_previous_state:function(e){var t=this,r=t.stored_state||{},a=e&&d.tree.itemData(e),i=a&&d.Nodes[a._type],o=i&&i.getTreeNodeHierarchy(e);if(null!==o&&d.tree.hasParent(e)&&t.parent in o&&(a._type!=t.parent||!1!==d.tree.isOpen(e))){var s=r[o[t.parent]._id];if(!("database"==a._type&&s&&"conn_status"in s&&"is_opened"in s)||0!==s.conn_status[a.id]&&0!==s.is_opened[a.id]&&a.id in s.is_opened){if(!n.default.isUndefined(s)&&"paths"in s&&!n.default.isUndefined(s.paths.length)){var l=u(s.paths),c=void 0;"database"in o&&(c=o.database.id),n.default.each(l,(function(i){if(!n.default.isUndefined(i)){var s=i.split(",");if(-1!==s.indexOf(a.id)&&(void 0===c||void 0!==c&&-1!==s.indexOf(c))){var l=s.indexOf(a.id);if(d.tree.toggle(e),l==s.length-1){var u=r[o[t.parent]._id].paths.indexOf(i);r[o[t.parent]._id].paths.splice(u,1)}}}}))}this.select_tree_item(e)}}},update_database_status:function(e){var t=e&&d.tree.itemData(e),r=(t&&d.Nodes[t._type]).getTreeNodeHierarchy(e);if("database"in r){var n=r.database.id,a=r&&r[this.parent]._id;a in this.current_state&&"selected"in this.current_state[a]&&(r.database.connected?this.current_state[a].conn_status[n]=1:this.current_state[a].conn_status[n]=0,"database"==t._type&&(d.tree.isOpen(e)?this.current_state[a].is_opened[n]=1:this.current_state[a].is_opened[n]=0))}},update_current_selected_item:function(e){if(this.parent in e){var t=e&&e[this.parent]._id,r=d.tree.itemData(d.tree.selected()),a=void 0;r=r?r.id:void 0,"database"in e&&(a=e.database.id),t in this.current_state&&"selected"in this.current_state[t]&&!n.default.isUndefined(r)&&(this.current_state[t].selected[e[this.parent].id]=r,n.default.isUndefined(a)||(this.current_state[t].selected[a]=r))}},select_tree_item:function(e){var t=this.stored_state||{},r=e&&d.tree.itemData(e),n=r&&d.Nodes[r._type],a=n&&n.getTreeNodeHierarchy(e),i=t[a[this.parent]._id];if("database"in a){var o=a.database.id;i&&"selected"in i&&o in i.selected&&i.selected[o]==r.id&&d.tree.select(e)}}})},179:function(e,t,r){"use strict";var n,a;r(16),r(5),r(9),r(74),n=[r(0),r(1)],void 0===(a=function(e,t){return function(e,r){if(t.isUndefined(r)||t.isNull(r))return!0;r.startsWith("coll-")&&(r=r.replace("coll-",""));if(t.indexOf(["server_group","server","catalog_object_column"],r)>=0)return!0;var n=e.get_preference("browser","show_node_"+r);return!n||n.value}}.apply(t,n))||(e.exports=a)},182:function(e,t,r){"use strict";(function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(19),r(26),r(27),r(17),r(32),r(11),r(4),r(31),r(41),r(12),r(23),r(44),r(20),r(7),Object.defineProperty(t,"__esModule",{value:!0}),t.pgBrowser=void 0;var a=f(r(3)),i=f(r(6)),o=f(r(0)),s=c(r(13)),l=c(r(57)),u=f(r(33));function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function c(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}function f(e){return e&&e.__esModule?e:{default:e}}var g=r(87),p=a.default.Browser=a.default.Browser||{};t.pgBrowser=p,e.extend(p,{preferences_cache:[],prefcache_version:0,generate_preference_version:function(){return(new Date).getTime()},preference_version:function(e){if(!e)return this.prefcache_version;this.prefcache_version=e},get_preference:function(t,r){var n=this;if(0!=e.size(n.preferences_cache))return e.findWhere(n.preferences_cache,{module:t,name:r});var a=setInterval((function(){if(n.preferences_cache.length>0)return clearInterval(a),e.findWhere(n.preferences_cache,{module:t,name:r})}),1e3)},get_preferences_for_module:function(t){var r={};if(e.each(e.where(this.preferences_cache,{module:t}),(function(e){r[e.name]=e.value})),Object.keys(r).length>0)return r},get_preference_for_id:function(t){return e.findWhere(this.preferences_cache,{id:t})},cache_preferences:function(t){var r=this,n={};n[a.default.csrf_token_header]=a.default.csrf_token,setTimeout((function(){o.default.ajax({url:(0,i.default)("preferences.get_all"),headers:n}).done((function(n){r.preferences_cache=n,r.preference_version(r.generate_preference_version()),p.keyboardNavigation.init(),p.tree&&(g.modifyAcitreeAnimation(r),g.modifyAlertifyAnimation(r)),p.browserTreeState.init(),t&&("string"==typeof t?o.default.event.trigger("prefchange:"+t):e.each(t,(function(e,t){o.default.event.trigger("prefchange:"+t)})))})).fail((function(e,t,r){s.pgRespErrorNotify(e,r)}))}),500)},reflectPreferences:function(e){if("sqleditor"===e||null==e){var t=this.get_preferences_for_module("sqleditor");(0,o.default)(this.editor.getWrapperElement()).css("font-size",l.calcFontSize(t.sql_font_size)),this.editor.setOption("tabSize",t.tab_size),this.editor.setOption("lineWrapping",t.wrap_code),this.editor.setOption("autoCloseBrackets",t.insert_pair_brackets),this.editor.setOption("matchBrackets",t.brace_matching),this.editor.refresh()}},onPreferencesChange:function(e,t){(0,o.default)(u.default).on("prefchange:"+e,(function(e){t(e)}))}})}).call(this,r(1))},184:function(e,t){e.exports=n},185:function(e,t,r){"use strict";(function(e){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(19),r(26),r(27),r(17),r(11),r(4),r(31),r(12),r(23),r(44),r(20),r(7),Object.defineProperty(t,"__esModule",{value:!0}),t.pgBrowser=void 0;var a=c(r(3)),i=c(r(6)),o=c(r(0)),s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}r.default=e,t&&t.set(e,r);return r}(r(13)),l=c(r(2));r(58);var u=c(r(33));function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function c(e){return e&&e.__esModule?e:{default:e}}var f=a.default.Browser=a.default.Browser||{};t.pgBrowser=f;var g=window.wcDocker;e.extend(f,{lock_layout_levels:{PREVENT_DOCKING:"docking",FULL:"full",NONE:"none"},buildDefaultLayout:function(e){var t=e.addPanel("browser",g.DOCK.LEFT),r=e.addPanel("dashboard",g.DOCK.RIGHT,t);e.addPanel("properties",g.DOCK.STACKED,r,{tabOrientation:g.TAB.TOP}),e.addPanel("sql",g.DOCK.STACKED,r),e.addPanel("statistics",g.DOCK.STACKED,r),e.addPanel("dependencies",g.DOCK.STACKED,r),e.addPanel("dependents",g.DOCK.STACKED,r)},save_current_layout:function(e,t){if(t){var r={setting:e,value:t.save()};o.default.ajax({type:"POST",url:(0,i.default)("settings.store_bulk"),data:r})}},restore_layout:function(e,t,r){if(""!=t)try{e.restore(t)}catch(t){e.clear(),r&&r(e)}else r&&r(e);var n=u.default.pgAdmin.Browser,a=setInterval((function(){n.get_preferences_for_module("browser")&&(clearInterval(a),n.reflectLocklayoutChange(e),n.onPreferencesChange("browser",(function(){n.reflectLocklayoutChange(e)})))}),500)},reflectLocklayoutChange:function(e){var t=u.default.pgAdmin.Browser,r=t.get_preferences_for_module("browser");t.lock_layout(e,r.lock_layout)},lock_layout:function(t,r){var n=this.menus.file.mnu_locklayout.menu_items;switch(r){case this.lock_layout_levels.PREVENT_DOCKING:t.lockLayout(g.LOCK_LAYOUT_LEVEL.PREVENT_DOCKING);break;case this.lock_layout_levels.FULL:t.lockLayout(g.LOCK_LAYOUT_LEVEL.FULL);break;case this.lock_layout_levels.NONE:t.lockLayout(g.LOCK_LAYOUT_LEVEL.NONE)}e.each(n,(function(e){e.name!="mnu_lock_"+r?e.change_checked(!1):e.change_checked(!0)}))},save_lock_layout:function(e){var t=u.default.pgAdmin.Browser;o.default.ajax({url:(0,i.default)("browser.lock_layout"),method:"PUT",contentType:"application/json",data:JSON.stringify({value:e})}).done((function(){t.cache_preferences("browser")})).fail((function(e,t){s.pgNotifier(t,e,(0,l.default)("Failed to save the lock layout setting."))}))},mnu_lock_docking:function(){this.lock_layout(this.docker,this.lock_layout_levels.PREVENT_DOCKING),this.save_lock_layout(this.lock_layout_levels.PREVENT_DOCKING)},mnu_lock_full:function(){this.lock_layout(this.docker,this.lock_layout_levels.FULL),this.save_lock_layout(this.lock_layout_levels.FULL)},mnu_lock_none:function(){this.lock_layout(this.docker,this.lock_layout_levels.NONE),this.save_lock_layout(this.lock_layout_levels.NONE)}})}).call(this,r(1))},187:function(e,t,r){"use strict";r(42),r(4),r(7),Object.defineProperty(t,"__esModule",{value:!0}),t.pgBrowser=void 0;var n=l(r(0)),a=l(r(1)),i=l(r(3)),o=l(r(33)),s=r(22);function l(e){return e&&e.__esModule?e:{default:e}}var u=i.default.Browser=i.default.Browser||{};t.pgBrowser=u;a.default.extend(u,{inactivity_timeout_at:null,logging_activity:!1,inactivity_timeout_daemon_running:!1,is_pgadmin_timedout:function(){return!o.default.pgAdmin},is_inactivity_timeout:function(){return o.default.pgAdmin.Browser.inactivity_timeout_at<this.get_epoch_now()},get_epoch_now:function(){return(0,s.getEpoch)()},log_activity:function(){var e=this;this.logging_activity||(this.logging_activity=!0,this.inactivity_timeout_at=this.get_epoch_now()+i.default.user_inactivity_timeout,setTimeout((function(){e.logging_activity=!1}),1e3))},register_to_activity_listener:function(e,t){var r=["mousemove","mousedown","keydown"],n=this;r.forEach((function(a){e.addEventListener(a,(function a(){n.is_pgadmin_timedout()?(r.forEach((function(t){e.removeEventListener(t,a,!0)})),t()):o.default.pgAdmin.Browser.log_activity()}),!0)}))},override_activity_event_decorator:function(e){return function(){return i.default.override_user_inactivity_timeout&&o.default.pgAdmin.Browser.log_activity(),e.apply(this,arguments)}},logout_inactivity_user:function(){a.default.isUndefined(u.utils)||a.default.isUndefined(u.utils.logout_url)||(window.location.href=u.utils.logout_url)},start_inactivity_timeout_daemon:function(){var e=this;if(i.default.user_inactivity_timeout>0&&!e.inactivity_timeout_daemon_running)var t=setInterval((function(){e.inactivity_timeout_daemon_running=!0,e.is_inactivity_timeout()&&(clearInterval(t),e.inactivity_timeout_daemon_running=!1,(0,n.default)(window).off("beforeunload"),e.logout_inactivity_user())}),1e3)}})},188:function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(19),r(26),r(27),r(8),r(17),r(15),r(4),r(31),r(12),r(23),r(44),r(20),r(7);var a=p(r(1)),i=p(r(3)),o=p(r(0)),s=p(r(96)),l=g(r(22)),u=p(r(109)),d=g(r(69)),c=p(r(33));function f(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return f=function(){return e},e}function g(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=f();if(t&&t.has(e))return t.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(r,i,o):r[i]=e[i]}return r.default=e,t&&t.set(e,r),r}function p(e){return e&&e.__esModule?e:{default:e}}var _=i.default.Browser=i.default.Browser||{};_.keyboardNavigation=_.keyboardNavigation||{},a.default.extend(_.keyboardNavigation,{init:function(){s.default.reset(),_.preferences_cache.length>0&&(this.keyboardShortcut={file_shortcut:l.parseShortcutValue(_.get_preference("browser","main_menu_file").value),object_shortcut:l.parseShortcutValue(_.get_preference("browser","main_menu_object").value),tools_shortcut:l.parseShortcutValue(_.get_preference("browser","main_menu_tools").value),help_shortcut:l.parseShortcutValue(_.get_preference("browser","main_menu_help").value),left_tree_shortcut:l.parseShortcutValue(_.get_preference("browser","browser_tree").value),tabbed_panel_backward:l.parseShortcutValue(_.get_preference("browser","tabbed_panel_backward").value),tabbed_panel_forward:l.parseShortcutValue(_.get_preference("browser","tabbed_panel_forward").value),sub_menu_query_tool:l.parseShortcutValue(_.get_preference("browser","sub_menu_query_tool").value),sub_menu_view_data:l.parseShortcutValue(_.get_preference("browser","sub_menu_view_data").value),sub_menu_properties:l.parseShortcutValue(_.get_preference("browser","sub_menu_properties").value),sub_menu_create:l.parseShortcutValue(_.get_preference("browser","sub_menu_create").value),sub_menu_delete:l.parseShortcutValue(_.get_preference("browser","sub_menu_delete").value),sub_menu_refresh:l.parseShortcutValue(_.get_preference("browser","sub_menu_refresh").value),context_menu:l.parseShortcutValue(_.get_preference("browser","context_menu").value),direct_debugging:l.parseShortcutValue(_.get_preference("browser","direct_debugging").value),drop_multiple_objects:l.parseShortcutValue(_.get_preference("browser","grid_menu_drop_multiple").value),drop_cascade_multiple_objects:l.parseShortcutValue(_.get_preference("browser","grid_menu_drop_cascade_multiple").value),add_grid_row:l.parseShortcutValue(_.get_preference("browser","add_grid_row").value)},this.shortcutMethods={bindMainMenu:{shortcuts:[this.keyboardShortcut.file_shortcut,this.keyboardShortcut.object_shortcut,this.keyboardShortcut.tools_shortcut,this.keyboardShortcut.help_shortcut]},bindRightPanel:{shortcuts:[this.keyboardShortcut.tabbed_panel_backward,this.keyboardShortcut.tabbed_panel_forward]},bindLeftTree:{shortcuts:this.keyboardShortcut.left_tree_shortcut},bindSubMenuQueryTool:{shortcuts:this.keyboardShortcut.sub_menu_query_tool},bindSubMenuViewData:{shortcuts:this.keyboardShortcut.sub_menu_view_data},bindSubMenuProperties:{shortcuts:this.keyboardShortcut.sub_menu_properties},bindSubMenuCreate:{shortcuts:this.keyboardShortcut.sub_menu_create},bindSubMenuDelete:{shortcuts:this.keyboardShortcut.sub_menu_delete},bindSubMenuRefresh:{shortcuts:this.keyboardShortcut.sub_menu_refresh,bindElem:"#tree"},bindContextMenu:{shortcuts:this.keyboardShortcut.context_menu},bindDirectDebugging:{shortcuts:this.keyboardShortcut.direct_debugging},bindDropMultipleObjects:{shortcuts:this.keyboardShortcut.drop_multiple_objects},bindDropCascadeMultipleObjects:{shortcuts:this.keyboardShortcut.drop_cascade_multiple_objects},bindAddGridRow:{shortcuts:this.keyboardShortcut.add_grid_row}},this.bindShortcuts())},bindShortcuts:function(){var e=this;a.default.each(e.shortcutMethods,(function(t,r){e._bindWithMousetrap(t.shortcuts,e[r],t.bindElem)}));(0,o.default)(".pg-navbar").on("keydown",(function(t){switch(t.keyCode){case 37:e.bindMainMenuLeft(t);break;case 38:e.bindMainMenuUpDown(t,"up");break;case 39:e.bindMainMenuRight(t);break;case 40:e.bindMainMenuUpDown(t,"down")}}))},_bindWithMousetrap:function(e,t,r){var n=this;if(s.default.unbind(e),r){var a=document.querySelector(r);(0,s.default)(a).bind(e,function(){t.apply(this,arguments)}.bind(a))}else s.default.bind(e,(function(){t.apply(n,arguments)}))},unbindShortcuts:function(){a.default.each(this.mousetrapInstances,(function(e){e.instance.reset()})),this.mousetrapInstances=[]},bindMainMenu:function(e,t){var r=this.keyboardShortcut;t===r.file_shortcut&&(0,o.default)("#mnu_file a.dropdown-toggle").dropdown("toggle"),t===r.object_shortcut&&(0,o.default)("#mnu_obj a.dropdown-toggle").first().dropdown("toggle"),t===r.tools_shortcut&&(0,o.default)("#mnu_tools a.dropdown-toggle").dropdown("toggle"),t===r.help_shortcut&&(0,o.default)("#mnu_help a.dropdown-toggle").dropdown("toggle")},bindRightPanel:function(e,t){var r=0,n=i.default.Browser.docker.findPanels().length-1,o=0,s=!1,l=this.keyboardShortcut;a.default.each(i.default.Browser.docker.findPanels(),(function(e,t){e.isVisible()&&!s&&"browser"!==e._type&&(o=t,s=!0)})),t===l.tabbed_panel_backward?r=o>0?o-1:1:t===l.tabbed_panel_forward&&(r=o<n?o+1:n),i.default.Browser.docker.findPanels()[r].focus(),setTimeout((function(){document.activeElement instanceof HTMLIFrameElement&&document.activeElement.blur()}),1e3)},bindMainMenuLeft:function(e){if((0,o.default)(e.target).hasClass("nav-link")){var t=(0,o.default)(e.target).closest(".nav-item");for(d._stopEventPropagation(e),t=t.prev(".nav-item");t.hasClass("d-none");)t=t.prev(".nav-item");t.find(".dropdown-toggle").first().dropdown("toggle")}else if((0,o.default)(e.target).closest(".dropdown-menu").length>0){var r=(0,o.default)(e.target).closest("li");d._stopEventPropagation(e);var n=r.closest(".dropdown-menu");n.closest(".dropdown-submenu").length>0&&(n.removeClass("show"),n.closest(".dropdown-submenu").removeClass("dropdown-submenu-visible"),(r=n.closest(".dropdown-submenu")).find(".dropdown-item").trigger("focus"))}},bindMainMenuRight:function(e){if((0,o.default)(e.target).hasClass("nav-link")){var t=(0,o.default)(e.target).closest(".nav-item");for(d._stopEventPropagation(e),t=t.next(".nav-item");t.hasClass("d-none");)t=t.next(".nav-item");t.find(".dropdown-toggle").first().dropdown("toggle")}else if((0,o.default)(e.target).closest(".dropdown-menu").length>0){var r=(0,o.default)(e.target).closest("li");d._stopEventPropagation(e),r.hasClass("dropdown-submenu")&&(r.addClass("dropdown-submenu-visible"),r.find(".dropdown-menu").addClass("show"),r=r.find(".dropdown-menu .dropdown-item").first().trigger("focus"))}},bindMainMenuUpDown:function(e,t){if((0,o.default)(e.target).closest(".dropdown-menu").length>0){d._stopEventPropagation(e);var r=(0,o.default)(e.target).closest("li"),n=(0,o.default)(e.target).closest(".dropdown-menu");for(n.find(".show").removeClass("show"),n.find(".dropdown-submenu").removeClass("dropdown-submenu-visible"),"up"===t?r=r.prev():"down"===t&&(r=r.next());r.hasClass("dropdown-divider")||r.find(".dropdown-item").first().hasClass("disabled");)"up"===t?r=r.prev():"down"===t&&(r=r.next());r.find(".dropdown-item").trigger("focus")}},bindLeftTree:function(){var e=this.getTreeDetails();(0,o.default)("#tree").trigger("focus"),e.t.focus(e.i),e.t.select(e.i)},bindSubMenuQueryTool:function(){var e=this.getTreeDetails();e.d&&i.default.DataGrid.show_query_tool("",e.i)},bindSubMenuViewData:function(){var e=this.getTreeDetails();e.d&&i.default.DataGrid.show_data_grid({mnuid:1},e.i)},bindSubMenuProperties:function(){var e=this.getTreeDetails();e.d&&!0!==i.default.Browser.Nodes[e.t.itemData(e.i)._type].collection_node&&i.default.Browser.Node.callbacks.show_obj_properties.call(i.default.Browser.Nodes[e.t.itemData(e.i)._type],{action:"edit"})},bindSubMenuCreate:function(){var e=this.getTreeDetails(),t=i.default.Browser.Nodes[e.t.itemData(e.i)._type];if(e.d){if(!0===t.collection_node){if(!t.node)return;t=i.default.Browser.Nodes[t.node]}i.default.Browser.Node.callbacks.show_obj_properties.call(t,{action:"create",item:e.i})}},bindSubMenuDelete:function(){var e=this.getTreeDetails();e.d&&!0!==i.default.Browser.Nodes[e.t.itemData(e.i)._type].collection_node&&i.default.Browser.Node.callbacks.delete_obj.call(i.default.Browser.Nodes[e.t.itemData(e.i)._type])},bindSubMenuRefresh:function(e){e.preventDefault();var t=_.keyboardNavigation.getTreeDetails();i.default.Browser.Node.callbacks.refresh.call(i.default.Browser.Nodes[t.t.itemData(t.i)._type])},bindContextMenu:function(e){var t=this.getTreeDetails(),r=e.srcElement||e.target,n=(0,o.default)(r).find(".aciTreeEntry").position().left+70,a=(0,o.default)(r).find(".aciTreeEntry").position().top+70;t.t.blur(t.i),(0,o.default)("#tree").trigger("blur"),t.i.children().contextMenu({x:n,y:a})},bindDirectDebugging:function(){var e=this.getTreeDetails(),t=e.t.itemData(e.i)._type;!e.d||"function"!==t&&"procedure"!==t||i.default.Tools.Debugger.can_debug(e.d,e.i,{debug_type:"direct"})&&i.default.Tools.Debugger.get_function_information(i.default.Browser.Nodes[t])},bindDropMultipleObjects:function(){!0===this.isPropertyPanelVisible()&&(0,o.default)("button.delete_multiple").length>0&&(0,o.default)("button.delete_multiple").click()},bindDropCascadeMultipleObjects:function(){!0===this.isPropertyPanelVisible()&&(0,o.default)("button.delete_multiple_cascade").length>0&&(0,o.default)("button.delete_multiple_cascade").click()},bindAddGridRow:function(){var e=(0,o.default)(document.activeElement).closest(".object.subnode");(0,o.default)(e).length&&(0,o.default)(e).find(".add").click()},isPropertyPanelVisible:function(){var e=!1;return a.default.each(i.default.Browser.docker.findPanels(),(function(t){"properties"===t._type&&(e=t.isVisible())})),e},getTreeDetails:function(){var e=i.default.Browser.tree,t=e.selected().length>0?e.selected():e.first(),r=t&&1===t.length?e.itemData(t):void 0;return{t:e,i:t,d:r}},getDialogTabNavigator:function(e){var t=c.default.pgAdmin.Browser.get_preference("browser","dialog_tab_backward").value,r=c.default.pgAdmin.Browser.get_preference("browser","dialog_tab_forward").value;return new u.default.dialogTabNavigator(e,t,r)}}),e.exports=i.default.Browser.keyboardNavigation},193:function(e,t,r){"use strict";var n,a;r(8),r(16),r(79),r(35),r(5),r(9),r(29),r(7),n=[r(2),r(6),r(0),r(1),r(14),r(13),r(3),r(10),r(30),r(33),r(58)],void 0===(a=function(e,t,r,n,a,i,o,s,l,u){var d=window.wcDocker,c=function(e){var t=e.get("type");if(-1!=t.indexOf("[]"))switch(t.replace("[]","")){case"boolean":return l.Extension.InputBooleanArrayCell;case"integer":case"smallint":case"bigint":case"serial":case"smallserial":case"bigserial":case"oid":case"cid":case"xid":case"tid":return l.Extension.InputIntegerArrayCell;case"real":case"numeric":case"double precision":case"decimal":return l.Extension.InputNumberArrayCell;default:return l.Extension.InputStringArrayCell}else switch(t){case"boolean":return l.BooleanCell.extend({formatter:l.BooleanCellFormatter});case"integer":case"smallint":case"bigint":case"serial":case"smallserial":case"bigserial":case"oid":case"cid":case"xid":case"tid":return null!=e.get("value")&&e.set({value:isNaN(parseInt(e.get("value")))?null:parseInt(e.get("value"))},{silent:!0}),l.IntegerCell;case"real":case"numeric":case"double precision":case"decimal":return null!=e.get("value")&&e.set({value:parseFloat(e.get("value"))},{silent:!0}),l.NumberCell;case"string":return l.StringCell;case"date":return l.DateCell;default:return l.Cell}},f=function(e){return-1!=e.get("type").indexOf("[]")?l.StringCell:l.BooleanCell},g=a.Model.extend({defaults:{name:void 0,type:void 0,is_null:void 0,expr:void 0,value:void 0,use_default:void 0,default_value:void 0},validate:function(){if(n.isUndefined(this.get("value"))||n.isNull(this.get("value"))||""==String(this.get("value")).replace(/^\s+|\s+$/g,"")){var t=e("Please enter a value for the parameter.");return this.errorModel.set("value",t),t}return this.errorModel.unset("value"),null}}),p=a.Collection.extend({model:g}),_=function(e){return e instanceof a.Model&&e.get("use_default")},b=function(e){if(e instanceof a.Model)return-1==e.get("type").indexOf("[]")};return function(a,o,g,h){i.debuggerInputArgsDialog||i.dialog("debuggerInputArgsDialog",(function(){return{main:function(a,o,d,g,h){this.preferences=u.default.pgAdmin.Browser.get_preferences_for_module("debugger"),this.set("title",a),this.set("debug_info",o),this.set("restart_debug",d),this.set("trans_id",h),this.set("is_edb_proc",g);var v,m,y,w,k,D,x=this.func_args_data=[];if(0==d){var S=s.tree,T=S.selected(),C=T&&1==T.length?S.itemData(T):void 0,E=C&&s.Nodes[C._type];if(!C)return;var N,P=E.getTreeNodeHierarchy.apply(E,[T]);"function"==C._type?N=t("debugger.get_arguments",{sid:P.server._id,did:P.database._id,scid:P.schema._id,func_id:P.function._id}):"procedure"==C._type?N=t("debugger.get_arguments",{sid:P.server._id,did:P.database._id,scid:P.schema._id,func_id:P.procedure._id}):"edbfunc"==C._type?N=t("debugger.get_arguments",{sid:P.server._id,did:P.database._id,scid:P.schema._id,func_id:P.edbfunc._id}):"edbproc"==C._type&&(N=t("debugger.get_arguments",{sid:P.server._id,did:P.database._id,scid:P.schema._id,func_id:P.edbproc._id}))}else N=t("debugger.get_arguments",{sid:o.server_id,did:o.database_id,scid:o.schema_id,func_id:o.function_id});r.ajax({url:N,method:"GET",async:!1}).done((function(e){if(0!=e.data.args_count)for(T=0;T<e.data.result.length;T++)x.push({arg_id:e.data.result[T].arg_id,is_null:e.data.result[T].is_null,is_expression:e.data.result[T].is_expression,use_default:e.data.result[T].use_default,value:e.data.result[T].value})})).fail((function(){i.alert(e("Debugger Error"),e("Unable to fetch the arguments from server"))}));var O,M,A,j,L,B,I=l.HeaderCell.extend({className:"width_percent_25"}),K=[],V=[{name:"name",label:e("Name"),type:"text",editable:!1,cell:"string"},{name:"type",label:e("Type"),type:"text",editable:!1,cell:"string"},{name:"is_null",label:e("Null?"),type:"boolean",cell:"boolean",align_center:!0},{name:"expr",label:e("Expression?"),type:"boolean",cellFunction:f,editable:b,align_center:!0},{name:"value",label:e("Value"),type:"text",editable:!0,cellFunction:c,headerCell:I,align_center:!0},{name:"use_default",label:e("Use Default?"),type:"boolean",cell:"boolean",editable:_},{name:"default_value",label:e("Default"),type:"text",editable:!1,cell:"string"}],q=[],U=[],G=this.input_arg_id=[];if(null!=o.proargmodes){var F=o.proargmodes.split(",");for(O=0;O<F.length;O++)("i"==F[O]||"b"==F[O]||g&&"o"==F[O])&&G.push(O)}else{var R=o.proargtypenames.split(",");for(O=0;O<R.length;O++)G.push(O)}if(m=o.proargtypenames.split(","),null!=o.proargmodes&&(y=o.proargmodes.split(",")),o.pronargdefaults&&(w=o.pronargdefaults,k=o.proargdefaults.split(","),D=w),null!=o.proargnames){for(B=(v=o.proargnames.split(",")).length-1;B>=0;B--)null!=o.proargmodes?("i"==y[B]||"b"==y[B]||g&&"o"==y[B])&&(D?(D-=1,K[B]=k[D]):K[B]="<no default>"):D?(D-=1,K[B]=k[D]):K[B]="<no default>";if(0!=m.length)for(T=0;T<m.length;T++)null!=o.proargmodes?("i"==y[T]||"b"==y[T]||g&&"o"==y[T])&&(L=!1,"<no default>"!=K[T]&&(L=!0),q.push({name:v[T],type:m[T],use_default:L,default_value:K[T]})):(L=!1,"<no default>"!=K[T]&&(L=!0),q.push({name:v[T],type:m[T],use_default:L,default_value:K[T]}));if(0!=x.length)for(T=0;T<x.length;T++)j=x[T].arg_id,(null==o.proargmodes||"o"!=y[j]||g)&&(A=[],-1!=m[j].indexOf("[]")?(M=x[T].value.split(","),n.each(M,(function(e){A.push({value:e})}))):A=x[T].value,U.push({name:v[j],type:m[j],is_null:!!x[T].is_null,expr:!!x[T].is_expression,value:A,use_default:!!x[T].use_default,default_value:K[j]}))}else{var $=[];for(T=0;T<m.length;T++)$[T]="dbgparam"+(T+1);if(o.pronargdefaults){for(B=$.length-1;B>=0;B--)o.proargmodes,D?(D-=1,K[B]=k[D]):K[B]="<No default value>";for(T=0;T<m.length;T++)null==o.proargmodes?(L=!1,"<No default value>"!=K[T]&&(L=!0),q.push({name:$[T],type:m[T],use_default:L,default_value:K[T]})):("i"==y[T]||"b"==y[T]||g&&"o"==y[T])&&(L=!1,"<No default value>"!=K[T]&&(L=!0),q.push({name:$[T],type:m[T],use_default:L,default_value:K[T]}))}else for(T=0;T<m.length;T++)q.push({name:$[T],type:m[T],use_default:!1,default_value:"<No default value>"}),K[T]="<No default value>";if(0!=x.length)for(T=0;T<x.length;T++)j=x[T].arg_id,A=[],-1!=m[j].indexOf("[]")?(M=x[T].value.split(","),n.each(M,(function(e){A.push({value:e})}))):A=x[T].value,U.push({name:$[j],type:m[j],is_null:!!x[T].is_null,expr:!!x[T].is_expression,value:A,use_default:!!x[T].use_default,default_value:K[j]})}0==x.length?this.debuggerInputArgsColl=new p(q):this.debuggerInputArgsColl=new p(U),this.grid&&(this.grid.remove(),this.grid=null);var z=this.grid=new l.Grid({columns:V,collection:this.debuggerInputArgsColl,className:"backgrid table table-bordered table-noouter-border table-bottom-border"});z.render();var H=document.createElement("div");H.classList.add("debugger-args"),H.appendChild(z.el),r(this.elements.content).html(H);var J=r(z.el).find("input:checkbox").first();J.length&&setTimeout((function(){J.trigger("focus")}),250)},settings:{debug_info:void 0,restart_debug:void 0,trans_id:void 0},setup:function(){return{buttons:[{text:e("Clear All"),className:"btn btn-secondary pull-left fa fa-eraser pg-alertify-button"},{text:e("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button"},{text:e("Debug"),key:13,className:"btn btn-primary fa fa-bug pg-alertify-button"}],options:{padding:!1,overflow:!1,model:0,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1,modal:!1}}},callback:function(n){if(n.button.text===e("Debug")){var a=this;if(0==a.setting("restart_debug")){var o=s.tree,l=o.selected(),u=l&&1==l.length?o.itemData(l):void 0,c=u&&s.Nodes[u._type];if(!u)return;var f=c.getTreeNodeHierarchy.apply(c,[l])}var g,p=[],_=this.sqlite_func_args_list=[],b=0;if(this.grid.collection.each((function(e){var t;(e.get("is_null")?p.push({name:e.get("name"),type:e.get("type"),value:"NULL"}):e.get("use_default")?p.push({name:e.get("name"),type:e.get("type"),value:e.get("default_value")}):p.push({name:e.get("name"),type:e.get("type"),value:e.get("value")}),0==a.setting("restart_debug"))?("function"==u._type?t=f.function._id:"procedure"==u._type?t=f.procedure._id:"edbfunc"==u._type?t=f.edbfunc._id:"edbproc"==u._type&&(t=f.edbproc._id),_.push({server_id:f.server._id,database_id:f.database._id,schema_id:f.schema._id,function_id:t,arg_id:a.input_arg_id[b],is_null:e.get("is_null")?1:0,is_expression:e.get("expr")?1:0,use_default:e.get("use_default")?1:0,value:e.get("value")})):_.push({server_id:a.setting("debug_info").server_id,database_id:a.setting("debug_info").database_id,schema_id:a.setting("debug_info").schema_id,function_id:a.setting("debug_info").function_id,arg_id:a.input_arg_id[b],is_null:e.get("is_null")?1:0,is_expression:e.get("expr")?1:0,use_default:e.get("use_default")?1:0,value:e.get("value")});b+=1})),0==a.setting("restart_debug"))"function"==u._type?g=t("debugger.initialize_target_for_function",{debug_type:"direct",trans_id:a.setting("trans_id"),sid:f.server._id,did:f.database._id,scid:f.schema._id,func_id:f.function._id}):"procedure"==u._type?g=t("debugger.initialize_target_for_function",{debug_type:"direct",trans_id:a.setting("trans_id"),sid:f.server._id,did:f.database._id,scid:f.schema._id,func_id:f.procedure._id}):"edbfunc"==u._type?g=t("debugger.initialize_target_for_function",{debug_type:"direct",trans_id:a.setting("trans_id"),sid:f.server._id,did:f.database._id,scid:f.schema._id,func_id:f.edbfunc._id}):"edbproc"==u._type&&(g=t("debugger.initialize_target_for_function",{debug_type:"direct",trans_id:a.setting("trans_id"),sid:f.server._id,did:f.database._id,scid:f.schema._id,func_id:f.edbproc._id})),r.ajax({url:g,method:"POST",data:{data:JSON.stringify(p)}}).done((function(n){var o,l=t("debugger.direct",{trans_id:n.data.debuggerTransId});if(a.preferences.debugger_new_browser_tab)window.open(l,"_blank");else{s.Events.once("pgadmin-browser:frame:urlloaded:frm_debugger",(function(e){e.openURL(l)}));var c=s.docker.findPanels("properties"),g=s.docker.addPanel("frm_debugger",d.DOCK.STACKED,c[0]);g.focus(),g.on(d.EVENT.CLOSED,(function(){var e=t("debugger.close",{trans_id:n.data.debuggerTransId});r.ajax({url:e,method:"DELETE"})}))}"function"==u._type?o=t("debugger.set_arguments",{sid:f.server._id,did:f.database._id,scid:f.schema._id,func_id:f.function._id}):"procedure"==u._type?o=t("debugger.set_arguments",{sid:f.server._id,did:f.database._id,scid:f.schema._id,func_id:f.procedure._id}):"edbfunc"==u._type?o=t("debugger.set_arguments",{sid:f.server._id,did:f.database._id,scid:f.schema._id,func_id:f.edbfunc._id}):"edbproc"==u._type&&(o=t("debugger.set_arguments",{sid:f.server._id,did:f.database._id,scid:f.schema._id,func_id:f.edbproc._id})),r.ajax({url:o,method:"POST",data:{data:JSON.stringify(_)}}).done((function(){})).fail((function(){i.alert(e("Debugger Error"),e("Unable to set the arguments on the server"))}))})).fail((function(t){i.alert(e("Debugger Target Initialization Error"),t.responseJSON.errormsg)}));else{g=t("debugger.start_listener",{trans_id:a.setting("debug_info").trans_id}),r.ajax({url:g,method:"POST",data:{data:JSON.stringify(p)}}).done((function(){})).fail((function(t){i.alert(e("Debugger Listener Startup Error"),t.responseJSON.errormsg)}));var h=t("debugger.set_arguments",{sid:a.setting("debug_info").server_id,did:a.setting("debug_info").database_id,scid:a.setting("debug_info").schema_id,func_id:a.setting("debug_info").function_id});r.ajax({url:h,method:"POST",data:{data:JSON.stringify(_)}}).done((function(){})).fail((function(){i.alert(e("Debugger Error"),e("Unable to set the arguments on the server"))}))}return!0}if(n.button.text===e("Cancel"))return r.ajax({method:"DELETE",url:t("debugger.close",{trans_id:this.setting("trans_id")})}),!1;if(n.button.text===e("Clear All")){var v=this,m=null;if(0==v.setting("restart_debug")){var y=s.tree.selected(),w=s.tree.itemData(y);if(!w)return;var k,D=s.Nodes[w._type],x=D.getTreeNodeHierarchy.call(D,y);"function"==w._type?k=w._id:"procedure"==w._type?k=w._id:"edbfunc"==w._type?k=w._id:"edbproc"==w._type&&(k=w._id),m=t("debugger.clear_arguments",{sid:x.server._id,did:x.database._id,scid:x.schema._id,func_id:k})}else m=t("debugger.clear_arguments",{sid:v.setting("debug_info").server_id,did:v.setting("debug_info").database_id,scid:v.setting("debug_info").schema_id,func_id:v.setting("debug_info").function_id});return r.ajax({url:m,method:"POST",data:{data:JSON.stringify(p)}}).done((function(){v.__internal.buttons[2].element.disabled=!0,v.main(v.setting("title"),v.setting("debug_info"),v.setting("restart_debug"),v.setting("is_edb_proc"),v.setting("trans_id")),v.prepare()})).fail((function(t){i.alert(e("Clear failed"),t.responseJSON.errormsg)})),n.cancel=!0,!0}},build:function(){i.pgDialogBuild.apply(this)},prepare:function(){var e;r(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties"),0==this.func_args_data.length?this.__internal.buttons[2].element.disabled=!0:this.__internal.buttons[2].element.disabled=!1,this.grid.listenTo(this.debuggerInputArgsColl,"backgrid:edited",(e=this,function(){for(var t=!1,r=0;r<this.collection.length;r++)if(this.collection.models[r].get("is_null"))e.__internal.buttons[2].element.disabled=!1,t=!0;else if(null==this.collection.models[r].get("value")||null==this.collection.models[r].get("value")){if(t=!0,!this.collection.models[r].get("use_default")){e.__internal.buttons[2].element.disabled=!0;break}e.__internal.buttons[2].element.disabled=!1}t||(e.__internal.buttons[2].element.disabled=!1)})),this.grid.listenTo(this.debuggerInputArgsColl,"backgrid:error",function(e){return function(){e.__internal.buttons[2].element.disabled=!0}}(this))}}})),i.debuggerInputArgsDialog(e("Debugger"),a,o,g,h).resizeTo(s.stdW.md,s.stdH.md)}}.apply(t,n))||(e.exports=a)},194:function(e,t,r){"use strict";e.exports={setFocusToDebuggerEditor:function(e,t){t&&9!==(t.which||t.keyCode)&&e.focus()},getFunctionId:function(e){var t;return e&&(e.function&&e.function._id?t=e.function._id:e.edbfunc&&e.edbfunc._id&&(t=e.edbfunc._id)),t},getProcedureId:function(e){var t;return e&&(e.procedure&&e.procedure._id?t=e.procedure._id:e.edbproc&&e.edbproc._id&&(t=e.edbproc._id)),t}}},2:function(e,t,r){"use strict";var n,a;r(21),r(34),r(5),r(29),n=[r(89)],void 0===(a=function(e){return function(t){var r=e[t]?e[t]:t;if(1==arguments.length)return r;try{var n=arguments;return r.split("%s").map((function(e,t){return t>0?t<n.length?[n[t],e].join(""):["%s",e].join(""):e})).join("")}catch(e){return console.error(e),r}}}.apply(t,n))||(e.exports=a)},22:function(e,t,r){"use strict";r(8),r(16),r(21),r(34),r(32),r(4),r(35),r(5),r(139),r(9),r(61),r(29),r(7),Object.defineProperty(t,"__esModule",{value:!0}),t.parseShortcutValue=function(e){var t="";e.alt&&(t+="alt+");e.shift&&(t+="shift+");e.control&&(t+="ctrl+");return t+=e.key.char.toLowerCase()},t.findAndSetFocus=function(e){if(0==e.length)return;setTimeout((function(){var t=e.find("button.fa-plus:first");0==t.length&&(t=e.find("\n          .pgadmin-controls:first input:enabled,\n          .pgadmin-controls:first .btn:not(.toggle),\n          .ajs-commands:first,\n          .CodeMirror-scroll").find('*[tabindex]:not([tabindex="-1"])')),t.length>0?t[0].focus():e[0].focus()}),200)},t.getEpoch=function(e){var t=e||new Date;return parseInt(t.getTime()/1e3)},t.getGCD=function(e){var t=function e(t,r){return 0==t?r:e(r%t,t)},r=e.length;if(r<=2)return t(e[0],e[1]);for(var n=e[0],a=1;a<r;a++)n=t(e[a],n);return n},t.getMod=function(e,t){return(e%t+t)%t},t.parseFuncParams=function(e){var t=[],r="",n="";if(e.endsWith("()"))r=e.substring(0,e.length-2);else if(e.endsWith(")")){if(!e.endsWith("()")&&e.endsWith(")")){var a=0,i=e.length;for(a=e.length-2;a>=0;){if("("==e[a]){i=a;break}if('"'==e[a])for(a--;'"'!=e[a];)a--;a--}r=e.substring(0,i),n=e.substring(i+1,e.length-1);var o=0,s="",l=["IN","OUT","INOUT","VARIADIC"];for(o=a=0;a<n.length;){if('"'==n[a])for(a++;'"'!=n[a];)a++;else" "==n[a]?(""==s||l.indexOf(s)>-1)&&(s=n.substring(o,a),o=a+1):","==n[a]&&(t.push([s,n.substring(o,a)]),s="",o=a+1);a++}t.push([s,n.substring(o)])}}else r=e;return{func_name:r,param_string:n,params:t}},t.quote_ident=o,t.fully_qualify=function(e,t,r){var n=i.getTreeNodeHierarchyFromIdentifier.call(e,r),a="";void 0!==n.schema?a=o(n.schema._label):void 0!==n.view?a=o(n.view._label):void 0!==n.catalog&&(a=o(n.catalog._label));void 0!==n.package&&"package"!=t._type&&(""==a?a=o(n.package._label):a+="."+o(n.package._label));return""!=a?a+"."+o(t._label):o(t._label)},t.getRandomInt=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e},t.titleize=function(e){return""===e||null===e?e:e.split(" ").map((function(e){return e[0].toUpperCase()+e.substr(1).toLowerCase()})).join(" ")},t.sprintf=function(e){try{var t=arguments;return e.split("%s").map((function(e,r){return r>0?r<t.length?[t[r],e].join(""):["%s",e].join(""):e})).join("")}catch(t){return console.error(t),e}},t.isString=t.isFunction=t.isValidData=void 0;var n,a=(n=r(1))&&n.__esModule?n:{default:n},i=r(53);t.isValidData=function(e){return!a.default.isUndefined(e)&&!a.default.isNull(e)};t.isFunction=function(e){return a.default.isFunction(e)};function o(e){var t=!1;return isNaN(parseInt(e))||(t=!0),e.search(/[^a-z0-9_]/g)>-1&&(e=e.replace(/"/g,'""'),t=!0),t?'"'.concat(e,'"'):e}t.isString=function(e){return a.default.isString(e)}},233:function(e,t,r){"use strict";var n,a;r(8),r(21),r(15),r(11),r(5),r(9),r(7),n=[r(2),r(6),r(0),r(1),r(13),r(3),r(10),r(14),r(30),r(18),r(75),r(193),r(69),r(194),r(33),r(58)],void 0===(a=function(e,t,r,n,a,i,o,s,l,u,d,c,f,g,p){var _=d.default,b=window.wcDocker;null!=i.Browser.tree&&(i=i||window.pgAdmin||{});var h=i.Tools=i.Tools||{};if(h.DirectDebug)return h.DirectDebug;var v=new function(){};n.extend(v,s.Events,{enable:function(e,t){this.trigger("pgDebugger:button:state:"+e,t)},enable_toolbar_buttons:function(){this.enable("stop",!0),this.enable("step_over",!0),this.enable("step_into",!0),this.enable("toggle_breakpoint",!0),this.enable("clear_all_breakpoints",!0),this.enable("continue",!0)},disable_toolbar_buttons:function(){this.enable("stop",!1),this.enable("step_over",!1),this.enable("step_into",!1),this.enable("toggle_breakpoint",!1),this.enable("clear_all_breakpoints",!1),this.enable("continue",!1)},set_breakpoint:function(n,i,o){var s=t("debugger.set_breakpoint",{trans_id:n,line_no:i,set_type:o});r.ajax({url:s,method:"GET"}).done((function(e){e.data.status})).fail((function(){a.alert(e("Debugger Error"),e("Error while setting debugging breakpoint."))}))},UpdateBreakpoint:function(e){var t=this.GetBreakpointInformation(e);if(1!=t.length||-1!=t[0].linenumber){for(var r,n=new Array,a=0;a<t.length;a++)-1!=t[a].linenumber&&n.push(t[a].linenumber);for(a=0;a<n.length;a++){null!=h.DirectDebug.editor.lineInfo(n[a]-1).gutterMarkers?h.DirectDebug.editor.setGutterMarker(n[a]-1,"breakpoints",null):h.DirectDebug.editor.setGutterMarker(n[a]-1,"breakpoints",(r=void 0,(r=document.createElement("div")).style.color="#822",r.innerHTML="●",r))}}},GetBreakpointInformation:function(n){var i="",o=t("debugger.execute_query",{trans_id:n,query_type:"get_breakpoints"});return r.ajax({url:o,method:"GET",async:!1}).done((function(t){"Success"===t.data.status?i=t.data.result:"NotConnected"===t.data.status&&a.alert(e("Debugger Error"),e("Error while fetching breakpoint information."))})).fail((function(){a.alert(e("Debugger Error"),e("Error while fetching breakpoint information."))})),i},setActiveLine:function(e){var t=h.DirectDebug.editor;e&&this.active_line_no&&t.removeLineClass(this.active_line_no,"wrap","CodeMirror-activeline-background"),!e&&this.active_line_no&&(e=this.active_line_no),e>0&&(this.active_line_no=e,t.addLineClass(this.active_line_no,"wrap","CodeMirror-activeline-background"),t.centerOnLine(this.active_line_no))},start_execution:function(n,i){var o=this,s=t("debugger.start_execution",{trans_id:n,port_num:i});r.ajax({url:s,method:"GET"}).done((function(t){"Success"===t.data.status?o.execute_query(n):"NotConnected"===t.data.status&&a.alert(e("Debugger Error"),e("Error while starting debugging session."))})).fail((function(){a.alert(e("Debugger Error"),e("Error while starting debugging session."))}))},execute_query:function(n){var i=this,o=t("debugger.execute_query",{trans_id:n,query_type:"wait_for_breakpoint"});r.ajax({url:o,method:"GET"}).done((function(t){"Success"===t.data.status?(null!=t.data.result[0].src&&null!=t.data.result[0].linenumber&&(h.DirectDebug.editor.setValue(t.data.result[0].src),i.setActiveLine(t.data.result[0].linenumber-2)),i.GetStackInformation(n),h.DirectDebug.debug_type&&i.poll_end_execution_result(n)):"NotConnected"===t.data.status&&a.alert(e("Debugger Error"),e("Error while executing requested debugging information."))})).fail((function(){a.alert(e("Debugger Error"),e("Error while executing requested debugging information."))}))},GetLocalVariables:function(n){var i=this,o=t("debugger.execute_query",{trans_id:n,query_type:"get_variables"});r.ajax({url:o,method:"GET"}).done((function(t){"Success"===t.data.status?(i.AddLocalVariables(t.data.result),i.AddParameters(t.data.result),h.DirectDebug.debug_restarted&&(h.DirectDebug.debug_type&&i.poll_end_execution_result(n),h.DirectDebug.debug_restarted=!1)):"NotConnected"===t.data.status&&a.alert(e("Debugger Error"),e("Error while fetching variable information."))})).fail((function(){a.alert(e("Debugger Error"),e("Error while fetching variable information."))}))},GetStackInformation:function(n){var i=this,o=t("debugger.execute_query",{trans_id:n,query_type:"get_stack_info"});r.ajax({url:o,method:"GET"}).done((function(t){"Success"===t.data.status?(i.AddStackInformation(t.data.result),i.GetLocalVariables(h.DirectDebug.trans_id)):"NotConnected"===t.data.status&&a.alert(e("Debugger Error"),e("Error while fetching stack information."))})).fail((function(){a.alert(e("Debugger Error"),e("Error while fetching stack information."))}))},poll_result:function(n){var o=this;if(h.DirectDebug.is_polling_required){var s,l=t("debugger.poll_result",{trans_id:n});s=h.DirectDebug.polling_timeout_idle?1e3:200,setTimeout((function(){r.ajax({url:l,method:"GET",beforeSend:function(e){e.setRequestHeader(i.csrf_token_header,i.csrf_token),r(".debugger-container").addClass("show_progress")}}).done((function(t){r(".debugger-container").removeClass("show_progress"),"Success"===t.data.status?null==t.data.result||0==t.data.result.length?o.poll_result(n):(null!=t.data.result[0].src||null!=t.data.result[0].src?(h.DirectDebug.polling_timeout_idle=!1,h.DirectDebug.docker.finishLoading(50),t.data.result[0].src!=h.DirectDebug.editor.getValue()&&(h.DirectDebug.editor.setValue(t.data.result[0].src),o.UpdateBreakpoint(n)),o.setActiveLine(t.data.result[0].linenumber-2),o.GetStackInformation(n)):h.DirectDebug.debug_type||h.DirectDebug.first_time_indirect_debug?(h.DirectDebug.polling_timeout_idle=!1,h.DirectDebug.docker.finishLoading(50),t.data.result[0].src!=h.DirectDebug.editor.getValue()&&(h.DirectDebug.editor.setValue(t.data.result[0].src),o.UpdateBreakpoint(n)),o.setActiveLine(t.data.result[0].linenumber-2),o.GetStackInformation(n)):(h.DirectDebug.docker.finishLoading(50),o.setActiveLine(-1),o.clear_all_breakpoint(n),o.execute_query(n),h.DirectDebug.first_time_indirect_debug=!0,h.DirectDebug.polling_timeout_idle=!1),setTimeout((function(){o.enable_toolbar_buttons()}),500)):"Busy"===t.data.status?(h.DirectDebug.polling_timeout_idle=!0,h.DirectDebug.debug_type?o.poll_result(n):(h.DirectDebug.docker.startLoading(e("Waiting for another session to invoke the target...")),o.disable_toolbar_buttons(),h.DirectDebug.first_time_indirect_debug=!1,o.poll_result(n))):"NotConnected"===t.data.status&&a.alert(e("Debugger Error"),e("Error while polling result."))})).fail((function(){a.alert(e("Debugger Error"),e("Error while polling result."))}))}),s)}},update_messages:function(e){e=n.escape(e);var t,r="";r=(t=h.DirectDebug.messages_panel.$container.find(".messages").html())?(t+"\n"+e).replace(/(?:\r\n|\r|\n)/g,"<br />").replace(/(<br\ ?\/?>)+/g,"<br />"):e,h.DirectDebug.messages_panel.$container.find(".messages").html(r)},poll_end_execution_result:function(n){var i=this;if(h.DirectDebug.is_polling_required){var o,s=t("debugger.poll_end_execution_result",{trans_id:n});o=h.DirectDebug.polling_timeout_idle?1200:250,setTimeout((function(){r.ajax({url:s,method:"GET"}).done((function(t){"Success"===t.data.status?null==t.data.result?(i.setActiveLine(-1),h.DirectDebug.direct_execution_completed=!0,h.DirectDebug.polling_timeout_idle=!0,a.success(t.info,3),t.data.status_message&&i.update_messages(t.data.status_message),r(".debugger-container").removeClass("show_progress"),setTimeout((function(){i.enable("stop",!1),i.enable("step_over",!1),i.enable("step_into",!1),i.enable("toggle_breakpoint",!1),i.enable("clear_all_breakpoints",!1),i.enable("continue",!0)}),500),h.DirectDebug.is_polling_required=!1):null!=t.data.result&&(i.setActiveLine(-1),i.AddResults(t.data.col_info,t.data.result),h.DirectDebug.results_panel.focus(),h.DirectDebug.direct_execution_completed=!0,h.DirectDebug.polling_timeout_idle=!0,a.success(t.info,3),t.data.status_message&&i.update_messages(t.data.status_message),r(".debugger-container").removeClass("show_progress"),setTimeout((function(){i.enable("stop",!1),i.enable("step_over",!1),i.enable("step_into",!1),i.enable("toggle_breakpoint",!1),i.enable("clear_all_breakpoints",!1),i.enable("continue",!0)}),500),h.DirectDebug.is_polling_required=!1):"Busy"===t.data.status?(i.poll_end_execution_result(n),t.data.status_message&&i.update_messages(t.data.status_message)):"NotConnected"===t.data.status?a.alert(e("Debugger poll end execution error"),t.data.result):"ERROR"===t.data.status&&(h.DirectDebug.direct_execution_completed=!0,i.setActiveLine(-1),h.DirectDebug.is_user_aborted_debugging||a.error(t.info,3),t.data.status_message&&i.update_messages(t.data.status_message),h.DirectDebug.messages_panel.focus(),r(".debugger-container").removeClass("show_progress"),i.enable("stop",!1),i.enable("step_over",!1),i.enable("step_into",!1),i.enable("toggle_breakpoint",!1),i.enable("clear_all_breakpoints",!1),h.DirectDebug.is_user_aborted_debugging||(i.enable("continue",!0),h.DirectDebug.is_user_aborted_debugging=!1),h.DirectDebug.is_polling_required=!1)})).fail((function(){a.alert(e("Debugger Error"),e("Error while polling result."))}))}),o)}},Restart:function(n){var i=this,o=t("debugger.restart",{trans_id:n});i.disable_toolbar_buttons(),h.DirectDebug.messages_panel.$container.find(".messages").html(""),r.ajax({url:o}).done((function(o){var s=o.data.restart_debug?1:0;if(h.DirectDebug.polling_timeout_idle=!1,h.DirectDebug.is_polling_required=!0,i.poll_result(n),s&&(h.DirectDebug.debug_restarted=!0),o.data.result.require_input)c(o.data.result,s);else{var l=t("debugger.start_listener",{trans_id:n});r.ajax({url:l,method:"GET"}).done((function(){h.DirectDebug.debug_type&&i.poll_end_execution_result(n)})).fail((function(){a.alert(e("Debugger Error"),e("Error while polling result."))}))}})).fail((function(t){try{var r=JSON.parse(t.responseText);0==r.success&&a.alert(e("Debugger Error"),r.errormsg)}catch(e){console.warn(e.stack||e)}}))},Continue:function(n){var i=this;if(i.disable_toolbar_buttons(),h.DirectDebug.direct_execution_completed&&h.DirectDebug.direct_execution_completed==h.DirectDebug.polling_timeout_idle)i.Restart(n);else{var o=t("debugger.execute_query",{trans_id:n,query_type:"continue"});r.ajax({url:o,method:"GET"}).done((function(t){t.data.status?i.poll_result(n):a.alert(e("Debugger Error"),e("Error while executing continue in debugging session."))})).fail((function(){a.alert(e("Debugger Error"),e("Error while executing continue in debugging session."))}))}},Step_over:function(n){var i=this;i.disable_toolbar_buttons();var o=t("debugger.execute_query",{trans_id:n,query_type:"step_over"});r.ajax({url:o,method:"GET"}).done((function(t){t.data.status?i.poll_result(n):a.alert(e("Debugger Error"),e("Error while executing step over in debugging session."))})).fail((function(){a.alert(e("Debugger Error"),e("Error while executing step over in debugging session."))}))},Step_into:function(n){var i=this;i.disable_toolbar_buttons();var o=t("debugger.execute_query",{trans_id:n,query_type:"step_into"});r.ajax({url:o,method:"GET"}).done((function(t){t.data.status?i.poll_result(n):a.alert(e("Debugger Error"),e("Error while executing step into in debugging session."))})).fail((function(){a.alert(e("Debugger Error"),e("Error while executing step into in debugging session."))}))},Stop:function(n){var i=this;i.disable_toolbar_buttons();var o=t("debugger.execute_query",{trans_id:n,query_type:"abort_target"});r.ajax({url:o,method:"GET"}).done((function(t){t.data.status?(i.setActiveLine(-1),h.DirectDebug.direct_execution_completed=!0,h.DirectDebug.is_user_aborted_debugging=!0,h.DirectDebug.is_polling_required=!1,i.enable("continue",!1),a.success(t.info,3)):"NotConnected"===t.data.status&&a.alert(e("Debugger Error"),e("Error while executing stop in debugging session."))})).fail((function(){a.alert(e("Debugger Error"),e("Error while executing stop in debugging session."))}))},toggle_breakpoint:function(n){var i=this;i.disable_toolbar_buttons();var o="";o=null==h.DirectDebug.editor.lineInfo(i.active_line_no).gutterMarkers?t("debugger.set_breakpoint",{trans_id:n,line_no:i.active_line_no+1,set_type:"1"}):t("debugger.set_breakpoint",{trans_id:n,line_no:i.active_line_no+1,set_type:"0"}),r.ajax({url:o,method:"GET"}).done((function(t){var r;t.data.status?(null!=h.DirectDebug.editor.lineInfo(i.active_line_no).gutterMarkers?h.DirectDebug.editor.setGutterMarker(i.active_line_no,"breakpoints",null):h.DirectDebug.editor.setGutterMarker(i.active_line_no,"breakpoints",((r=document.createElement("div")).style.color="#822",r.innerHTML="●",r)),i.enable_toolbar_buttons()):"NotConnected"===t.data.status&&a.alert(e("Debugger Error"),e("Error while toggling breakpoint."))})).fail((function(){a.alert(e("Debugger Error"),e("Error while toggling breakpoint."))}))},clear_all_breakpoint:function(n){var i=this,o=i.GetBreakpointInformation(n);if(1!=o.length||-1!=o[0].linenumber){i.disable_toolbar_buttons();for(var s=new Array,l=0;l<o.length;l++)-1!=o[l].linenumber&&s.push(o[l].linenumber);var u=t("debugger.clear_all_breakpoint",{trans_id:n});r.ajax({url:u,method:"POST",data:{breakpoint_list:s.join()}}).done((function(e){if(e.data.status)for(var t=0;t<s.length;t++){var r=h.DirectDebug.editor.lineInfo(s[t]-1);r&&null!=r.gutterMarkers&&h.DirectDebug.editor.setGutterMarker(s[t]-1,"breakpoints",null)}i.enable_toolbar_buttons()})).fail((function(){a.alert(e("Debugger Error"),e("Error while clearing all breakpoint."))}))}},AddStackInformation:function(t){var r=this;r.stack_grid&&(r.stack_grid.remove(),r.stack_grid=null);for(var n=s.Model.extend({defaults:{frame_id:0,name:void 0,value:void 0,line_no:void 0}}),a=s.Collection.extend({model:n}),i=[{name:"name",label:e("Name"),type:"text",editable:!1,cell:"string"},{name:"value",label:e("Value"),type:"text",editable:!1,cell:"string"},{name:"line_no",label:e("Line No."),type:"text",editable:!1,cell:"string"}],o=[],u=0;u<t.length;u++)o.push({frame_id:u,name:t[u].targetname,value:t[u].args,line_no:t[u].linenumber});var d=this.stackColl=new a(o);this.stackColl.on("backgrid:row:selected",r.select_frame,r);var c=this.stack_grid=new l.Grid({emptyText:"No data found",columns:i,row:l.Row.extend({events:{click:"rowClick"},rowClick:function(){r.frame_id=this.model.get("frame_id"),this.model.trigger("backgrid:row:selected",this),r.stack_grid.$el.find("td").css("background-color",this.disabledColor),this.$el.find("td").css("background-color",this.highlightColor)}}),collection:d,className:"backgrid table table-bordered table-noouter-border table-bottom-border"});c.render(),h.DirectDebug.stack_pane_panel.$container.find(".stack_pane").append(c.el)},AddResults:function(e,t){this.result_grid&&(this.result_grid.remove(),this.result_grid=null);var r=s.Model.extend({defaults:{name:void 0}}),a=s.Collection.extend({model:r}),i=[];n.size(e)&&n.each(e,(function(e){var t={type:"text",editable:!1,cell:"string"};t.name=t.label=e.name,i.push(t)}));var o=this.result_grid=new l.Grid({emptyText:"No data found",columns:i,collection:new a(t),className:"backgrid table table-bordered table-noouter-border table-bottom-border"});o.render(),h.DirectDebug.results_panel.$container.find(".debug_results").append(o.el)},AddLocalVariables:function(t){this.variable_grid&&(this.variable_grid.remove(),this.variable_grid=null);var r=s.Model.extend({defaults:{name:void 0,type:void 0,value:void 0}}),n=s.Collection.extend({model:r});n.prototype.on("change",this.deposit_parameter_value,this);var a=[{name:"name",label:e("Name"),type:"text",editable:!1,cell:"string"},{name:"type",label:e("Type"),type:"text",editable:!1,cell:"string"},{name:"value",label:e("Value"),type:"text",cell:"string"}],i=[];if(0!=t.length)for(var o=0;o<t.length;o++)"L"==t[o].varclass&&i.push({name:t[o].name,type:t[o].dtype,value:t[o].value});var u=this.variable_grid=new l.Grid({emptyText:"No data found",columns:a,collection:new n(i),className:"backgrid table table-bordered table-noouter-border table-bottom-border"});u.collection.on("backgrid:edited",(function(e,t,r){g.setFocusToDebuggerEditor(h.DirectDebug.editor,r)})),u.render(),h.DirectDebug.local_variables_panel.$container.find(".local_variables").append(u.el)},AddParameters:function(t){this.param_grid&&(this.param_grid.remove(),this.param_grid=null);var r=s.Model.extend({defaults:{name:void 0,type:void 0,value:void 0}}),n=this.ParametersCollection=s.Collection.extend({model:r});n.prototype.on("change",this.deposit_parameter_value,this);var a=[{name:"name",label:e("Name"),type:"text",editable:!1,cell:"string"},{name:"type",label:e("Type"),type:"text",editable:!1,cell:"string"},{name:"value",label:e("Value"),type:"text",cell:"string"}],i=[];if(0!=t.length)for(var o=0;o<t.length;o++)"A"==t[o].varclass&&i.push({name:t[o].name,type:t[o].dtype,value:t[o].value});var u=this.param_grid=new l.Grid({emptyText:"No data found",columns:a,collection:new n(i),className:"backgrid table table-bordered table-noouter-border table-bottom-border"});u.collection.on("backgrid:edited",(function(e,t,r){g.setFocusToDebuggerEditor(h.DirectDebug.editor,r)})),u.render(),h.DirectDebug.parameters_panel.$container.find(".parameters").append(u.el)},deposit_parameter_value:function(n){var i=this,o=[];o.push({name:n.get("name"),type:n.get("type"),value:n.get("value")});var s=t("debugger.deposit_value",{trans_id:h.DirectDebug.trans_id});r.ajax({url:s,method:"POST",data:{data:JSON.stringify(o)}}).done((function(e){e.data.status&&(i.GetLocalVariables(h.DirectDebug.trans_id),e.data.result?a.success(e.data.info,3):a.error(e.data.info,3))})).fail((function(){a.alert(e("Debugger Error"),e("Error while depositing variable value."))}))},select_frame:function(){var n=this,i=t("debugger.select_frame",{trans_id:h.DirectDebug.trans_id,frame_id:n.frame_id});r.ajax({url:i,method:"GET"}).done((function(e){e.data.status&&(h.DirectDebug.editor.setValue(e.data.result[0].src),n.UpdateBreakpoint(h.DirectDebug.trans_id),n.setActiveLine(e.data.result[0].linenumber-2),n.GetLocalVariables(h.DirectDebug.trans_id))})).fail((function(){a.alert(e("Debugger Error"),e("Error while selecting frame."))}))}});var m=s.View.extend({el:".debugger_main_container",initialize:function(){v.on("pgDebugger:button:state:stop",this.enable_stop,this),v.on("pgDebugger:button:state:step_over",this.enable_step_over,this),v.on("pgDebugger:button:state:step_into",this.enable_step_into,this),v.on("pgDebugger:button:state:continue",this.enable_continue,this),v.on("pgDebugger:button:state:toggle_breakpoint",this.enable_toggle_breakpoint,this),v.on("pgDebugger:button:state:clear_all_breakpoints",this.enable_clear_all_breakpoints,this)},events:{"click .btn-stop":"on_stop","click .btn-clear-breakpoint":"on_clear_all_breakpoint","click .btn-toggle-breakpoint":"on_toggle_breakpoint","click .btn-continue":"on_continue","click .btn-step-over":"on_step_over","click .btn-step-into":"on_step_into",keydown:"keyAction"},enable_stop:function(e){var t=this.$el.find(".btn-stop");e?(t.prop("disabled",!1),t.removeAttr("disabled")):(t.prop("disabled",!0),t.attr("disabled","disabled"))},enable_step_over:function(e){var t=this.$el.find(".btn-step-over");e?(t.prop("disabled",!1),t.removeAttr("disabled")):(t.prop("disabled",!0),t.attr("disabled","disabled"))},enable_step_into:function(e){var t=this.$el.find(".btn-step-into");e?(t.prop("disabled",!1),t.removeAttr("disabled")):(t.prop("disabled",!0),t.attr("disabled","disabled"))},enable_continue:function(e){var t=this.$el.find(".btn-continue");e?(t.prop("disabled",!1),t.removeAttr("disabled")):(t.prop("disabled",!0),t.attr("disabled","disabled"))},enable_toggle_breakpoint:function(e){var t=this.$el.find(".btn-toggle-breakpoint");e?(t.prop("disabled",!1),t.removeAttr("disabled")):(t.prop("disabled",!0),t.attr("disabled","disabled"))},enable_clear_all_breakpoints:function(e){var t=this.$el.find(".btn-clear-breakpoint");e?(t.prop("disabled",!1),t.removeAttr("disabled")):(t.prop("disabled",!0),t.attr("disabled","disabled"))},on_stop:function(){v.Stop(h.DirectDebug.trans_id)},on_clear_all_breakpoint:function(){v.clear_all_breakpoint(h.DirectDebug.trans_id)},on_toggle_breakpoint:function(){v.toggle_breakpoint(h.DirectDebug.trans_id)},on_continue:function(){v.Continue(h.DirectDebug.trans_id)},on_step_over:function(){v.Step_over(h.DirectDebug.trans_id)},on_step_into:function(){v.Step_into(h.DirectDebug.trans_id)},keyAction:function(e){var t;t=f.processEventDebugger(this.$el,e,this.preferences,h.DirectDebug.docker),n.isNull(t)||n.isUndefined(t)||""==t||setTimeout((function(){o.Events.trigger("pgadmin:debugger:".concat(t,":focus"))}),100)}}),y=function(){};return n.extend(y.prototype,{load:function(i,o,s,l){var u=this;if(n.bindAll(h.DirectDebug,"messages"),!this.initialized){var d;this.initialized=!0,this.trans_id=i,this.debug_type=o,this.first_time_indirect_debug=!1,this.direct_execution_completed=!1,this.polling_timeout_idle=!1,this.debug_restarted=!1,this.is_user_aborted_debugging=!1,this.is_polling_required=!0,this.function_name_with_arguments=s,this.layout=l;var c=p.default.pgAdmin.Browser;this.preferences=c.get_preferences_for_module("debugger"),this.docker=new b("#container",{allowContextMenu:!1,allowCollapse:!1,loadingClass:"pg-sp-icon",themePath:t("static",{filename:"css"}),theme:"webcabin.overrides.css"}),this.panels=[],null==i||o?null!=i&&o?(d=t("debugger.start_listener",{trans_id:i}),r.ajax({url:d,method:"GET"}).done((function(e){e.data.status&&u.messages(i)})).fail((function(t){try{var r=JSON.parse(t.responseText);0==r.success&&a.alert(e("Debugger Error"),r.errormsg)}catch(t){a.alert(e("Debugger Error"),e("Error while starting debugging listener."))}}))):this.intializePanels():(d=t("debugger.start_listener",{trans_id:i}),r.ajax({url:d,method:"GET"}).done((function(e){e.data.status&&(u.intializePanels(),v.enable_toolbar_buttons(),v.poll_result(i))})).fail((function(t){try{var r=JSON.parse(t.responseText);0==r.success&&a.alert(e("Debugger Error"),r.errormsg)}catch(t){a.alert(e("Debugger Error"),e("Error while starting debugging listener."))}})))}},messages:function(n){var i=this,o=t("debugger.messages",{trans_id:n});r.ajax({url:o,method:"GET"}).done((function(t){"Success"===t.data.status?(i.intializePanels(),v.enable_toolbar_buttons(),v.start_execution(n,t.data.result)):"Busy"===t.data.status?i.messages(n):"NotConnected"===t.data.status&&a.alert(e("Not connected to server or connection with the server has been closed."),t.data.result)})).fail((function(){a.alert(e("Debugger Error"),e("Error while fetching messages information."))}))},onBreakPoint:function(e,t,r){var n;if("breakpoints"==r&&!h.DirectDebug.polling_timeout_idle){var a=e.lineInfo(t);null==a.gutterMarkers?v.set_breakpoint(this.trans_id,t+1,1):null==a.gutterMarkers.breakpoints?v.set_breakpoint(this.trans_id,t+1,1):v.set_breakpoint(this.trans_id,t+1,0);var i=a.gutterMarkers;null!=i&&null==a.gutterMarkers.breakpoints&&(i=a.gutterMarkers.breakpoints),e.setGutterMarker(t,"breakpoints",i?null:((n=document.createElement("div")).style.color="#822",n.innerHTML="●",n))}},buildDefaultLayout:function(e){var t=e.addPanel("code",b.DOCK.TOP),r=e.addPanel("parameters",b.DOCK.BOTTOM,t);e.addPanel("local_variables",b.DOCK.STACKED,r,{tabOrientation:b.TAB.TOP}),e.addPanel("messages",b.DOCK.STACKED,r),e.addPanel("results",b.DOCK.STACKED,r),e.addPanel("stack_pane",b.DOCK.STACKED,r)},intializePanels:function(){var t=this;this.registerPanel("code",t.function_name_with_arguments,"100%","50%",(function(){var r=new i.Browser.Panel({name:"parameters",title:e("Parameters"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div id ="parameters" class="parameters" tabindex="0"></div>'}),n=new i.Browser.Panel({name:"local_variables",title:e("Local variables"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div id ="local_variables" class="local_variables" tabindex="0"></div>'}),a=new i.Browser.Panel({name:"messages",title:e("Messages"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div role="status" id="messages" class="messages" tabindex="0"></div>'}),o=new i.Browser.Panel({name:"results",title:e("Results"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div id="debug_results" class="debug_results" tabindex="0"></div>'}),s=new i.Browser.Panel({name:"stack_pane",title:e("Stack"),width:"100%",height:"100%",isCloseable:!1,isPrivate:!0,content:'<div id="stack_pane" class="stack_pane" tabindex="0"></div>'});r.load(t.docker),n.load(t.docker),a.load(t.docker),o.load(t.docker),s.load(t.docker)})),o.restore_layout(t.docker,t.layout,this.buildDefaultLayout.bind(this)),t.docker.on(b.EVENT.LAYOUT_CHANGED,(function(){o.save_current_layout("Debugger/Layout",t.docker)})),t.code_editor_panel=t.docker.findPanels("code")[0],t.parameters_panel=t.docker.findPanels("parameters")[0],t.local_variables_panel=t.docker.findPanels("local_variables")[0],t.messages_panel=t.docker.findPanels("messages")[0],t.results_panel=t.docker.findPanels("results")[0],t.stack_pane_panel=t.docker.findPanels("stack_pane")[0];var n=r('<div id="stack_editor_pane" class="pg-panel-content info"></div>'),s=r('<textarea id="debugger-editor-textarea"></textarea>').appendTo(n);t.code_editor_panel.layout().addItem(n),t.editor=_.fromTextArea(s.get(0),{tabindex:-1,lineNumbers:!0,foldOptions:{widget:"…"},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","breakpoints"],mode:"text/x-pgsql",readOnly:!0,extraKeys:i.Browser.editor_shortcut_keys,indentWithTabs:i.Browser.editor_options.indent_with_tabs,indentUnit:i.Browser.editor_options.tabSize,tabSize:i.Browser.editor_options.tabSize,lineWrapping:i.Browser.editor_options.wrapCode,autoCloseBrackets:i.Browser.editor_options.insert_pair_brackets,matchBrackets:i.Browser.editor_options.brace_matching}),_.on(t.editor,"keydown",(function(e,t){27==t.keyCode&&document.activeElement.blur()})),o.Events.on("pgadmin:debugger:code:focus",(function(){t.editor.focus()}));t.docker.startLoading(e("Loading...")),t.docker.on(b.EVENT.LOADED,(function(){t.docker.finishLoading(100),t.docker.off(b.EVENT.LOADED),t.editor.on("gutterClick",t.onBreakPoint.bind(t),t),t.docker.$container&&t.docker.$container.parent().focus();var e=setInterval((function(){try{if(p.default.pgAdmin.Browser.preference_version()>0&&(clearInterval(e),t.reflectPreferences(),t.preferences.debugger_new_browser_tab)){o.bind_beforeunload();var r=setInterval((function(){p.default.pgAdmin?t.reflectPreferences():clearInterval(r)}),1e3)}}catch(t){throw clearInterval(e),t}}),0)})),this.toolbarView=new m,r(window).on("keydown",(function(e){t.toolbarView.keyAction&&t.toolbarView.keyAction(e)})),p.default.pgAdmin.Browser.onPreferencesChange("debugger",(function(){t.reflectPreferences()})),o.register_to_activity_listener(document,(function(){a.alert(e("Timeout"),e("Your session has timed out due to inactivity. Please close the window and login again."))})),v.poll_result=o.override_activity_event_decorator(v.poll_result).bind(v),v.poll_end_execution_result=o.override_activity_event_decorator(v.poll_end_execution_result).bind(v)},reflectPreferences:function(){var e=p.default.pgAdmin.Browser;this.preferences=e.get_preferences_for_module("debugger"),this.toolbarView.preferences=this.preferences,this.toolbarView.$el.find("#btn-step-into").attr("title",f.shortcut_accesskey_title("Step into",this.preferences.btn_step_into)).attr("aria-label",f.shortcut_accesskey_title("Step into",this.preferences.btn_step_into)).attr("accesskey",f.shortcut_key(this.preferences.btn_step_into)),this.toolbarView.$el.find("#btn-step-over").attr("title",f.shortcut_accesskey_title("Step over",this.preferences.btn_step_over)).attr("aria-label",f.shortcut_accesskey_title("Step over",this.preferences.btn_step_over)).attr("accesskey",f.shortcut_key(this.preferences.btn_step_over)),this.toolbarView.$el.find("#btn-continue").attr("title",f.shortcut_accesskey_title("Continue/Start",this.preferences.btn_start)).attr("aria-label",f.shortcut_accesskey_title("Continue/Start",this.preferences.btn_start)).attr("accesskey",f.shortcut_key(this.preferences.btn_start)),this.toolbarView.$el.find("#btn-toggle-breakpoint").attr("title",f.shortcut_accesskey_title("Toggle breakpoint",this.preferences.btn_toggle_breakpoint)).attr("aria-label",f.shortcut_accesskey_title("Toggle breakpoint",this.preferences.btn_toggle_breakpoint)).attr("accesskey",f.shortcut_key(this.preferences.btn_toggle_breakpoint)),this.toolbarView.$el.find("#btn-clear-breakpoint").attr("title",f.shortcut_accesskey_title("Clear all breakpoints",this.preferences.btn_clear_breakpoints)).attr("aria-label",f.shortcut_accesskey_title("Clear all breakpoints",this.preferences.btn_clear_breakpoints)).attr("accesskey",f.shortcut_key(this.preferences.btn_clear_breakpoints)),this.toolbarView.$el.find("#btn-stop").attr("title",f.shortcut_accesskey_title("Stop",this.preferences.btn_stop)).attr("aria-label",f.shortcut_accesskey_title("Stop",this.preferences.btn_stop)).attr("accesskey",f.shortcut_key(this.preferences.btn_stop))},registerPanel:function(e,t,n,a,i){var o=this;this.docker.registerPanelType(e,{title:t,isPrivate:!0,onCreate:function(s){o.panels[e]=s,s.initSize(n,a),t?s.title(t):s.title(!1),s.closeable(!1),s.layout().addItem(r('<div tabindex="0">',{class:"pg-debugger-panel"})),i&&i.apply(o,[s])}})}}),h.DirectDebug=new y,h.DirectDebug.jquery=r,h.DirectDebug}.apply(t,n))||(e.exports=a)},3:function(e,t,r){"use strict";(function(n){var a;function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}r(19),r(26),r(27),r(17),r(56),r(32),r(12),r(79),r(35),r(5),r(43),r(23),r(59),r(9),r(29),r(20),void 0===(a=function(){var e=window.pgAdmin=window.pgAdmin||{};function t(e,t,r){return void 0===r||0==+r?Math[e](t):(t=+t,r=+r,isNaN(t)||"number"!=typeof r||r%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-r:-r)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+r:r))))}return function(e,t,r){function n(e,t,n,i){n=n||"width";var o,l,u,f=(t.match(d)||[])[2],g="px"===f?1:c[f+"toPx"];if(g||/r?em/i.test(f)&&!i)e=g?e:"rem"===f?s:"fontSize"===n&&e.parentNode||e,g=g||parseFloat(a(e,"fontSize")),u=parseFloat(t)*g;else{l=(o=e.style)[n];try{o[n]=t}catch(e){return 0}u=o[n]?parseFloat(a(e,n)):0,o[n]=l!==r?l:null}return u}function a(e,t){var r,o,s,l,c,f=["paddingTop","paddingBottom","borderTop","borderBottom"],g=4;if(o=e.style["pixel"+t.charAt(0).toUpperCase()+t.slice(1)],"%"===(s=((r=u?u(e)[t]:o?o+"px":"fontSize"===t?n(e,"1em","left",1)+"px":e.currentStyle[t]).match(d)||[])[2])&&i)if(/^top|bottom/.test(t)){for(l=(c=e.parentNode||e).offsetHeight;g--;)l-=parseFloat(a(c,f[g]));r=parseFloat(r)/100*l+"px"}else r=n(e,r);else("auto"===r||s&&"px"!==s)&&u?r=0:s&&"px"!==s&&!u&&(r=n(e,r)+"px");return r}var i,o=t.createElement("test"),s=t.documentElement,l=t.defaultView,u=l&&l.getComputedStyle,d=/^(-?[\d+\.\-]+)([a-z]+|%)$/i,c={},f=[1/25.4,1/2.54,1/72,1/6],g=["mm","cm","pt","pc","in","mozmm"],p=6;for(s.appendChild(o),u&&(o.style.marginTop="1%",i="1%"===u(o).marginTop);p--;)c[g[p]+"toPx"]=f[p]?f[p]*c.inToPx:n(o,"1"+g[p]);s.removeChild(o),o=r,e.toPx=n}(e,window.document),e.natural_sort=function(e,t,r){r=r||{};var n,a,o=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,s=/(^[ ]*|[ ]*$)/g,l=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,u=/^0x[0-9a-f]+$/i,d=/^0/,c=function(e){return r.insensitive&&(""+e).toLowerCase()||""+e},f=c(e).replace(s,"")||"",g=c(t).replace(s,"")||"",p=f.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),_=g.replace(o,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),b=parseInt(f.match(u))||1!==p.length&&f.match(l)&&Date.parse(f),h=parseInt(g.match(u))||b&&g.match(l)&&Date.parse(g)||null,v=r.desc?-1:1;if(h){if(b<h)return-1*v;if(b>h)return 1*v}for(var m=0,y=Math.max(p.length,_.length);m<y;m++){if(n=!(p[m]||"").match(d)&&parseFloat(p[m])||p[m]||0,a=!(_[m]||"").match(d)&&parseFloat(_[m])||_[m]||0,isNaN(n)!==isNaN(a))return(isNaN(n)?1:-1)*v;if(i(n)!==i(a)&&(n+="",a+=""),n<a)return-1*v;if(n>a)return 1*v}return 0},Math.round10||(Math.round10=function(e,r){return t("round",e,r)}),Math.floor10||(Math.floor10=function(e,r){return t("floor",e,r)}),Math.ceil10||(Math.ceil10=function(e,r){return t("ceil",e,r)}),e}.apply(t,[]))||(e.exports=a)}).call(this,r(3))},33:function(e,t,r){"use strict";r(4),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){var e=null;try{e=window.opener&&window.opener.pgAdmin?function e(t){return t.opener&&t.opener.pgAdmin?e(t.opener):t}(window.opener):window.parent&&window.parent.pgAdmin?window.parent:window.top&&window.top.pgAdmin?window.top:window}catch(t){e=window}return e}();t.default=n},53:function(e,t,r){"use strict";(function(e){function n(t){var r=0,n=0,i={};do{var o=t.getData();if(o._type in this.Nodes&&this.Nodes[o._type].hasId){var s=a(o._type,n);void 0===i[s]&&(i[s]=e.extend({},o,{priority:r}),r-=1)}n+=1,t=t.hasParent()?t.parent():null}while(t);return i}function a(e,t){return"partition"===e&&t>0?"table":e}r(4),Object.defineProperty(t,"__esModule",{value:!0}),t.getTreeNodeHierarchyFromElement=function(e,t){return n.call(e,t)},t.getTreeNodeHierarchyFromIdentifier=function(e){var t=this.treeMenu.translateTreeNodeIdFromACITree(e),r=this.treeMenu.findNode(t);return null===r?null:n.call(this,r)},t.getTreeNodeHierarchy=n}).call(this,r(1))},57:function(e,t,r){"use strict";var n,a;r(21),r(56),r(138),r(5),r(9),n=[r(0),r(1),r(2),r(6)],void 0===(a=function(e,t,r,n){var a={epicRandomString:function(e){for(var t=[],r=0;r<36;r++)t[r]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]="0123456789abcdef".substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("").replace(/-/g,"").substr(0,e)},getHash:function(e){for(var t=0,r=e.length,n=0;n<r;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t},calculateColumnWidth:function(t){e("body").append('<span id="pg_text" style="visibility: hidden;">'+t+"</span>");var r=e("#pg_text").width()+23;return e("#pg_text").remove(),r},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},previousStatus:null,fetchConnectionStatus:function(t,i,o){var s=n("sqleditor.connection_status",{trans_id:t.transId});if("visible"===document.visibilityState&&"visible"===i.data("panel-visible")&&!o.hasClass("obtaining-conn")){var l=t;e.ajax({url:s,method:"GET"}).done((function(e){if(e&&e.data){var t=e.data.status,n=e.data.message,s=!1;switch(l.update_notifications(e.data.notifies),t){case 1:t!=a.previousStatus||o.hasClass("fa-hourglass-half")||(o.removeClass().addClass("fa fa-hourglass-half"),s=!0);break;case 2:a.previousStatus==t||o.hasClass("fa-clock-o")||(o.removeClass().addClass("fa fa-clock-o"),s=!0);break;case 3:a.previousStatus==t||o.hasClass("fa-exclamation-circle")||(o.removeClass().addClass("fa fa-exclamation-circle"),s=!0);break;case 4:a.previousStatus==t||o.hasClass("fa-exclamation-triangle")||(o.removeClass().addClass("fa fa-exclamation-triangle"),s=!0);break;default:a.previousStatus==t||o.hasClass("fa-query_tool_connected")||(o.removeClass().addClass("pg-font-icon icon-query-tool-connected"),s=!0)}a.previousStatus=t,s&&(i.popover("hide"),i.attr("data-content",n))}else a.previousStatus=-99,n=r("An unexpected error occurred - ensure you are logged into the application."),i.attr("data-content",n),o.hasClass("icon-query-tool-disconnected")||(i.popover("hide"),o.removeClass().addClass("pg-icon-font icon-query-tool-disconnected"))})).fail((function(e){a.previousStatus=-1;var t=r("Transaction status check failed.");0==e.readyState?t=r("Not connected to the server or the connection to the server has been closed."):e.responseJSON&&e.responseJSON.errormsg&&(t=e.responseJSON.errormsg),i.attr("data-content",t),o.hasClass("icon-query-tool-disconnected")||(i.popover("hide"),o.removeClass().addClass("pg-font-icon icon-query-tool-disconnected"))}))}},updateConnectionStatusFlag:function(t){var r=e(".connection_status");r.data("panel-visible")!=t&&r.data("panel-visible",t)},calcFontSize:function(e){if(e){var t=Number(Math.round(e+"e+2")+"e-2");if(t>0)return t+"em"}return"1em"},addEditableIcon:function(e,r){var n={cssClass:"editable-column-header-icon",content:r?'<i class="fa fa-pencil"></i>':'<i class="fa fa-lock"></i>'};t.isUndefined(e.header)||t.isUndefined(e.header.buttons)?e.header={buttons:[n]}:e.header.buttons.push(n)}};return a}.apply(t,n))||(e.exports=a)},6:function(e,t,r){"use strict";var n,a;r(5),r(9),n=[r(90)],void 0===(a=function(e){return function(t,r){var n=e[t],a=n;return n?a=a.replace(/([<])([^:^>]*:)?([^>]+)([>])/g,(function(e,t,n,a){return a in r?r[a]:e})):n}}.apply(t,n))||(e.exports=a)},69:function(e,t,r){"use strict";r(28),r(8),r(4),r(5),r(61),Object.defineProperty(t,"__esModule",{value:!0}),t.processEventDebugger=function(e,t,r,a){var i,o,s="";this.validateShortcutKeys(r.edit_grid_values,t)?(this._stopEventPropagation(t),(i=e.find('div.wcPanelTabContent:not(".wcPanelTabContentHidden")')).length&&(o=(0,n.default)(i).find("td.editable:first")).length&&o.trigger("click")):this.validateShortcutKeys(r.move_next,t)?(this._stopEventPropagation(t),s=_(a,"right")):this.validateShortcutKeys(r.move_previous,t)?(this._stopEventPropagation(t),s=_(a,"left")):this.validateShortcutKeys(r.switch_panel,t)&&(this._stopEventPropagation(t),s=_(a,"switch"));return s},t.processEventQueryTool=function(e,t,r,a){if(e.isQueryRunning())return;var i=r.which||r.keyCode,o="",p=e.preferences.execute_query,b=e.preferences.explain_query,h=e.preferences.explain_analyze_query,v=e.preferences.download_csv,m=e.preferences.move_next,y=e.preferences.move_previous,w=e.preferences.switch_panel,k=e.preferences.toggle_case,D=e.preferences.commit_transaction,x=e.preferences.rollback_transaction,S=e.preferences.save_data;if(this.validateShortcutKeys(p,r))this._stopEventPropagation(r),t.executeQuery(e);else if(this.validateShortcutKeys(b,r))this._stopEventPropagation(r),t.explain(e);else if(this.validateShortcutKeys(h,r))this._stopEventPropagation(r),t.explainAnalyze(e);else if(this.validateShortcutKeys(v,r))this._stopEventPropagation(r),t.download(e);else if(this.validateShortcutKeys(k,r))this._stopEventPropagation(r),t.toggleCaseOfSelectedText(e);else if(this.validateShortcutKeys(D,r))e.is_transaction_buttons_disabled||(this._stopEventPropagation(r),t.executeCommit(e));else if(this.validateShortcutKeys(x,r))e.is_transaction_buttons_disabled||(this._stopEventPropagation(r),t.executeRollback(e));else if(this.validateShortcutKeys(S,r))this._stopEventPropagation(r),t.saveDataChanges(e);else if((this.isMac()&&r.metaKey||!this.isMac()&&r.ctrlKey)&&!r.altKey&&r.shiftKey&&i===l)this._stopEventPropagation(r),t.commentBlockCode(e);else if((this.isMac()&&!this.isKeyCtrlAltShift(r)&&r.metaKey||!this.isMac()&&!this.isKeyAltShift(r)&&r.ctrlKey)&&i===l)this._stopEventPropagation(r),t.commentLineCode(e);else if((this.isMac()&&!this.isKeyCtrlAltShift(r)&&r.metaKey||!this.isMac()&&!this.isKeyAltShift(r)&&r.ctrlKey)&&i===s)this._stopEventPropagation(r),t.uncommentLineCode(e);else if(i==u)t.focusOut(e),(0,n.default)(r.target).hasClass("dropdown-item")&&(0,n.default)(r.target).closest(".dropdown-submenu").length>0&&(0,n.default)(r.target).closest(".dropdown-submenu").find(".dropdown-menu").removeClass("show");else if(this.validateShortcutKeys(m,r))this._stopEventPropagation(r),o=_(a,"right");else if(this.validateShortcutKeys(y,r))this._stopEventPropagation(r),o=_(a,"left");else if(this.validateShortcutKeys(w,r))this._stopEventPropagation(r),o=_(a,"switch");else if(i===c||i===g){if((0,n.default)(r.target).closest(".dropdown-menu").length>0){this._stopEventPropagation(r);var T=(0,n.default)(r.target).closest("li");for((0,n.default)(r.target).closest(".dropdown-menu").find(".show").removeClass("show"),i===c?T=T.prev():i===g&&(T=T.next());T.hasClass("dropdown-divider")||T.hasClass("d-none")||T.find(".dropdown-item").first().hasClass("disabled");)i===c?T=T.prev():i===g&&(T=T.next());T.find(".dropdown-item").trigger("focus")}}else if((i===d||i===f)&&(0,n.default)(r.target).closest(".dropdown-menu").length>0){this._stopEventPropagation(r);var C=(0,n.default)(r.target).closest("li");if(i===f)C.hasClass("dropdown-submenu")&&(C.find(".dropdown-menu").addClass("show"),C=C.find(".dropdown-menu .dropdown-item").first().trigger("focus"));else if(i===d){var E=C.closest(".dropdown-menu");E.closest(".dropdown-submenu").length>0&&(E.removeClass("show"),(C=E.closest(".dropdown-submenu")).find(".dropdown-item").trigger("focus"))}}return o},t.focusDockerPanel=_,t.validateShortcutKeys=function(e,t){if(!e)return!1;var r=t.which||t.keyCode;return e.alt==t.altKey&&e.shift==t.shiftKey&&e.control==t.ctrlKey&&e.key.key_code==r},t._stopEventPropagation=function(e){e.cancelBubble=!0,e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},t.isMac=function(){return-1!=window.navigator.platform.search("Mac")},t.isKeyCtrlAlt=function(e){return e.ctrlKey||e.altKey},t.isKeyAltShift=function(e){return e.altKey||e.shiftKey},t.isKeyCtrlShift=function(e){return e.ctrlKey||e.shiftKey},t.isKeyCtrlAltShift=function(e){return e.ctrlKey||e.altKey||e.shiftKey},t.isAltShiftBoth=function(e){return e.altKey&&e.shiftKey&&!e.ctrlKey},t.isCtrlShiftBoth=function(e){return e.ctrlKey&&e.shiftKey&&!e.altKey},t.isCtrlAltBoth=function(e){return e.ctrlKey&&e.altKey&&!e.shiftKey},t.shortcut_key=p,t.shortcut_title=function(e,t){var r="";if(null==t)return r;t.alt&&(r=(0,a.default)("Alt")+"+");t.shift&&(r+=(0,a.default)("Shift")+"+");t.control&&(r+=(0,a.default)("Ctrl")+"+");return r+=p(t),"".concat(e," (").concat(r,")")},t.shortcut_accesskey_title=function(e,t){return"".concat(e," (").concat((0,a.default)("accesskey")," + ").concat(p(t),")")};var n=o(r(0)),a=o(r(2)),i=r(22);function o(e){return e&&e.__esModule?e:{default:e}}var s=190,l=191,u=27,d=37,c=38,f=39,g=40;function p(e){var t="";return e.key&&e.key.char&&(t=e.key.char.toUpperCase()),t}function _(e,t){if(e){if(!e._focusFrame){if(0==e._frameList.length&&0==e._frameList[0]._panelList.length)return;e._frameList[0]._panelList[e._frameList[0]._curTab].focus()}var r=e._focusFrame,n=0,a=!1;if("switch"==t){var o=0,s=e._frameList.length;for(o=0;o<s&&r!==e._frameList[o];o++);n=(r=e._frameList[(0,i.getMod)(o+1,s)])._curTab,a=!0}else"left"==t?(n=(0,i.getMod)(r._curTab-1,r._panelList.length),a=!1):"right"==t&&(n=(0,i.getMod)(r._curTab+1,r._panelList.length),a=!1);var l=r._panelList[n];return l.$container.find('*[tabindex]:not([tabindex="-1"])').trigger("focus"),l.focus(a),l._type}}},86:function(e,t,r){"use strict";r(4),r(12),r(143),Object.defineProperty(t,"__esModule",{value:!0}),t.setPGCSRFToken=function(e,t){if(!t)throw"csrf-token meta tag has not been set";var r=a.default.sync;a.default.sync=function(n,a,i){return i.beforeSend=function(r){r.setRequestHeader(e,t)},r(n,a,i)};var o=a.default.get;a.default.get=function(r,n,a){return a.beforeSend=function(r){r.setRequestHeader(e,t)},o(r,n,a)},n.default.ajaxSetup({beforeSend:function(r){r.setRequestHeader(e,t)}}),i.default.interceptors.request.use((function(r){return r.headers[e]=t,r}),(function(e){return Promise.reject(e)}))};var n=o(r(0)),a=o(r(14)),i=o(r(66));function o(e){return e&&e.__esModule?e:{default:e}}},87:function(e,t,r){"use strict";r(8);var n=o(r(0)),a=o(r(1)),i=o(r(33));function o(e){return e&&e.__esModule?e:{default:e}}e.exports={modifyAcitreeAnimation:function(e,t){var r=e.get_preference("browser","enable_acitree_animation").value;a.default.isUndefined(t)&&(t=e.tree),r?t.options({animateRoot:!0,unanimated:!1,show:a.default.extend(t.options().show,{duration:75}),hide:a.default.extend(t.options().hide,{duration:75}),view:a.default.extend(t.options().view,{duration:75})}):t.options({animateRoot:!1,unanimated:!0,show:a.default.extend(t.options().show,{duration:0}),hide:a.default.extend(t.options().hide,{duration:0}),view:a.default.extend(t.options().view,{duration:0})})},modifyAlertifyAnimation:function(e){(a.default.isUndefined(e)||a.default.isNull(e))&&(e=i.default.pgAdmin.Browser),e.get_preference("browser","enable_alertify_animation").value?((0,n.default)(document).find("body").removeClass("alertify-no-animation"),a.default.each(document.getElementsByTagName("iframe"),(function(e){(0,n.default)(e.contentDocument).find("body").removeClass("alertify-no-animation")}))):((0,n.default)(document).find("body").addClass("alertify-no-animation"),a.default.each(document.getElementsByTagName("iframe"),(function(e){(0,n.default)(e.contentDocument).find("body").addClass("alertify-no-animation")})))}}},89:function(t,r){t.exports=e},90:function(e,r){e.exports=t}}).default}));