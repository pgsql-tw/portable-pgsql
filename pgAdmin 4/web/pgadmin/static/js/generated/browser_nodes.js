(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{124:function(e,t,i){"use strict";var n,o;i(16),i(36),i(11),i(5),i(9),i(7),i(37),n=[i(2),i(6),i(0),i(1),i(14),i(3),i(10),i(238),i(125),i(13),i(18),i(195),i(67)],void 0===(o=function(e,t,i,n,o,l,a,r,s,d,c,p){if(!a.Nodes.server){var u=["prefer","require","verify-ca","verify-full"];a.SecLabelModel=a.Node.Model.extend({defaults:{provider:void 0,label:void 0},schema:[{id:"provider",label:e("Provider"),type:"text",editable:!0,cellHeaderClasses:"width_percent_50"},{id:"label",label:e("Security label"),type:"text",editable:!0,cellHeaderClasses:"override_label_class_font_size"}],validate:function(){if(this.errorModel.clear(),n.isUndefined(this.get("label"))||n.isNull(this.get("label"))||""==String(this.get("label")).replace(/^\s+|\s+$/g,"")){var t=e("Security label must be specified.");return this.errorModel.set("label",t),t}return null}}),l.Browser.Nodes.server=l.Browser.Node.extend({parent_type:"server_group",type:"server",dialogHelp:t("help.static",{filename:"server_dialog.html"}),label:e("Server"),canDrop:!0,dropAsRemove:!0,dropPriority:5,hasStatistics:!0,hasCollectiveStatistics:!0,can_expand:function(e){return e&&e.connected},Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_server_on_sg",node:"server_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("Server..."),data:{action:"create"},icon:"wcTabIcon icon-server"},{name:"create_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:3,label:e("Server..."),data:{action:"create"},icon:"wcTabIcon icon-server"},{name:"connect_server",node:"server",module:this,applies:["object","context"],callback:"connect_server",category:"connect",priority:4,label:e("Connect Server"),icon:"fa fa-link",enable:"is_not_connected"},{name:"disconnect_server",node:"server",module:this,applies:["object","context"],callback:"disconnect_server",category:"drop",priority:5,label:e("Disconnect Server"),icon:"fa fa-chain-broken",enable:"is_connected"},{name:"reload_configuration",node:"server",module:this,applies:["tools","context"],callback:"reload_configuration",category:"reload",priority:6,label:e("Reload Configuration"),icon:"fa fa-repeat",enable:"enable_reload_config"},{name:"restore_point",node:"server",module:this,applies:["tools","context"],callback:"restore_point",category:"restore",priority:9,label:e("Add Named Restore Point..."),icon:"fa fa-anchor",enable:"is_applicable"},{name:"change_password",node:"server",module:this,applies:["object"],callback:"change_password",label:e("Change Password..."),priority:10,icon:"fa fa-lock",enable:"is_connected"},{name:"wal_replay_pause",node:"server",module:this,applies:["tools","context"],callback:"pause_wal_replay",category:"wal_replay_pause",priority:7,label:e("Pause Replay of WAL"),icon:"fa fa-pause-circle",enable:"wal_pause_enabled"},{name:"wal_replay_resume",node:"server",module:this,applies:["tools","context"],callback:"resume_wal_replay",category:"wal_replay_resume",priority:8,label:e("Resume Replay of WAL"),icon:"fa fa-play-circle",enable:"wal_resume_enabled"},{name:"clear_saved_password",node:"server",module:this,applies:["object","context"],callback:"clear_saved_password",label:e("Clear Saved Password"),icon:"fa fa-eraser",priority:11,enable:function(e){return!(!e||"server"!==e._type||!e.is_password_saved)}},{name:"clear_sshtunnel_password",node:"server",module:this,applies:["object","context"],callback:"clear_sshtunnel_password",label:e("Clear SSH Tunnel Password"),icon:"fa fa-eraser",priority:12,enable:function(e){return!(!e||"server"!==e._type||!e.is_tunnel_password_saved)}}]),n.bindAll(this,"connection_lost"),a.Events.on("pgadmin:server:connection:lost",this.connection_lost))},is_not_connected:function(e){return e&&1!=e.connected},is_connected:function(e){return e&&1==e.connected},enable_reload_config:function(e){return!!(e&&"server"==e._type&&e.connected&&e.user.is_superuser)},is_applicable:function(e){return!!(e&&"server"==e._type&&e.connected&&e.user.is_superuser&&0==e.in_recovery)},wal_pause_enabled:function(e){return!!(e&&"server"==e._type&&e.connected&&e.user.is_superuser&&1==e.in_recovery&&0==e.wal_pause)},wal_resume_enabled:function(e){return!!(e&&"server"==e._type&&e.connected&&e.user.is_superuser&&1==e.in_recovery&&1==e.wal_pause)},callbacks:{connect_server:function(e){var t=e||{},i=a.tree,n=t.item||i.selected(),o=n&&1==n.length?i.itemData(n):void 0;return!!o&&(m(this,o,i,n,!1),!1)},disconnect_server:function(t,o){var l=t||{},r=this,s=a.tree,c="item"in l?l.item:s.selected(),p=c&&1==c.length?s.itemData(c):void 0;if(!p)return!1;o=o||n.isUndefined(o)||n.isNull(o);var u=function(){i.ajax({url:r.generate_url(c,"connect",p,!0),type:"DELETE"}).done((function(e){if(1==e.success)d.success(e.info),p=s.itemData(c),s.removeIcon(c),p.connected=!1,p.icon="icon-server-not-connected",s.addIcon(c,{icon:p.icon}),r.callbacks.refresh.apply(r,[null,c]),a.serverInfo&&p._id in a.serverInfo&&delete a.serverInfo[p._id],a.enable_disable_menus(c),a.Events.trigger("pgadmin:server:disconnect",{item:c,data:p},!1);else{try{d.error(e.errormsg)}catch(e){console.warn(e.stack||e)}s.unload(c)}})).fail((function(e,t,i){d.pgRespErrorNotify(e,i),s.unload(c)}))};return o?d.confirm(e("Disconnect server"),e("Are you sure you want to disconnect the server %s?",p.label),(function(){u()}),(function(){return!0})):u(),!1},beforeopen:function(e,t){return!(!t||"server"!=t._type)&&(a.tree.addIcon(e,{icon:t.icon}),!!t.connected||(m(this,t,a.tree,e,!1),!1))},added:function(e,t){return a.serverInfo=a.serverInfo||{},a.serverInfo[t._id]=n.extend({},t),l.Browser.Node.callbacks.added.apply(this,arguments),t.was_connected&&h(this,t,a.tree,e),!0},reload_configuration:function(t){var n=t||{},o=this,l=a.tree,r=n.item||l.selected(),s=r&&1==r.length?l.itemData(r):void 0;return!!s&&(d.confirm(e("Reload server configuration"),e("Are you sure you want to reload the server configuration on %s?",s.label),(function(){i.ajax({url:o.generate_url(r,"reload",s,!0),method:"GET"}).done((function(e){e.data.status?d.success(e.data.result):d.error(e.data.result)})).fail((function(e,t,i){d.pgRespErrorNotify(e,i),l.unload(r)}))}),(function(){return!0})),!1)},restore_point:function(t){var o=t||{},l=this,r=a.tree,s=o.item||r.selected(),c=s&&1==s.length?r.itemData(s):void 0;if(!c)return!1;d.prompt(e("Enter the name of the restore point to add"),"",(function(t,o){n.isUndefined(o)||n.isNull(o)||""===o||""===String(o).replace(/^\s+|\s+$/g,"")?(t.cancel=!0,d.error(e("Please enter a valid name."),10)):i.ajax({url:l.generate_url(s,"restore_point",c,!0),method:"POST",data:{value:JSON.stringify(o)}}).done((function(e){d.success(e.data.result,10)})).fail((function(e,t,i){d.pgRespErrorNotify(e,i),r.unload(s)}))}),(function(e){e.cancel=!1})).set({title:e("Restore point name")})},change_password:function(t){var l=t||{},r=a.tree,s=l.item||r.selected(),p=s&&1==s.length?r.itemData(s):void 0,u=this.generate_url(s,"change_password",p,!0),m=!1,h=this.generate_url(s,"check_pgpass",p,!0);if(!p)return!1;if(!d.changeServerPassword){var g=o.Model.extend({defaults:{user_name:void 0,password:void 0,newPassword:void 0,confirmPassword:void 0},validate:function(){return null}}),f=[{name:"user_name",label:e("User"),type:"text",readonly:!0,control:"input"},{name:"password",label:e("Current Password"),type:"password",disabled:function(){return m},control:"input",required:!0},{name:"newPassword",label:e("New Password"),type:"password",disabled:!1,control:"input",required:!0},{name:"confirmPassword",label:e("Confirm Password"),type:"password",disabled:!1,control:"input",required:!0}];d.dialog("changeServerPassword",(function(){return{main:function(t){var i=e("Change Password ");this.set("title",i),this.user_name=t.user.name},setup:function(){return{buttons:[{text:e("Cancel"),key:27,className:"btn btn-secondary fa fa-times pg-alertify-button",attrs:{name:"cancel"}},{text:e("OK"),key:13,className:"btn btn-primary fa fa-check pg-alertify-button",attrs:{name:"submit"}}],options:{padding:!1,overflow:!1,modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1}}},hooks:{onclose:function(){this.view&&this.view.remove({data:!0,internal:!0,silent:!0})}},prepare:function(){var t=this;this.__internal.buttons[1].element.disabled=!0;var o=i("<div class='change_password'></div>"),l=new g({user_name:t.user_name});(this.view=new c.Form({el:o,model:l,fields:f})).render(),this.elements.content.appendChild(o.get(0)),this.view.model.on("change",(function(){var i=this,o=this.get("password"),l=this.get("newPassword"),a=this.get("confirmPassword");!m&&(n.isUndefined(o)||n.isNull(o)||""==o)||n.isUndefined(l)||n.isNull(l)||""==l||n.isUndefined(a)||n.isNull(a)||""==a?t.__internal.buttons[1].element.disabled=!0:l!=a?(t.__internal.buttons[1].element.disabled=!0,this.errorTimeout&&clearTimeout(this.errorTimeout),this.errorTimeout=setTimeout((function(){i.errorModel.set("confirmPassword",e("Passwords do not match."))}),400)):(i.errorModel.clear(),t.__internal.buttons[1].element.disabled=!1)}))},callback:function(t){if("submit"==t.button.element.name){var n=this,o=this.view.model.toJSON();t.cancel=!0,i.ajax({url:u,method:"POST",data:{data:JSON.stringify(o)}}).done((function(t){t.success?(m&&d.alert(e("Change Password"),e("Please make sure to disconnect the server and update the new password in the pgpass file before performing any other operation")),d.success(t.info),n.close()):d.error(t.errormsg)})).fail((function(e,t,i){d.pgRespErrorNotify(e,i)}))}}}}))}return i.ajax({url:h,method:"GET"}).done((function(e){e.success&&e.data.is_pgpass&&(m=!0),d.changeServerPassword(p).resizeTo("40%","52%")})).fail((function(e,t,i){d.pgRespErrorNotify(e,i)})),!1},pause_wal_replay:function(e){var t=e||{},n=a.tree,o=t.item||n.selected(),l=o&&1==o.length?n.itemData(o):void 0;if(!l)return!1;i.ajax({url:this.generate_url(o,"wal_replay",l,!0),type:"DELETE",dataType:"json"}).done((function(e){1==e.success&&(d.success(e.info),n.itemData(o).wal_pause=e.data.wal_pause,n.unload(o),n.setInode(o),n.deselect(o),setTimeout((function(){n.select(o)}),10))})).fail((function(e,t,i){d.pgRespErrorNotify(e,i),n.unload(o)}))},resume_wal_replay:function(e){var t=e||{},n=a.tree,o=t.item||n.selected(),l=o&&1==o.length?n.itemData(o):void 0;if(!l)return!1;i.ajax({url:this.generate_url(o,"wal_replay",l,!0),type:"PUT",dataType:"json"}).done((function(e){1==e.success&&(d.success(e.info),n.itemData(o).wal_pause=e.data.wal_pause,n.unload(o),n.setInode(o),n.deselect(o),setTimeout((function(){n.select(o)}),10))})).fail((function(e,t,i){d.pgRespErrorNotify(e,i),n.unload(o)}))},clear_saved_password:function(t){var n=t||{},o=this,l=a.tree,r=n.item||l.selected(),s=r&&1==r.length?l.itemData(r):void 0;return!!s&&(d.confirm(e("Clear saved password"),e("Are you sure you want to clear the saved password for server %s?",s.label),(function(){i.ajax({url:o.generate_url(r,"clear_saved_password",s,!0),method:"PUT"}).done((function(e){1==e.success?(d.success(e.info),l.itemData(r).is_password_saved=e.data.is_password_saved):d.error(e.info)})).fail((function(e,t,i){d.pgRespErrorNotify(e,i)}))}),(function(){return!0})),!1)},clear_sshtunnel_password:function(t){var n=t||{},o=this,l=a.tree,r=n.item||l.selected(),s=r&&1==r.length?l.itemData(r):void 0;return!!s&&(d.confirm(e("Clear SSH Tunnel password"),e("Are you sure you want to clear the saved password of SSH Tunnel for server %s?",s.label),(function(){i.ajax({url:o.generate_url(r,"clear_sshtunnel_password",s,!0),method:"PUT"}).done((function(e){1==e.success?(d.success(e.info),l.itemData(r).is_tunnel_password_saved=e.data.is_tunnel_password_saved):d.error(e.info)})).fail((function(e,t,i){d.pgRespErrorNotify(e,i)}))}),(function(){return!0})),!1)}},model:l.Browser.Node.Model.extend({defaults:{gid:void 0,id:void 0,name:"",sslmode:"prefer",host:"",hostaddr:"",port:5432,db:"postgres",username:s.name,role:null,connect_now:!0,password:void 0,save_password:!1,db_res:"",passfile:void 0,sslcompression:!1,sslcert:void 0,sslkey:void 0,sslrootcert:void 0,sslcrl:void 0,service:void 0,use_ssh_tunnel:0,tunnel_host:void 0,tunnel_port:22,tunnel_username:void 0,tunnel_identity_file:void 0,tunnel_password:void 0,tunnel_authentication:0,save_tunnel_password:!1,connect_timeout:10},initialize:function(e,t){var i=0===n.size(e);i&&this.set({gid:t.node_info.server_group._id}),l.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"id",label:e("ID"),type:"int",mode:["properties"]},{id:"name",label:e("Name"),type:"text",mode:["properties","edit","create"]},{id:"gid",label:e("Server group"),type:"int",control:"node-list-by-id",node:"server_group",mode:["create","edit"],select2:{allowClear:!1}},{id:"server_type",label:e("Server type"),type:"options",mode:["properties"],visible:"isConnected",options:r},{id:"connected",label:e("Connected?"),type:"switch",mode:["properties"],group:e("Connection"),options:{onText:e("True"),offText:e("False"),size:"mini"}},{id:"version",label:e("Version"),type:"text",group:null,mode:["properties"],visible:"isConnected"},{id:"bgcolor",label:e("Background"),type:"color",group:null,mode:["edit","create"],disabled:"isfgColorSet",deps:["fgcolor"]},{id:"fgcolor",label:e("Foreground"),type:"color",group:null,mode:["edit","create"],disabled:"isConnected"},{id:"connect_now",controlLabel:e("Connect now?"),type:"checkbox",group:null,mode:["create"]},{id:"comment",label:e("Comments"),type:"multiline",group:null,mode:["properties","edit","create"]},{id:"host",label:e("Host name/address"),type:"text",group:e("Connection"),mode:["properties","edit","create"],readonly:"isConnected"},{id:"port",label:e("Port"),type:"int",group:e("Connection"),mode:["properties","edit","create"],readonly:"isConnected",min:1,max:65535},{id:"db",label:e("Maintenance database"),type:"text",group:e("Connection"),mode:["properties","edit","create"],readonly:"isConnected"},{id:"username",label:e("Username"),type:"text",group:e("Connection"),mode:["properties","edit","create"],readonly:"isConnected"},{id:"password",label:e("Password"),type:"password",group:e("Connection"),control:"input",mode:["create"],deps:["connect_now"],visible:function(e){return e.get("connect_now")&&e.isNew()}},{id:"save_password",controlLabel:e("Save password?"),type:"checkbox",group:e("Connection"),mode:["create"],deps:["connect_now"],visible:function(e){return e.get("connect_now")&&e.isNew()},disabled:function(){return!s.allow_save_password}},{id:"role",label:e("Role"),type:"text",group:e("Connection"),mode:["properties","edit","create"],readonly:"isConnected"},{id:"service",label:e("Service"),type:"text",mode:["properties","edit","create"],readonly:"isConnected",group:e("Connection")},{id:"sslmode",label:e("SSL mode"),type:"options",group:e("SSL"),mode:["properties","edit","create"],disabled:"isConnected",options:[{label:e("Allow"),value:"allow"},{label:e("Prefer"),value:"prefer"},{label:e("Require"),value:"require"},{label:e("Disable"),value:"disable"},{label:e("Verify-CA"),value:"verify-ca"},{label:e("Verify-Full"),value:"verify-full"}]},{id:"sslcert",label:e("Client certificate"),type:"text",group:e("SSL"),mode:["edit","create"],disabled:"isSSL",readonly:"isConnected",control:c.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslkey",label:e("Client certificate key"),type:"text",group:e("SSL"),mode:["edit","create"],disabled:"isSSL",readonly:"isConnected",control:c.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslrootcert",label:e("Root certificate"),type:"text",group:e("SSL"),mode:["edit","create"],disabled:"isSSL",readonly:"isConnected",control:c.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslcrl",label:e("Certificate revocation list"),type:"text",group:e("SSL"),mode:["edit","create"],disabled:"isSSL",readonly:"isConnected",control:c.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["sslmode"]},{id:"sslcompression",label:e("SSL compression?"),type:"switch",mode:["edit","create"],group:e("SSL"),options:{size:"mini"},deps:["sslmode"],disabled:"isSSL",readonly:"isConnected"},{id:"sslcert",label:e("Client certificate"),type:"text",group:e("SSL"),mode:["properties"],deps:["sslmode"],visible:function(e){var t=e.get("sslcert");return!n.isUndefined(t)&&!n.isNull(t)}},{id:"sslkey",label:e("Client certificate key"),type:"text",group:e("SSL"),mode:["properties"],deps:["sslmode"],visible:function(e){var t=e.get("sslkey");return!n.isUndefined(t)&&!n.isNull(t)}},{id:"sslrootcert",label:e("Root certificate"),type:"text",group:e("SSL"),mode:["properties"],deps:["sslmode"],visible:function(e){var t=e.get("sslrootcert");return!n.isUndefined(t)&&!n.isNull(t)}},{id:"sslcrl",label:e("Certificate revocation list"),type:"text",group:e("SSL"),mode:["properties"],deps:["sslmode"],visible:function(e){var t=e.get("sslcrl");return!n.isUndefined(t)&&!n.isNull(t)}},{id:"sslcompression",label:e("SSL compression?"),type:"switch",mode:["properties"],group:e("SSL"),options:{size:"mini"},deps:["sslmode"],visible:function(e){var t=e.get("sslmode");return-1!=n.indexOf(u,t)}},{id:"use_ssh_tunnel",label:e("Use SSH tunneling"),type:"switch",mode:["properties","edit","create"],group:e("SSH Tunnel"),options:{size:"mini"},disabled:function(e){return!l.Browser.utils.support_ssh_tunnel&&(setTimeout((function(){e.set("use_ssh_tunnel",0)}),10),!0)},readonly:"isConnected"},{id:"tunnel_host",label:e("Tunnel host"),type:"text",group:e("SSH Tunnel"),mode:["properties","edit","create"],deps:["use_ssh_tunnel"],disabled:function(e){return!e.get("use_ssh_tunnel")},readonly:"isConnected"},{id:"tunnel_port",label:e("Tunnel port"),type:"int",group:e("SSH Tunnel"),mode:["properties","edit","create"],deps:["use_ssh_tunnel"],max:65535,disabled:function(e){return!e.get("use_ssh_tunnel")},readonly:"isConnected"},{id:"tunnel_username",label:e("Username"),type:"text",group:e("SSH Tunnel"),mode:["properties","edit","create"],deps:["use_ssh_tunnel"],disabled:function(e){return!e.get("use_ssh_tunnel")},readonly:"isConnected"},{id:"tunnel_authentication",label:e("Authentication"),type:"switch",mode:["properties","edit","create"],group:e("SSH Tunnel"),options:{onText:e("Identity file"),offText:e("Password"),size:"mini",width:"90"},deps:["use_ssh_tunnel"],disabled:function(e){return!e.get("use_ssh_tunnel")},readonly:"isConnected"},{id:"tunnel_identity_file",label:e("Identity file"),type:"text",group:e("SSH Tunnel"),mode:["properties","edit","create"],control:c.FileControl,dialog_type:"select_file",supp_types:["*"],deps:["tunnel_authentication","use_ssh_tunnel"],disabled:function(e){var t=e.get("tunnel_identity_file");return!e.get("tunnel_authentication")&&t&&setTimeout((function(){e.set("tunnel_identity_file",null)}),10),!e.get("tunnel_authentication")||!e.get("use_ssh_tunnel")}},{id:"tunnel_password",label:e("Password"),type:"password",group:e("SSH Tunnel"),control:"input",mode:["create"],deps:["use_ssh_tunnel"],disabled:function(e){return!e.get("use_ssh_tunnel")},readonly:"isConnected"},{id:"save_tunnel_password",controlLabel:e("Save password?"),type:"checkbox",group:e("SSH Tunnel"),mode:["create"],deps:["connect_now","use_ssh_tunnel"],visible:function(e){return e.get("connect_now")&&e.isNew()},disabled:function(e){return!s.allow_save_tunnel_password||!e.get("use_ssh_tunnel")}},{id:"hostaddr",label:e("Host address"),type:"text",group:e("Advanced"),mode:["properties","edit","create"],readonly:"isConnected"},{id:"db_res",label:e("DB restriction"),type:"select2",group:e("Advanced"),mode:["properties","edit","create"],readonly:"isConnected",select2:{multiple:!0,allowClear:!1,tags:!0,tokenSeparators:[","],first_empty:!1,selectOnClose:!0,emptyOptions:!0}},{id:"passfile",label:e("Password file"),type:"text",group:e("Advanced"),mode:["edit","create"],disabled:"isValidLib",readonly:"isConnected",control:c.FileControl,dialog_type:"select_file",supp_types:["*"]},{id:"passfile",label:e("Password file"),type:"text",group:e("Advanced"),mode:["properties"],visible:function(e){var t=e.get("passfile");return!n.isUndefined(t)&&!n.isNull(t)}},{id:"connect_timeout",label:e("Connection timeout (seconds)"),type:"int",group:e("Advanced"),mode:["properties","edit","create"],readonly:"isConnected",min:0}],validate:function(){return new p.ModelValidation(this).validate()},isConnected:function(e){return e.get("connected")},isfgColorSet:function(e){var t=e.get("bgcolor"),i=e.get("fgcolor");return!!e.get("connected")||((n.isUndefined(t)||n.isNull(t)||!t)&&i&&e.set("bgcolor","#ffffff"),!1)},isSSL:function(e){var t=e.get("sslmode");return-1==n.indexOf(u,t)},isValidLib:function(){return a.utils.pg_libpq_version<1e5}}),connection_lost:function(t,i){if(a.tree){for(var o=a.tree,l=t&&o.itemData(t),r=this;l&&"server"!=l._type;)t=o.parent(t),l=t&&o.itemData(t);if(t&&l&&"server"==l._type&&(n.isUndefined(l.is_connecting)||!l.is_connecting)){l.is_connecting=!0;a.Events.on("pgadmin:server:connect:cancelled",(function e(n){l._id==n&&(l.is_connecting=!1,a.Events.off("pgadmin:server:connect:cancelled",e),a.Events.trigger("pgadmin:database:connect:cancelled",n,i.data.database||l.db),a.Events.trigger("pgadmin:server:disconnect",{item:t,data:l},!1))})),d.confirm(e("Connection lost"),e("Would you like to reconnect to the database?"),(function(){m(r,l,o,t,!0)}),(function(){l.is_connecting=!1,o.unload(t),o.setInode(t),o.addIcon(t,{icon:"icon-database-not-connected"}),a.Events.trigger("pgadmin:server:connect:cancelled",t,l,r),o.select(t)}))}}}});var m=function t(o,l,r,s,c){var p=c||l.connected,u=function(i,n,o,a,s,c,p,u){l.connected=!1,u||(r.setInode(p),r.addIcon(p,{icon:"icon-server-not-connected"})),d.pgNotifier("error",i,o,(function(i){setTimeout((function(){"CRYPTKEY_SET"==i?t(a,s,c,p,u):d.dlgServerPass(e("Connect to Server"),i,a,s,c,p,u).resizeTo()}),100)}))},m=function(e,t,i,l,r,s){e&&e.data&&("string"==typeof e.data.icon&&(l.removeIcon(r),i.icon=e.data.icon,l.addIcon(r,{icon:i.icon})),n.extend(i,e.data),i.is_connecting=!1,(a.serverInfo=a.serverInfo||{})[i._id]=n.extend({},i),d.success(e.info),o.trigger("connected",o,r,i),a.Events.trigger("pgadmin:server:connected",i._id,r,i),a.Events.trigger("pgadmin:database:connected",i._id,i.db,r,i),s?setTimeout((function(){t.callbacks.refresh.apply(t,[!0])}),10):(l.setInode(r),l.deselect(r),setTimeout((function(){l.select(r),l.open(r)}),10)))};d.dlgServerPass||d.dialog("dlgServerPass",(function(){return{main:function(e,t,i,n,o,l,a,r,s,d){this.set("title",e),this.message=t,this.tree=o,this.nodeData=n,this.nodeItem=l,this.node=i,this.connected=a,this.onSuccess=r||m,this.onFailure=s||u,this.onCancel=d||h},setup:function(){return{buttons:[{text:e("Cancel"),className:"btn btn-secondary fa fa-times pg-alertify-button",key:27},{text:e("OK"),key:13,className:"btn btn-primary fa fa-check pg-alertify-button"}],focus:{element:"#password",select:!0},options:{modal:0,resizable:!1,maximizable:!1,pinnable:!1}}},build:function(){},prepare:function(){this.setContent(this.message)},callback:function(t){var n=this.tree,o=this.nodeItem,l=this.node,a=this.nodeData,r=this.connected,s=this.onSuccess,d=this.onFailure,c=this.onCancel;if(t.button.text==e("OK")){var p=l.generate_url(o,"connect",a,!0);r||(n.setLeaf(o),n.removeIcon(o),n.addIcon(o,{icon:"icon-server-connecting"})),i.ajax({type:"POST",timeout:3e4,url:p,data:i("#frmPassword").serialize()}).done((function(e){return s(e,l,a,n,o,r)})).fail((function(e,t,i){return d(e,t,i,l,a,n,o,r)}))}else c&&"function"==typeof c&&c(n,o,a,r)}}}));var h=function(e,t,i,n){i.is_connecting=!1,e.unload(t),e.setInode(t),e.removeIcon(t),e.addIcon(t,{icon:"icon-server-not-connected"}),o.trigger("connect:cancelled",l._id,l.db,o,t,i),a.Events.trigger("pgadmin:server:connect:cancelled",l._id,t,i,o),a.Events.trigger("pgadmin:database:connect:cancelled",l._id,l.db,t,i,o),n&&e.select(t)};if(!l.is_connecting){l.is_connecting=!0,r.setLeaf(s),r.removeIcon(s),r.addIcon(s,{icon:"icon-server-connecting"});var g=o.generate_url(s,"connect",l,!0);i.post(g).done((function(e){if(1==e.success)return m(e,o,l,r,s,p)})).fail((function(e,t,i){return u(e,0,i,o,l,r,s,p)})).always((function(){l.is_connecting=!1}))}},h=function(e,t,o,l){var r=e.generate_url(l,"connect",t,!0);o.setLeaf(l),o.removeIcon(l),o.addIcon(l,{icon:"icon-server-connecting"}),i.get(r).done((function(e){(o.setInode(l),e&&e.data)&&("string"==typeof e.data.icon&&(o.removeIcon(l),t.icon=e.data.icon,o.addIcon(l,{icon:t.icon})),n.extend(t,e.data),(a.serverInfo=a.serverInfo||{})[t._id]=n.extend({},t),t.errmsg&&d.error(t.errmsg))})).fail((function(e,t,i){o.setInode(l),o.addIcon(l,{icon:"icon-server-not-connected"}),d.pgRespErrorNotify(e,i)}))}}return a.Nodes.server}.apply(t,n))||(e.exports=o)},196:function(e,t,i){"use strict";var n,o;i(36),i(11),i(5),i(9),i(37),n=[i(2),i(6),i(0),i(1),i(14),i(3),i(10),i(18),i(64),i(45),i(25),i(67)],void 0===(o=function(e,t,i,n,o,l,a,r,s,d){a.Nodes["coll-function"]||(a.Nodes["coll-function"]=a.Collection.extend({node:"function",label:e("Functions"),type:"coll-function",columns:["name","funcowner","description"],hasStatistics:!0,canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema}));var c=a.Node.Model.extend({idAttribute:"argid",defaults:{argid:void 0,argtype:void 0,argmode:void 0,argname:void 0,argdefval:void 0},schema:[{id:"argid",visible:!1,type:"text",mode:["properties","edit","create"]},{id:"argtype",label:e("Data type"),cell:"node-ajax-options",cellHeaderClasses:"width_percent_30",control:"node-ajax-options",type:"text",url:"get_types",editable:function(e){var t=this.get("node_info");return!(t&&"catalog"in t)&&(!!n.isUndefined(e.isNew)||e.isNew())},first_empty:!0},{id:"argmode",label:e("Mode"),type:"options",control:"node-ajax-options",cellHeaderClasses:"width_percent_20",options:[{label:"IN",value:"IN"},{label:"OUT",value:"OUT"},{label:"INOUT",value:"INOUT"},{label:"VARIADIC",value:"VARIADIC"}],editable:function(e){var t=this.get("node_info");return!(t&&"catalog"in t)&&(!!n.isUndefined(e.isNew)||e.isNew())}},{id:"argname",label:e("Argument name"),type:"text",cell:"string",editable:"isInCatalog",cellHeaderClasses:"width_percent_30"},{id:"argdefval",label:e("Default"),type:"text",cell:"string",editable:"isInCatalog",cellHeaderClasses:"width_percent_20"}],toJSON:o.Model.prototype.toJSON,isInCatalog:function(e){var t=this.get("node_info");return!(t&&"catalog"in t)&&!!(n.isUndefined(e.get("argmode"))||n.isUndefined(this.get("name"))||"argdefval"!=this.get("name")||"INOUT"!=e.get("argmode")&&"OUT"!=e.get("argmode"))},validate:function(){}});return a.Nodes.function||(a.Nodes.function=s.SchemaChildNode.extend({type:"function",sqlAlterHelp:"sql-alterfunction.html",sqlCreateHelp:"sql-createfunction.html",dialogHelp:t("help.static",{filename:"function_dialog.html"}),label:e("Function"),collection_type:"coll-function",hasSQL:!0,hasDepends:!0,width:a.stdW.md+"px",hasStatistics:function(e){return"gpdb"!==e.server.server_type},hasScriptTypes:["create","select"],Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_function_on_coll",node:"coll-function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Function..."),icon:"wcTabIcon icon-function",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_function",node:"function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Function..."),icon:"wcTabIcon icon-function",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_function",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Function..."),icon:"wcTabIcon icon-function",data:{action:"create",check:!1},enable:"canCreate"}]))},model:a.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){var i=0===n.size(e);if(i){var o=t.node_info.schema._id;this.set({pronamespace:o},{silent:!0});var l=a.serverInfo[t.node_info.server._id].user;this.set({funcowner:l.name},{silent:!0})}a.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:void 0,oid:void 0,xmin:void 0,funcowner:void 0,pronamespace:void 0,description:void 0,pronargs:void 0,proargs:void 0,proargtypenames:void 0,prorettypename:void 0,lanname:"sql",provolatile:void 0,proretset:void 0,proisstrict:void 0,prosecdef:void 0,proiswindow:void 0,proparallel:void 0,procost:void 0,prorows:void 0,proleakproof:void 0,prosupportfunc:void 0,arguments:[],prosrc:void 0,prosrc_c:void 0,probin:"$libdir/",options:[],variables:[],proacl:void 0,seclabels:[],acl:[],sysfunc:void 0,sysproc:void 0},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"isDisabled"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"funcowner",label:e("Owner"),cell:"string",control:r.NodeListByNameControl,node:"role",type:"text",disabled:"isDisabled"},{id:"pronamespace",label:e("Schema"),cell:"string",control:"node-list-by-id",type:"text",cache_level:"database",node:"schema",disabled:"isDisabled",mode:["create","edit"]},{id:"sysfunc",label:e("System function?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"sysproc",label:e("System procedure?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",disabled:"isDisabled"},{id:"pronargs",label:e("Argument count"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"proargs",label:e("Arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"proargtypenames",label:e("Signature arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"prorettypename",label:e("Return type"),cell:"string",control:"node-ajax-options",type:"text",group:e("Definition"),url:"get_types",readonly:"isReadonly",first_empty:!0,mode:["create"],visible:"isVisible"},{id:"prorettypename",label:e("Return type"),cell:"string",type:"text",group:e("Definition"),mode:["properties","edit"],readonly:"isReadonly",visible:"isVisible"},{id:"lanname",label:e("Language"),cell:"string",control:"node-ajax-options",type:"text",group:e("Definition"),url:"get_languages",disabled:"isDisabled"},{id:"prosrc",label:e("Code"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Code"),deps:["lanname"],tabPanelCodeClass:"sql-code-control",control:r.SqlCodeControl,extraClasses:["custom_height_css_class"],visible:function(e){return"c"!=e.get("lanname")},disabled:"isDisabled"},{id:"probin",label:e("Object file"),cell:"string",type:"text",group:e("Definition"),deps:["lanname"],visible:function(e){return"c"==e.get("lanname")},disabled:"isDisabled"},{id:"prosrc_c",label:e("Link symbol"),cell:"string",type:"text",group:e("Definition"),deps:["lanname"],visible:function(e){return"c"==e.get("lanname")},disabled:"isDisabled"},{id:"provolatile",label:e("Volatility"),cell:"string",control:"node-ajax-options",type:"text",group:e("Options"),deps:["lanname"],options:[{label:"VOLATILE",value:"v"},{label:"STABLE",value:"s"},{label:"IMMUTABLE",value:"i"}],disabled:"isDisabled",select2:{allowClear:!1}},{id:"proretset",label:e("Returns a set?"),type:"switch",disabled:"isDisabled",group:e("Options"),visible:"isVisible"},{id:"proisstrict",label:e("Strict?"),type:"switch",group:e("Options"),disabled:"isDisabled",deps:["lanname"]},{id:"prosecdef",label:e("Security of definer?"),group:e("Options"),type:"switch",disabled:"isDisabled"},{id:"proiswindow",label:e("Window?"),group:e("Options"),cell:"boolean",type:"switch",disabled:"isDisabled",visible:"isVisible"},{id:"proparallel",label:e("Parallel"),cell:"string",control:"node-ajax-options",type:"text",group:e("Options"),deps:["lanname"],options:[{label:"UNSAFE",value:"u"},{label:"RESTRICTED",value:"r"},{label:"SAFE",value:"s"}],disabled:"isDisabled",min_version:90600,select2:{allowClear:!1}},{id:"procost",label:e("Estimated cost"),group:e("Options"),cell:"string",type:"text",readonly:"isReadonly",deps:["lanname"]},{id:"prorows",label:e("Estimated rows"),type:"text",deps:["proretset"],visible:"isVisible",readonly:"isReadonly",group:e("Options")},{id:"proleakproof",label:e("Leak proof?"),group:e("Options"),cell:"boolean",type:"switch",min_version:90200,disabled:"isDisabled",deps:["lanname"]},{id:"prosupportfunc",label:e("Support function"),type:"text",disabled:"isDisabled",group:e("Options"),visible:"isVisible",control:"node-ajax-options",url:"get_support_functions",cache_node:"function",min_version:12e4},{id:"proacl",label:e("Privileges"),type:"text",mode:["properties"],group:e("Security")},{id:"arguments",label:e("Arguments"),cell:"string",group:e("Definition"),type:"collection",canAdd:function(e){return e.isNew()},canDelete:!0,model:c,mode:["create","edit"],columns:["argtype","argmode","argname","argdefval"],disabled:"isDisabled",canDeleteRow:function(e){return e.isNew()}},{id:"variables",label:"",type:"collection",group:e("Parameters"),control:"variable-collection",model:a.Node.VariableModel,mode:["edit","create"],canAdd:"canVarAdd",canEdit:!1,canDelete:!0,disabled:"isDisabled"},a.SecurityGroupSchema,{id:"acl",label:e("Privileges"),editable:!1,model:a.Node.PrivilegeRoleModel.extend({privileges:["X"]}),uniqueCol:["grantee","grantor"],type:"collection",group:"security",mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection",disabled:"isDisabled"},{id:"seclabels",label:e("Security labels"),canAdd:!0,model:a.SecLabelModel,type:"collection",min_version:90100,group:"security",mode:["edit","create"],canEdit:!1,canDelete:!0,uniqueCol:["provider"],disabled:"isDisabled",control:"unique-col-collection",visible:function(){return this.node&&"procedure"!=this.node.type}}],validate:function(){var t,i={},o=this.get("seclabels");if((n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(i.name=e("Name cannot be empty."),t=t||i.name),(n.isUndefined(this.get("funcowner"))||""==String(this.get("funcowner")).replace(/^\s+|\s+$/g,""))&&(i.funcowner=e("Owner cannot be empty."),t=t||i.funcowner),(n.isUndefined(this.get("pronamespace"))||""==String(this.get("pronamespace")).replace(/^\s+|\s+$/g,""))&&(i.pronamespace=e("Schema cannot be empty."),t=t||i.pronamespace),(n.isUndefined(this.get("prorettypename"))||""==String(this.get("prorettypename")).replace(/^\s+|\s+$/g,""))&&(i.prorettypename=e("Return type cannot be empty."),t=t||i.prorettypename),(n.isUndefined(this.get("lanname"))||""==String(this.get("lanname")).replace(/^\s+|\s+$/g,""))&&(i.lanname=e("Language cannot be empty."),t=t||i.lanname),"c"==String(this.get("lanname"))?((n.isUndefined(this.get("probin"))||""==String(this.get("probin")).replace(/^\s+|\s+$/g,""))&&(i.probin=e("Object File cannot be empty."),t=t||i.probin),(n.isUndefined(this.get("prosrc_c"))||""==String(this.get("prosrc_c")).replace(/^\s+|\s+$/g,""))&&(i.prosrc_c=e("Link Symbol cannot be empty."),t=t||i.prosrc_c)):(n.isUndefined(this.get("prosrc"))||""==String(this.get("prosrc")).replace(/^\s+|\s+$/g,""))&&(i.prosrc=e("Code cannot be empty."),t=t||i.prosrc),o)for(var l,a=0;a<o.models.length&&!l;a++)(l=o.models[a].validate.apply(o.models[a]))&&(i.seclabels=l,t=t||l);return this.errorModel.clear().set(i),n.size(i)?(this.trigger("on-status",{msg:t}),t):null},isVisible:function(){return"sysproc"!=this.name},isDisabled:function(){if(this.node_info&&"catalog"in this.node_info)return!0;switch(this.name){case"prosupportfunc":var e=l.Browser.tree.selected();return!l.Browser.Nodes.function.getTreeNodeHierarchy(e).server.user.is_superuser;default:return!1}},isReadonly:function(e){switch(this.name){case"proargs":case"proargtypenames":case"proretset":case"proiswindow":case"prorettypename":return!e.isNew();case"prorows":return 1!=e.get("proretset");default:return!1}},canVarAdd:function(){return!(this.node_info&&"catalog"in this.node_info)}})})),a.Nodes.function}.apply(t,n))||(e.exports=o)},197:function(e,t,i){"use strict";var n,o;i(11),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(25),i(67)],void 0===(o=function(e,t,i,n,o,l,a){return l.Nodes["coll-edbfunc"]||(l.Nodes["coll-edbfunc"]=l.Collection.extend({node:"edbfunc",label:e("Functions"),type:"coll-edbfunc",columns:["name","funcowner","description"],canDrop:!1,canDropCascade:!1})),l.Nodes.edbfunc||(l.Nodes.edbfunc=l.Node.extend({type:"edbfunc",dialogHelp:t("help.static",{filename:"edbfunc_dialog.html"}),label:e("Function"),collection_type:"coll-edbfunc",hasDepends:!0,canEdit:!1,hasSQL:!0,hasScriptTypes:[],parent_type:["package"],Init:function(){this.initialized||(this.initialized=!0)},canDrop:!1,canDropCascade:!1,model:l.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,funcowner:void 0,pronargs:void 0,proargs:void 0,proargtypenames:void 0,prorettypename:void 0,lanname:"sql",prosrc:void 0,proacl:void 0,visibility:"Unknown"},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties"]},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"funcowner",label:e("Owner"),cell:"string",type:"text",readonly:!0},{id:"pronargs",label:e("Argument count"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"proargs",label:e("Arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"proargtypenames",label:e("Signature arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"prorettypename",label:e("Return type"),cell:"string",type:"text",group:e("Definition"),mode:["properties"],visible:"isVisible"},{id:"visibility",label:e("Visibility"),cell:"string",type:"text",mode:["properties"]},{id:"lanname",label:e("Language"),cell:"string",type:"text",group:e("Definition"),readonly:!0},{id:"prosrc",label:e("Code"),cell:"string",type:"text",mode:["properties"],group:e("Code"),tabPanelCodeClass:"sql-code-control",control:a.SqlCodeControl,visible:function(e){return"c"!=e.get("lanname")},disabled:!0}],validate:function(){return null},isVisible:function(){return"sysproc"!=this.name}})})),l.Nodes.edbfunc}.apply(t,n))||(e.exports=o)},198:function(e,t,i){"use strict";var n,o;i(16),i(5),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(45)],void 0===(o=function(e,t,i,n,o,l,a,r){return l.Nodes["coll-rule"]||(o.Browser.Nodes["coll-rule"]=o.Browser.Collection.extend({node:"rule",label:e("Rules"),type:"coll-rule",columns:["name","owner","comment"],canDrop:r.isTreeItemOfChildOfSchema,canDropCascade:r.isTreeItemOfChildOfSchema})),l.Nodes.rule||(o.Browser.Nodes.rule=l.Node.extend({parent_type:["table","view","partition"],type:"rule",sqlAlterHelp:"sql-alterrule.html",sqlCreateHelp:"sql-createrule.html",dialogHelp:t("help.static",{filename:"rule_dialog.html"}),label:e("rule"),collection_type:"coll-table",hasSQL:!0,hasDepends:!0,canDrop:function(e,t){return r.isTreeItemOfChildOfSchema.apply(this,[e,t]),!n.has(e,"label")||"_RETURN"!==e.label},canDropCascade:function(e,t){return r.isTreeItemOfChildOfSchema.apply(this,[e,t]),!n.has(e,"label")||"_RETURN"!==e.label},url_jump_after_node:"schema",Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_rule_on_coll",node:"coll-rule",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_rule_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_rule",node:"rule",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_rule",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_rule",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Rule..."),icon:"wcTabIcon icon-rule",data:{action:"create",check:!0},enable:"canCreate"}]))},model:o.Browser.Node.Model.extend({idAttribute:"oid",schema:[{id:"name",label:e("Name"),type:"text",disabled:function(e){return!(!e||"_RETURN"!=e.get("name"))||!e.isNew()&&!(e.node_info.server.version>=90400)}},{id:"oid",label:e("OID"),type:"text",mode:["properties"]},{id:"schema",label:"",type:"text",visible:!1,disabled:function(e){e.set("schema",e.node_info.schema.label)}},{id:"view",label:"",type:"text",visible:!1,disabled:function(e){e.set("view",this.node_data.label)}},{id:"event",label:e("Event"),control:"select2",group:e("Definition"),type:"text",select2:{width:"100%",allowClear:!1},options:[{label:"SELECT",value:"SELECT"},{label:"INSERT",value:"INSERT"},{label:"UPDATE",value:"UPDATE"},{label:"DELETE",value:"DELETE"}]},{id:"do_instead",label:e("Do instead?"),group:e("Definition"),type:"switch"},{id:"condition",label:e("Condition"),type:"text",group:e("Condition"),tabPanelCodeClass:"sql-code-control",control:a.SqlCodeControl},{id:"statements",label:e("Commands"),type:"text",group:e("Commands"),tabPanelCodeClass:"sql-code-control",control:a.SqlCodeControl},{id:"system_rule",label:e("System rule?"),type:"switch",mode:["properties"]},{id:"enabled",label:e("Enabled?"),type:"switch",mode:["properties"]},{id:"comment",label:e("Comment"),cell:"string",type:"multiline"}],validate:function(){var t,i={},o=this.get("name");return n.isUndefined(o)||n.isNull(o)||""===String(o).replace(/^\s+|\s+$/g,"")?(i.name=e("Please specify name."),t=t||i.name,this.errorModel.set("name",t),t):(this.errorModel.unset("name"),null)}}),canCreate:function(e,t,i){if(i&&!1===i.check)return!0;for(var o=l.tree,a=t,r=e;a;){if(n.indexOf(["schema"],r._type)>-1)return!0;if("coll-rule"==r._type){var s=o.hasParent(a)?o.parent(a):null,d=o.hasParent(s)?o.parent(s):null,c=(d&&o.itemData(d),o.hasParent(d)?o.parent(d):null);return"catalog"!=(c?o.itemData(c):null)._type}if("view"==r._type||"table"==r._type)return s=o.hasParent(a)?o.parent(a):null,"schema"==((d=o.hasParent(s)?o.parent(s):null)?o.itemData(d):null)._type;r=(a=o.hasParent(a)?o.parent(a):null)?o.itemData(a):null}return!0}})),l.Nodes["coll-rule"]}.apply(t,n))||(e.exports=o)},239:function(e,t,i){"use strict";var n,o;i(5),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(81)],void 0===(o=function(e,t,i,n,o){return o.Browser.Nodes.server_group||(o.Browser.Nodes.server_group=o.Browser.Node.extend({parent_type:null,type:"server_group",dialogHelp:t("help.static",{filename:"server_group_dialog.html"}),label:e("Server Group"),width:"250px",height:"150px",is_collection:!0,Init:function(){this.initialized||(this.initialized=!0,o.Browser.add_menus([{name:"create_server_group",node:"server_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("Server Group..."),data:{action:"create"},icon:"wcTabIcon icon-server_group"}]))},model:o.Browser.Node.Model.extend({defaults:{id:void 0,name:null},schema:[{id:"id",label:e("ID"),type:"int",group:null,mode:["properties"]},{id:"name",label:e("Name"),type:"text",group:null,mode:["properties","edit","create"]}],validate:function(){var t=null;return this.errorModel.clear(),!this.isNew()&&"id"in this.changed?(t=e("The ID cannot be changed."),this.errorModel.set("id",t),t):n.isUndefined(this.get("name"))||n.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Name cannot be empty."),this.errorModel.set("name",t),t):null}}),canDrop:function(e){return e.can_delete},dropAsRemove:!0,canDelete:function(e){var t=o.Browser.tree.siblings(e,!0);return!(!t||0==t.length)}})),o.Browser.Nodes.server_group}.apply(t,n))||(e.exports=o)},240:function(e,t,i){"use strict";var n,o;i(28),i(11),i(5),i(9),i(7),n=[i(2),i(6),i(0),i(1),i(22),i(3),i(121),i(13),i(18),i(25),i(67),i(351)],void 0===(o=function(e,t,i,n,o,l,a,r,s){if(a.Nodes["coll-database"]||(a.Nodes["coll-database"]=a.Collection.extend({node:"database",label:e("Databases"),type:"coll-database",columns:["name","datowner","comments"],hasStatistics:!0,canDrop:!0,canDropCascade:!1,statsPrettifyFields:[e("Size"),e("Size of temporary files")]})),!a.Nodes.database){a.Nodes.database=a.Node.extend({parent_type:"server",type:"database",sqlAlterHelp:"sql-alterdatabase.html",sqlCreateHelp:"sql-createdatabase.html",dialogHelp:t("help.static",{filename:"database_dialog.html"}),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[e("Size"),e("Size of temporary files")],canDrop:function(e){return e.canDrop},label:e("Database"),node_image:function(){return"pg-icon-database"},Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_database_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Database..."),icon:"wcTabIcon pg-icon-database",data:{action:"create"},enable:"can_create_database"},{name:"create_database_on_coll",node:"coll-database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Database..."),icon:"wcTabIcon pg-icon-database",data:{action:"create"},enable:"can_create_database"},{name:"create_database",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Database..."),icon:"wcTabIcon pg-icon-database",data:{action:"create"},enable:"can_create_database"},{name:"connect_database",node:"database",module:this,applies:["object","context"],callback:"connect_database",category:"connect",priority:4,label:e("Connect Database..."),icon:"fa fa-link",enable:"is_not_connected"},{name:"disconnect_database",node:"database",module:this,applies:["object","context"],callback:"disconnect_database",category:"drop",priority:5,label:e("Disconnect Database..."),icon:"fa fa-chain-broken",enable:"is_connected"}]),n.bindAll(this,"connection_lost"),a.Events.on("pgadmin:database:connection:lost",this.connection_lost))},can_create_database:function(e,t){var i=this.getTreeNodeHierarchy(t).server;return i.connected&&i.user.can_create_db},is_not_connected:function(e){return e&&1!=e.connected&&1==e.allowConn},is_connected:function(e){return e&&1==e.connected&&1==e.canDisconn},is_conn_allow:function(e){return e&&1==e.allowConn},connection_lost:function(t,i,o){if(a.tree){for(var l=a.tree,s=t&&l.itemData(t),d=this;s&&"database"!=s._type;)t=l.parent(t),s=t&&l.itemData(t);if(t&&s){if(!s.allowConn)return!1;if(n.isUndefined(s.is_connecting)||!s.is_connecting){s.is_connecting=!0;if(a.Events.on("pgadmin:database:connect:cancelled",(function e(t,i){i._id==this._id&&(s.is_connecting=!1,a.Events.off("pgadmin:database:connect:cancelled",e),i=(t=t&&l.parent(t))&&l.itemData(t),t&&i&&a.Events.trigger("pgadmin:server:disconnect",{item:t,data:i},!1))})),o)return void c(d,s,l,t,!0);r.confirm(e("Connection lost"),e("Would you like to reconnect to the database?"),(function(){c(d,s,l,t,!0)}),(function(){s.is_connecting=!1,l.unload(t),l.setInode(t),l.addIcon(t,{icon:"icon-database-not-connected"}),a.Events.trigger("pgadmin:database:connect:cancelled",t,s,d)}))}}}},callbacks:{connect_database:function(e){var t=e||{},i=a.tree,n=t.item||i.selected(),o=n&&1==n.length?i.itemData(n):void 0;return!(!o||"template0"==o.label)&&(d(this,o,i,n,!0),!1)},disconnect_database:function(t){var l=t||{},s=this,d=a.tree,c=l.item||d.selected(),p=c&&1==c.length?d.itemData(c):void 0;return!!p&&(r.confirm(e("Disconnect the database"),o.sprintf(e("Are you sure you want to disconnect the database - %s?"),p.label),(function(){var e=p;i.ajax({url:s.generate_url(c,"connect",p,!0),type:"DELETE"}).done((function(t){if(1==t.success){var i=d.parent(c);t.data.info_prefix&&(t.info="".concat(n.escape(t.data.info_prefix)," - ").concat(t.info)),r.success(t.info),d.removeIcon(c),e.connected=!1,e.icon="icon-database-not-connected",d.addIcon(c,{icon:e.icon}),d.unload(c),d.setInode(c),setTimeout((function(){d.select(i)}),10)}else{try{r.error(t.errormsg)}catch(e){console.warn(e.stack||e)}d.unload(c)}})).fail((function(e,t,i){r.pgRespErrorNotify(e,i),d.unload(c)}))}),(function(){return!0})),!1)},beforeopen:function(e,t){return!(!t||"database"!=t._type||"template0"==t.label)&&(a.tree.addIcon(e,{icon:t.icon}),!(!t.connected&&t.allowConn)||(d(this,t,a.tree,e,!0),!1))},selected:function(e,t){return!(!t||"database"!=t._type)&&(a.tree.addIcon(e,{icon:t.icon}),!t.connected&&t.allowConn?(d(this,t,a.tree,e,!1),!1):a.Node.callbacks.selected.apply(this,arguments))},refresh:function(e,t){var i=a.tree,n=t||i.selected(),o=i.itemData(n);o.allowConn&&a.Node.callbacks.refresh.apply(this,arguments)}},model:a.Node.Model.extend({idAttribute:"did",defaults:{name:void 0,owner:void 0,comment:void 0,encoding:"UTF8",template:void 0,tablespace:void 0,collation:void 0,char_type:void 0,datconnlimit:-1,datallowconn:void 0,variables:[],privileges:[],securities:[],datacl:[],deftblacl:[],deffuncacl:[],defseqacl:[],is_template:!1,deftypeacl:[]},initialize:function(e,t){var i=0===n.size(e);if(i){var o=a.serverInfo[t.node_info.server._id].user;this.set({datowner:o.name},{silent:!0})}a.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Database"),cell:"string",editable:!1,type:"text"},{id:"did",label:e("OID"),cell:"string",mode:["properties"],editable:!1,type:"text"},{id:"datowner",label:e("Owner"),editable:!1,type:"text",node:"role",control:s.NodeListByNameControl,select2:{allowClear:!1}},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"]},{id:"tblacl",label:e("Default TABLE privileges"),type:"text",group:e("Security"),mode:["properties"]},{id:"seqacl",label:e("Default SEQUENCE privileges"),type:"text",group:e("Security"),mode:["properties"]},{id:"funcacl",label:e("Default FUNCTION privileges"),type:"text",group:e("Security"),mode:["properties"]},{id:"typeacl",label:e("Default TYPE privileges"),type:"text",group:e("Security"),mode:["properties"],min_version:90200},{id:"comments",label:e("Comment"),editable:!1,type:"multiline"},{id:"encoding",label:e("Encoding"),editable:!1,type:"text",group:e("Definition"),readonly:function(e){return!e.isNew()},url:"get_encodings",control:"node-ajax-options",cache_level:"server"},{id:"template",label:e("Template"),editable:!1,type:"text",group:e("Definition"),readonly:function(e){return!e.isNew()},control:"node-list-by-name",url:"get_databases",cache_level:"server",select2:{allowClear:!1},mode:["create"],transform:function(e,t){var i=[],o=t||this,l=o.model.get("name");return o.model.isNew()?e&&n.isArray(e)&&n.each(e,(function(e){i.push({label:e,value:e,image:"pg-icon-database"})})):i.push({label:l,value:l}),i}},{id:"spcname",label:e("Tablespace"),editable:!1,type:"text",group:e("Definition"),control:"node-list-by-name",node:"tablespace",select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label}},{id:"datcollate",label:e("Collation"),editable:!1,type:"text",group:e("Definition"),readonly:function(e){return!e.isNew()},url:"get_ctypes",control:"node-ajax-options",cache_level:"server"},{id:"datctype",label:e("Character type"),editable:!1,type:"text",group:e("Definition"),readonly:function(e){return!e.isNew()},url:"get_ctypes",control:"node-ajax-options",cache_level:"server"},{id:"datconnlimit",label:e("Connection limit"),editable:!1,type:"int",group:e("Definition"),min:-1},{id:"is_template",label:e("Template?"),editable:!1,type:"switch",group:e("Definition"),readonly:!0,mode:["properties","edit"]},{id:"datallowconn",label:e("Allow connections?"),editable:!1,type:"switch",group:e("Definition"),mode:["properties"]},{id:"datacl",label:e("Privileges"),type:"collection",model:a.Node.PrivilegeRoleModel.extend({privileges:["C","T","c"]}),uniqueCol:["grantee","grantor"],editable:!1,group:e("Security"),mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection"},{id:"variables",label:"",type:"collection",model:a.Node.VariableModel.extend({keys:["name","role"]}),editable:!1,group:e("Parameters"),mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:!0,hasRole:!0,control:s.VariableCollectionControl,node:"role"},{id:"seclabels",label:e("Security labels"),model:a.SecLabelModel,editable:!1,type:"collection",canEdit:!1,group:e("Security"),canDelete:!0,mode:["edit","create"],canAdd:!0,control:"unique-col-collection",uniqueCol:["provider"],min_version:90200},{type:"nested",control:"tab",group:e("Default Privileges"),mode:["edit"],schema:[{id:"deftblacl",model:a.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),label:"",editable:!1,type:"collection",group:e("Tables"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"defseqacl",model:a.Node.PrivilegeRoleModel.extend({privileges:["r","w","U"]}),label:"",editable:!1,type:"collection",group:e("Sequences"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"deffuncacl",model:a.Node.PrivilegeRoleModel.extend({privileges:["X"]}),label:"",editable:!1,type:"collection",group:e("Functions"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"deftypeacl",model:a.Node.PrivilegeRoleModel.extend({privileges:["U"]}),label:"",editable:!1,type:"collection",group:"deftypesacl_group",mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"],min_version:90200},{id:"deftypesacl_group",type:"group",label:e("Types"),mode:["edit","create"],min_version:90200}]}],validate:function(){var t=this.get("name");if(n.isUndefined(t)||n.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")){var i=e("Name cannot be empty.");return this.errorModel.set("name",i),i}return this.errorModel.unset("name"),null}})}),a.SecurityGroupSchema={id:"security",label:e("Security"),type:"group",visible:function(e){return!(e&&"node_info"in e)||!("catalog"in(e.node_info||e.handler.node_info))}};var d=function(e,t,i,n){c(e,t,i,n)},c=function(t,o,l,s,c){var p=c||o.connected,u=function(e,i,o,l,s,d){o.is_connecting=!1,d||(l.deselect(s),l.setInode(s)),e&&e.data&&("boolean"==typeof e.data.connected&&(o.connected=e.data.connected),"string"==typeof e.data.icon&&(l.removeIcon(s),o.icon=e.data.icon,l.addIcon(s,{icon:o.icon})),e.data.info_prefix&&(e.info="".concat(n.escape(e.data.info_prefix)," - ").concat(e.info)),r.success(e.info),t.trigger("connected",t,s,o),a.Events.trigger("pgadmin:database:connected",s,o),d||setTimeout((function(){l.select(s),l.open(s)}),10))},m=function(e,i,n){n.is_connecting=!1;var o=e.parent(i);e.unload(i),e.setInode(i),e.removeIcon(i),e.addIcon(i,{icon:"icon-database-not-connected"}),t.trigger("connect:cancelled",t,i,n),a.Events.trigger("pgadmin:database:connect:cancelled",i,n,t),e.select(o)};i.post(t.generate_url(s,"connect",o,!0)).done((function(e){if(1==e.success)return u(e,t,o,l,s,p)})).fail((function(i,n,a){return function t(i,n,o,a,s,p,h,g){g||(l.setInode(h),l.addIcon(h,{icon:"icon-database-not-connected"})),r.pgNotifier("error",i,o,(function(i){setTimeout((function(){"CRYPTKEY_SET"==i?d(a,s,p,h,c):r.dlgServerPass(e("Connect to database"),i,a,s,p,h,g,u,t,m).resizeTo()}),100)}))}(i,0,a,t,o,l,s,p)}))}}return a.Nodes["coll-database"]}.apply(t,n))||(e.exports=o)},241:function(e,t,i){"use strict";var n,o;i(8),i(16),i(21),i(47),i(36),i(11),i(5),i(9),i(29),i(7),i(37),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(48),i(18),i(104),i(25),i(123),i(351)],void 0===(o=function(e,t,i,n,o,l,a,r){l.Nodes["coll-role"]||(o.Browser.Nodes["coll-role"]=o.Browser.Collection.extend({node:"role",type:"coll-role",columns:["rolname","rolvaliduntil","rolconnlimit","rolcanlogin","rolsuper","rolcreaterole","rolcreatedb","rolcatupdate","rolinherit","rolreplication"],canDrop:!0,canDropCascade:!1}));var s=o.Browser.SecurityModel=o.Browser.SecurityModel||o.Browser.Node.Model.extend({defaults:{provider:null,label:null},schema:[{id:"provider",label:e("Provider"),type:"text",disabled:!1,cellHeaderClasses:"width_percent_50"},{id:"label",label:e("Security label"),type:"text",disabled:!1}],validate:function(){var t,i=this.toJSON();return n.isUndefined(i.provider)||n.isNull(i.provider)||""==String(i.provider).replace(/^\s+|\s+$/g,"")?(t=e("Please specify the value for all the security providers."),this.errorModel.set("provider",t),t):(this.errorModel.unset("provider"),n.isUndefined(i.label)||n.isNull(i.label)||""==String(i.label).replace(/^\s+|\s+$/g,"")?(t=e("Please specify the value for all the security providers."),this.errorModel.set("label",t),t):(this.errorModel.unset("label"),null))}}),d=r.Control.extend({defaults:n.defaults({extraClasses:["col-12 col-sm-12 col-md-12"]},r.NodeListByNameControl.prototype.defaults),initialize:function(){r.NodeListByNameControl.prototype.initialize.apply(this,arguments)},formatter:{fromRaw:function(e){var t=n.isObject(e)?e:JSON.parse(e);return n.pluck(t,"role")},toRaw:function(e){return e}},template:n.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <select title = <%=label%> multiple="multiple" style="width:100%;" class="pgadmin-controls <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-JSON.stringify(value)%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%>>',"    <% for (var i=0; i < options.length; i++) { %>","      <% var option = options[i]; %>",'      <option value=<%-option.value%> data-icon=<%-option.image%> <%=value != null && _.indexOf(value, option.value) != -1 ? "selected" : ""%> <%=option.disabled ? "disabled=\'disabled\'" : ""%>><%-option.label%></option>',"    <% } %>","  </select>","  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),selectionTemplate:n.template(["<span>",'  <span class="wcTabIcon <%= optimage %>"></span>',"  <span><%= opttext %><span>","  <% if (checkbox) { %>",'  <div class="custom-control custom-checkbox custom-checkbox-no-label d-inline">','    <input tabindex="-1" type="checkbox" class="custom-control-input" id="check_<%= opttext %>" />','    <label class="custom-control-label" for="check_<%= opttext %>">','      <span class="sr-only">WITH ADMIN<span>',"    </label>","  </div>","  <% } %>","</span>"].join("\n")),events:{"change select":"onChange"},getValueFromDOM:function(){var e=[];return this.$el.find("select").find(":selected").each((function(){e.push(i(this).attr("value"))})),e},render:function(){var t,o,l,a=n.defaults(this.field.toJSON(),this.defaults),s=this.model.toJSON(),d=a.name.split("."),c=d.shift(),p=d.join("."),u=this.keyPathAccessor(s[c],p),m=n.extend(a,{rawValue:u,value:this.formatter.fromRaw(u,this.model),attributes:s,formatter:this.formatter}),h=function(e,t,i){return n.isFunction(e)?!!e.apply(t,[i]):!!e};if(n.extend(m,{disabled:h(m.disabled,m,this.model),visible:h(m.visible,m,this.model),required:h(m.required,m,this.model),helpMessage:(t=m.helpMessage,o=m,l=this.model,n.isFunction(t)?t.apply(o,[l]):t)}),n.isFunction(m.options))try{m.options=m.options.apply(this)}catch(e){m.options=[],this.model.trigger("pgadmin-view:transform:error",this.model,this.field,e)}this.$el.removeClass(r.hiddenClassName),m.visible||this.$el.addClass(r.hiddenClassName),this.$el.html(this.template(m)).addClass(a.name),this.updateInvalid();var g=this,f=this.model.get(this.field.get("name"));return this.$el.find("select").select2({templateResult:function(e){if(!e.id)return e.text;var t=i(e.element).data("icon");if(t){var o=n.extend({},m,{opttext:n.escape(e.text),optimage:t,checkbox:!1});return i(g.selectionTemplate(o))}return e.text},templateSelection:function(e){if(!e.id)return e.text;var t=i(e.element).data("icon");if(t){var o=n.extend({},m,{opttext:n.escape(e.text),optimage:t,checkbox:!0}),l=i(g.selectionTemplate(o));return setTimeout((function(){n.each(f.where({role:e.id}),(function(e){l.find("input").prop("checked",e.get("admin"))}))}),200),l.find("input").on("change",(function(t){return n.each(f.where({role:e.id}),(function(e){e.set("admin",i(t.target).is(":checked"))})),!1})),l}return e.text},multiple:!0,tags:!0,allowClear:!m.disabled,placeholder:m.disabled?"":e("Select members"),width:"style"}).on("change",(function(e){i(e.target).find(":selected").each((function(){}))})),this},onChange:function(){var e=this.model,t=this.field.get("name").split(".").shift(),i=this.getValueFromDOM(),o=e.get(t),l=[];this.stopListening(this.model,"change:"+t,this.render),o.each((function(e){var t=e.get("role"),o=n.indexOf(i,t);o>-1?i.splice(o,1):l.push(t)})),n.each(i,(function(e){o.add({role:e})})),n.each(l,(function(e){o.remove(o.where({role:e}))})),this.listenTo(this.model,"change:"+t,this.render)}});return l.Nodes.role||(o.Browser.Nodes.role=o.Browser.Node.extend({parent_type:"server",type:"role",sqlAlterHelp:"sql-alterrole.html",sqlCreateHelp:"sql-createrole.html",dialogHelp:t("help.static",{filename:"role_dialog.html"}),label:e("Login/Group Role"),hasSQL:!0,width:"550px",canDrop:function(e,t){var i=this.getTreeNodeHierarchy(t).server;return e.is_superuser?i.connected&&i.user.is_superuser:i.connected&&i.user.can_create_role},hasDepends:!0,node_label:function(e){return e.label},node_image:function(e){return null==e||null==e?"icon-role":e.can_login?"icon-role":"icon-group"},title:function(t){return t?t.can_login?e("Login Role")+" - "+t.label:e("Group Role")+" - "+t.label:this.label},Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_role_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Login/Group Role..."),icon:"wcTabIcon icon-role",data:{action:"create"},enable:"can_create_role"},{name:"create_role_on_roles",node:"coll-role",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Login/Group Role..."),icon:"wcTabIcon icon-role",data:{action:"create"},enable:"can_create_role"},{name:"create_role",node:"role",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Login/Group Role..."),icon:"wcTabIcon icon-role",data:{action:"create"},enable:"can_create_role"}]))},can_create_role:function(e,t){var i=this.getTreeNodeHierarchy(t).server;return i.connected&&i.user.can_create_role},model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{oid:null,rolname:void 0,rolcanlogin:!1,rolpassword:null,rolconnlimit:-1,rolsuper:!1,rolcreaterole:!1,rolcreatedb:!1,rolinherit:!0,rolcatupdate:!1,rolreplication:!1,rolmembership:[],rolvaliduntil:null,seclabels:[],variables:[]},schema:[{id:"rolname",label:e("Name"),type:"text",readonly:"readonly"},{id:"oid",label:e("OID"),cell:"string",mode:["properties"],editable:!1,type:"text",visible:!0},{id:"rolpassword",label:e("Password"),type:"password",group:e("Definition"),mode:["edit","create"],control:"input",deps:["rolcanlogin"],retype:!0,cell:"string",disabled:function(e){if(!e.isNew()){var t=this.node_info.server.user;return!(t.is_superuser||t.can_create_role)&&t.id!=e.get("oid")}return!1}},{id:"rolvaliduntil",readonly:"readonly",type:"text",group:e("Definition"),label:e("Account expires"),mode:["properties","edit","create"],control:"datetimepicker",deps:["rolcanlogin"],options:{format:"YYYY-MM-DD HH:mm:ss Z"}},{id:"rolconnlimit",type:"int",group:e("Definition"),label:e("Connection limit"),cell:"integer",min:-1,mode:["properties","edit","create"],readonly:"readonly"},{id:"rolcanlogin",label:e("Can login?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",group:e("Privileges"),readonly:"readonly"},{id:"rolsuper",label:e("Superuser?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",group:e("Privileges"),control:r.SwitchControl.extend({onChange:function(){r.SwitchControl.prototype.onChange.apply(this,arguments),this.model.set("rolcatupdate",this.model.get("rolsuper")),this.model.set("rolcreaterole",this.model.get("rolsuper")),this.model.set("rolcreatedb",this.model.get("rolsuper"))}}),readonly:"readonly"},{id:"rolcreaterole",label:e("Create roles?"),group:e("Privileges"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",readonly:"readonly"},{id:"description",label:e("Comments"),type:"multiline",group:null,mode:["properties","edit","create"],readonly:"readonly"},{id:"rolcreatedb",label:e("Create databases?"),group:e("Privileges"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",readonly:"readonly"},{id:"rolcatupdate",label:e("Update catalog?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",max_version:90400,group:e("Privileges"),readonly:function(e){return e.get("read_only")},disabled:function(e){return!e.get("rolsuper")}},{id:"rolinherit",group:e("Privileges"),label:e("Inherit rights from the parent roles?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",readonly:"readonly"},{id:"rolreplication",group:e("Privileges"),label:e("Can initiate streaming replication and backups?"),type:"switch",controlLabelClassName:"control-label pg-el-sm-4 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-8 pg-el-12",min_version:90100,readonly:"readonly"},{id:"rolmembership",label:e("Roles"),group:e("Membership"),type:"collection",cell:"string",readonly:"readonly",mode:["properties","edit","create"],control:d,model:l.Node.Model.extend({keys:["role"],idAttribute:"role",defaults:{role:void 0,admin:!1},validate:function(){return null}}),filter:function(e){return this.model.isNew()||this.model.get("rolname")!=e.label},helpMessage:function(t){return t.has("read_only")&&0==t.get("read_only")?e("Select the checkbox for roles to include WITH ADMIN OPTION."):e("Roles shown with a check mark have the WITH ADMIN OPTION set.")}},{id:"variables",label:"",type:"collection",group:e("Parameters"),hasDatabase:!0,url:"variables",model:l.Node.VariableModel.extend({keys:["name","database"]}),control:"variable-collection",mode:["edit","create"],canAdd:!0,canDelete:!0,readonly:"readonly"},{id:"seclabels",label:e("Security labels"),model:s,editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,readonly:"readonly",canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],readonly:function(e){if(!e.has("read_only")){var t=this.node_info.server.user;e.set("read_only",!(t.is_superuser||t.can_create_role))}return e.get("read_only")},validate:function(){var t,i={},o=this.get("seclabels");if((n.isUndefined(this.get("rolname"))||""==String(this.get("rolname")).replace(/^\s+|\s+$/g,""))&&(i.name=e("Name cannot be empty."),t=t||i.name),o)for(var l,a=0;a<o.models.length&&!l;a++)(l=o.models[a].validate.apply(o.models[a]))&&(i.seclabels=l,t=t||l);return this.errorModel.clear().set(i),n.size(i)?(this.trigger("on-status",{msg:t}),t):null}})})),l.Nodes.role}.apply(t,n))||(e.exports=o)},242:function(e,t,i){"use strict";var n,o;i(5),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(13),i(18),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r){return l.Nodes["coll-cast"]||(o.Browser.Nodes["coll-cast"]=o.Browser.Collection.extend({node:"cast",label:e("Casts"),type:"coll-cast",columns:["name","description"]})),l.Nodes.cast||(o.Browser.Nodes.cast=o.Browser.Node.extend({parent_type:"database",type:"cast",sqlAlterHelp:"sql-altercast.html",sqlCreateHelp:"sql-createcast.html",dialogHelp:t("help.static",{filename:"cast_dialog.html"}),canDrop:!0,canDropCascade:!0,label:e("Cast"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_cast_on_database",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Cast..."),icon:"wcTabIcon icon-cast",data:{action:"create"},enable:l.Nodes.database.is_conn_allow},{name:"create_cast_on_coll",node:"coll-cast",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Cast..."),icon:"wcTabIcon icon-cast",data:{action:"create"}},{name:"create_cast",node:"cast",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Cast..."),icon:"wcTabIcon icon-cast",data:{action:"create"}}]))},model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,encoding:"UTF8",srctyp:void 0,trgtyp:void 0,proname:void 0,castcontext:void 0,syscast:void 0,description:void 0},schema:[{id:"name",label:e("Name"),cell:"string",editable:!1,type:"text",readonly:!0,cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",editable:!1,type:"text",mode:["properties"]},{id:"srctyp",label:e("Source type"),url:"get_type",type:"text",group:e("Definition"),readonly:function(e){return!e.isNew()},mode:["create"],transform:function(e){return n.each(e,(function(e){e.image="icon-cast"})),e},control:r.NodeAjaxOptionsControl.extend({onChange:function(){r.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this.model.get("srctyp"),t=this.model.get("trgtyp");null!=e&&""!=e&&null!=t&&""!=t?this.model.set("name",e+"->"+t):this.model.unset("name")}})},{id:"srctyp",label:e("Source type"),type:"text",group:e("Definition"),readonly:!0,mode:["properties","edit"]},{id:"trgtyp",label:e("Target type"),url:"get_type",type:"text",group:e("Definition"),readonly:function(e){return!e.isNew()},mode:["create"],transform:function(e){return n.each(e,(function(e){e.image="icon-cast"})),e},control:r.NodeAjaxOptionsControl.extend({onChange:function(){r.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this.model.get("srctyp"),t=this.model.get("trgtyp");null!=e&&""!=e&&null!=t&&""!=t?this.model.set("name",e+"->"+t):this.model.unset("name")}})},{id:"trgtyp",label:e("Target type"),type:"text",group:e("Definition"),readonly:!0,mode:["properties","edit"]},{id:"proname",label:e("Function"),deps:["srctyp","trgtyp"],type:"text",readonly:function(e){return!e.isNew()},group:e("Definition"),mode:["create"],control:"node-ajax-options",options:function(e){var t=e.model.get("srctyp"),n=e.model.get("trgtyp"),o=[];if(null!=t&&""!=t&&null!=n&&""!=n){var l=e.field.get("schema_node"),r=l.generate_url.apply(l,[null,"get_functions",e.field.get("node_data"),!1,e.field.get("node_info")]);i.ajax({type:"POST",timeout:3e4,url:r,cache:!1,async:!1,data:{srctyp:t,trgtyp:n}}).done((function(e){return o=e.data})).fail((function(e,t,i){a.pgRespErrorNotify(e,i)}))}return o}},{id:"proname",label:e("Function"),type:"text",group:e("Definition"),readonly:!0,mode:["properties","edit"]},{id:"castcontext",label:e("Context"),options:{onText:"IMPLICIT",offText:"EXPLICIT",width:"90"},editable:!1,type:"string",group:e("Definition"),mode:["create"],control:r.SwitchControl.extend({getValueFromDOM:function(){return this.$input.prop("checked")?"IMPLICIT":"EXPLICIT"}})},{id:"castcontext",label:e("Context"),readonly:!0,options:[{label:"IMPLICIT",value:"IMPLICIT"},{label:"EXPLICIT",value:"EXPLICIT"},{label:"ASSIGNMENT",value:"ASSIGNMENT"}],editable:!1,type:"select2",group:e("Definition"),mode:["properties","edit"]},{id:"syscast",label:e("System cast?"),cell:"switch",type:"switch",mode:["properties"]},{id:"description",label:e("Comment"),type:"multiline",cellHeaderClasses:"width_percent_50"}],validate:function(){var t,i=this.get("srctyp"),o=this.get("trgtyp");return n.isUndefined(i)||n.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(t=e("Source type must be selected."),this.errorModel.set("srctyp",t),t):(this.errorModel.unset("srctyp"),n.isUndefined(o)||n.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(t=e("Target type must be selected."),this.errorModel.set("trgtyp",t),t):(this.errorModel.unset("trgtyp"),this.trigger("on-status-clear"),null))}})})),l.Nodes["coll-cast"]}.apply(t,n))||(e.exports=o)},243:function(e,t,i){"use strict";var n,o;i(36),i(11),i(5),i(9),i(37),n=[i(2),i(6),i(0),i(1),i(14),i(3),i(10),i(13),i(18),i(25),i(123),i(67)],void 0===(o=function(e,t,i,n,o,l,a,r,s){return a.Nodes["coll-tablespace"]||(a.Nodes["coll-tablespace"]=a.Collection.extend({node:"tablespace",label:e("Tablespaces"),type:"coll-tablespace",columns:["name","spcuser","description"],hasStatistics:!0,statsPrettifyFields:[e("Size")],canDrop:!0,canDropCascade:!1})),a.Nodes.tablespace||(a.Nodes.tablespace=a.Node.extend({parent_type:"server",type:"tablespace",sqlAlterHelp:"sql-altertablespace.html",sqlCreateHelp:"sql-createtablespace.html",dialogHelp:t("help.static",{filename:"tablespace_dialog.html"}),label:e("Tablespace"),hasSQL:!0,canDrop:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[e("Size")],Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_tablespace_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Tablespace..."),icon:"wcTabIcon icon-tablespace",data:{action:"create"},enable:"can_create_tablespace"},{name:"create_tablespace_on_coll",node:"coll-tablespace",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Tablespace..."),icon:"wcTabIcon icon-tablespace",data:{action:"create"},enable:"can_create_tablespace"},{name:"create_tablespace",node:"tablespace",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Tablespace..."),icon:"wcTabIcon icon-tablespace",data:{action:"create"},enable:"can_create_tablespace"},{name:"move_tablespace",node:"tablespace",module:this,applies:["object","context"],callback:"move_objects",category:"move_tablespace",priority:5,label:e("Move objects to..."),icon:"fa fa-exchange",data:{action:"create"},enable:"can_move_objects"}]))},can_create_tablespace:function(e,t){var i=this.getTreeNodeHierarchy(t).server;return i.connected&&i.user.is_superuser},can_move_objects:function(e,t){var i=this.getTreeNodeHierarchy(t).server;return i.connected&&i.user.is_superuser&&i.version>=90400},callbacks:{move_objects:function(l){var d=l||{},c=a.tree,p=d.item||c.selected(),u=p&&1==p.length?c.itemData(p):void 0,m=this.generate_url(p,"move_objects",u,!0),h=this.generate_url(p,"move_objects_sql",u,!0);if(!u)return!1;var g=o.Model.extend({idAttribute:"id",defaults:{new_tblspc:void 0,obj_type:"all",user:void 0},schema:[{id:"tblspc",label:e("New tablespace"),type:"text",disabled:!1,control:"node-list-by-name",node:"tablespace",select2:{allowClear:!1},filter:function(e){return e&&e.label!=u.label}},{id:"obj_type",label:e("Object type"),type:"text",disabled:!1,control:"select2",select2:{allowClear:!1,width:"100%"},options:[{label:e("All"),value:"all"},{label:e("Tables"),value:"tables"},{label:e("Indexes"),value:"indexes"},{label:e("Materialized views"),value:"materialized_views"}]},{id:"user",label:e("Object owner"),type:"text",disabled:!1,control:"node-list-by-name",node:"role",select2:{allowClear:!1}},{id:"sqltab",label:e("SQL"),group:e("SQL"),type:"text",disabled:!1,control:s.SqlTabControl.extend({initialize:function(){s.SqlTabControl.prototype.initialize.apply(this,arguments)},onTabChange:function(e){if(this.dialog&&e.shown==this.tabIndex){var t=this,n=t.model.toJSON();n.old_tblspc=u.label,i.ajax({url:h,type:"GET",cache:!1,data:n,dataType:"json",contentType:"application/json"}).done((function(e){t.sqlCtrl.clearHistory(),t.sqlCtrl.setValue(e.data),t.sqlCtrl.refresh()})).fail((function(){t.model.trigger("pgadmin-view:msql:error")})).always((function(){t.model.trigger("pgadmin-view:msql:fetched")}))}}})}],validate:function(){return null}});r.move_objects_dlg||r.dialog("move_objects_dlg",(function(){return{main:function(){var t=e("Move objects to another tablespace");this.set("title",t)},build:function(){r.pgDialogBuild.apply(this)},setup:function(){return{buttons:[{text:"",key:112,className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:e("Users"),url:t("help.static",{filename:"move_objects.html"})}},{text:e("Cancel"),key:27,className:"btn btn-secondary fa fa-lg fa-times pg-alertify-button"},{text:e("OK"),key:13,className:"btn btn-primary fa fa-lg fa-save pg-alertify-button"}],options:{padding:!1,overflow:!1,modal:!1,resizable:!0,maximizable:!0,pinnable:!1,closableByDimmer:!1}}},hooks:{onclose:function(){this.view&&this.view.remove({data:!0,internal:!0,silent:!0})}},prepare:function(){var t=this,o=i("<div class='move_objects'></div>");this.__internal.buttons[2].element.disabled=!0;var l=a.tree,r=l.selected(),d=r&&1==r.length?l.itemData(r):void 0,c=d&&a.Nodes[d._type];if(d){var p=c.getTreeNodeHierarchy.apply(c,[r]),u=new g({},{node_info:p}),m=s.generateViewSchema(p,u,"create",c,p.server,!0),h=this.view=new s.Dialog({el:o,model:u,schema:m});i(this.elements.body.childNodes[0]).addClass("alertify_tools_dialog_properties obj_properties"),h.render(),this.elements.content.appendChild(o.get(0)),this.view.model.on("change",(function(){n.isUndefined(this.get("tblspc"))||""===this.get("tblspc")?(t.__internal.buttons[2].element.disabled=!0,this.errorModel.set("tblspc",e("Please select tablespace"))):(this.errorModel.clear(),t.__internal.buttons[2].element.disabled=!1)}))}},callback:function(t){if("dialog_help"==t.button.element.name)return t.cancel=!0,void a.showHelp(t.button.element.name,t.button.element.getAttribute("url"),null,null);if(t.button.text===e("OK")){var n=this,o=this.view.model.toJSON();o.old_tblspc=u.label,t.cancel=!0,r.confirm(e("Move objects..."),e("Are you sure you wish to move the objects from %s to %s?",o.old_tblspc,o.tblspc),(function(){i.ajax({url:m,method:"PUT",data:{data:JSON.stringify(o)}}).done((function(e){e.success?(r.success(e.info),n.close()):r.error(e.errormsg)})).fail((function(e,t,i){r.pgRespErrorNotify(e,i)}))}),(function(){}))}}}})),r.move_objects_dlg(!0).resizeTo(a.stdW.md,a.stdH.md)}},model:a.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,owner:void 0,comment:void 0,spclocation:void 0,spcoptions:[],spcacl:[],seclabels:[]},initialize:function(e,t){var i=0===n.size(e);if(i){var o=a.serverInfo[t.node_info.server._id].user;this.set({spcuser:o.name},{silent:!0})}a.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"spclocation",label:e("Location"),cell:"string",group:e("Definition"),type:"text",mode:["properties","edit","create"],readonly:function(e){return!e.isNew()}},{id:"spcuser",label:e("Owner"),cell:"string",type:"text",control:"node-list-by-name",node:"role",select2:{allowClear:!1}},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"spcoptions",label:"",type:"collection",group:e("Parameters"),control:"variable-collection",model:a.Node.VariableModel,mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:!0},{id:"spcacl",label:e("Privileges"),type:"collection",group:e("Security"),control:"unique-col-collection",model:a.Node.PrivilegeRoleModel.extend({privileges:["C"]}),mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"],columns:["grantee","grantor","privileges"]},{id:"seclabels",label:e("Security labels"),model:a.SecLabelModel,editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(){var t;return n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Name cannot be empty."),this.errorModel.set("name",t)):this.isNew()&&(n.isUndefined(this.get("spclocation"))||""==String(this.get("spclocation")).replace(/^\s+|\s+$/g,""))?(t=e("Location cannot be empty."),this.errorModel.set("spclocation",t),this.errorModel.unset("name")):(this.errorModel.unset("name"),this.errorModel.unset("spclocation")),null}})})),a.Nodes["coll-tablespace"]}.apply(t,n))||(e.exports=o)},244:function(e,t,i){"use strict";var n,o;i(5),i(9),n=[i(2),i(6),i(1),i(10),i(25)],void 0===(o=function(e,t,i,n){return n.Nodes["coll-resource_group"]||(n.Nodes["coll-resource_group"]=n.Collection.extend({node:"resource_group",label:e("Resource Groups"),type:"coll-resource_group",columns:["name","cpu_rate_limit","dirty_rate_limit"],canDrop:!0,canDropCascade:!1})),n.Nodes.resource_group||(n.Nodes.resource_group=n.Node.extend({parent_type:"server",type:"resource_group",dialogHelp:t("help.static",{filename:"resource_group_dialog.html"}),label:e("Resource Group"),hasSQL:!0,canDrop:!0,Init:function(){this.initialized||(this.initialized=!0,n.add_menus([{name:"create_resourcegroup_on_server",node:"server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Resource Group..."),icon:"wcTabIcon icon-resource_group",data:{action:"create"},enable:function(e,t){return this.getTreeNodeHierarchy(t).server.connected&&"ppas"===e.server_type&&e.version>=90400}},{name:"create_resource_group_on_coll",node:"coll-resource_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Resource Group..."),icon:"wcTabIcon icon-resource_group",data:{action:"create"}},{name:"create_resource_group",node:"resource_group",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Resource Group..."),icon:"wcTabIcon icon-resource_group",data:{action:"create"}}]))},model:n.Node.Model.extend({idAttribute:"oid",defaults:{oid:void 0,name:void 0,cpu_rate_limit:0,dirty_rate_limit:0},schema:[{id:"oid",label:e("OID"),type:"text",editable:!1,mode:["properties"]},{id:"name",label:e("Name"),cell:"string",type:"text"},{id:"cpu_rate_limit",label:e("CPU rate limit (percentage)"),cell:"string",type:"numeric",min:0,max:16777216},{id:"dirty_rate_limit",label:e("Dirty rate limit (KB)"),cell:"string",type:"numeric",min:0,max:16777216}],validate:function(){var t,n=this.get("name");if(i.isUndefined(n)||i.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,""))return t=e("Name cannot be empty."),this.errorModel.set("name",t),t;this.errorModel.unset("name");var o=this.get("cpu_rate_limit");if(i.isUndefined(o)||i.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,""))return t=e("CPU rate limit cannot be empty."),this.errorModel.set("cpu_rate_limit",t),t;this.errorModel.unset("cpu_rate_limit");var l=this.get("dirty_rate_limit");return i.isUndefined(l)||i.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")?(t=e("Dirty rate limit cannot be empty."),this.errorModel.set("dirty_rate_limit",t),t):(this.errorModel.unset("dirty_rate_limit"),null)}})})),n.Nodes["coll-resource_group"]}.apply(t,n))||(e.exports=o)},245:function(e,t,i){"use strict";var n,o;i(11),i(5),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(25)],void 0===(o=function(e,t,i,n,o,l,a){return l.Nodes["coll-event_trigger"]||(o.Browser.Nodes["coll-event_trigger"]=o.Browser.Collection.extend({node:"event_trigger",label:e("Event Trigger"),type:"coll-event_trigger",columns:["name","eventowner","comment"],canDrop:!0,canDropCascade:!1})),l.Nodes.event_trigger||(o.Browser.Nodes.event_trigger=o.Browser.Node.extend({parent_type:"database",type:"event_trigger",sqlAlterHelp:"sql-altereventtrigger.html",sqlCreateHelp:"sql-createeventtrigger.html",dialogHelp:t("help.static",{filename:"event_trigger_dialog.html"}),label:e("Event Trigger"),hasSQL:!0,hasDepends:!0,canDrop:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_event_trigger_on_coll",node:"coll-event_trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Event Trigger..."),icon:"wcTabIcon icon-event_trigger",data:{action:"create"}},{name:"create_event_trigger",node:"event_trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Event Trigger..."),icon:"wcTabIcon icon-event_trigger",data:{action:"create"}},{name:"create_event_trigger",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Event Trigger..."),icon:"wcTabIcon icon-event_trigger",data:{action:"create"},enable:l.Nodes.database.is_conn_allow}]))},model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{oid:void 0,name:void 0,eventowner:void 0,comment:void 0,enabled:"O",eventfuncoid:void 0,eventfunname:void 0,eventname:"DDL_COMMAND_START",when:void 0,xmin:void 0,source:void 0,language:void 0},initialize:function(e,t){var i=0===n.size(e);if(i){var a=l.serverInfo[t.node_info.server._id].user;this.set({eventowner:a.name},{silent:!0})}o.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"eventowner",label:e("Owner"),cell:"string",type:"text",mode:["properties","edit","create"],node:"role",control:a.NodeListByNameControl},{id:"comment",label:e("Comment"),type:"multiline"},{id:"enabled",label:e("Trigger enabled?"),group:e("Definition"),mode:["properties","edit","create"],options:[{label:"Enable",value:"O"},{label:"Disable",value:"D"},{label:"Replica",value:"R"},{label:"Always",value:"A"}],control:"select2",select2:{allowClear:!1,width:"100%"}},{id:"eventfunname",label:e("Trigger function"),type:"text",control:"node-ajax-options",group:e("Definition"),url:"fopts",cache_node:"trigger_function"},{id:"eventname",label:e("Event"),group:e("Definition"),cell:"string",options:[{label:"DDL COMMAND START",value:"DDL_COMMAND_START"},{label:"DDL COMMAND END",value:"DDL_COMMAND_END"},{label:"SQL DROP",value:"SQL_DROP"}],control:"select2",select2:{allowClear:!1,width:"100%"}},{id:"when",label:e("When TAG in"),cell:"string",type:"text",group:e("Definition"),control:a.SqlFieldControl,extraClasses:["custom_height_css_class"]},{id:"seclabels",label:e("Security labels"),model:l.SecLabelModel,editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(){var t=void 0;return this.errorModel.clear(),n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Event trigger name cannot be empty."),this.errorModel.set("name",t),t):n.isUndefined(this.get("eventowner"))||""==String(this.get("eventowner")).replace(/^\s+|\s+$/g,"")?(t=e("Event trigger owner cannot be empty."),this.errorModel.set("eventowner",t),t):n.isUndefined(this.get("enabled"))?(t=e("Event trigger enabled status cannot be empty."),this.errorModel.set("enabled",t),t):n.isUndefined(this.get("eventfunname"))||""==String(this.get("eventfunname")).replace(/^\s+|\s+$/g,"")?(t=e("Event trigger function cannot be empty."),this.errorModel.set("eventfunname",t),t):n.isUndefined(this.get("eventname"))?(t=e("Event trigger event cannot be empty."),this.errorModel.set("eventname",t),t):null}})})),l.Nodes["coll-event_trigger"]}.apply(t,n))||(e.exports=o)},246:function(e,t,i){"use strict";var n,o;i(8),i(11),i(5),i(9),i(83),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(25)],void 0===(o=function(e,t,i,n,o,l,a){return l.Nodes["coll-extension"]||(o.Browser.Nodes["coll-extension"]=o.Browser.Collection.extend({node:"extension",label:e("Extension"),type:"coll-extension",columns:["name","owner","comment"]})),l.Nodes.extension||(o.Browser.Nodes.extension=o.Browser.Node.extend({parent_type:"database",type:"extension",sqlAlterHelp:"sql-alterextension.html",sqlCreateHelp:"sql-createextension.html",dialogHelp:t("help.static",{filename:"extension_dialog.html"}),hasSQL:!0,hasDepends:!0,canDrop:!0,canDropCascade:!0,label:e("Extension"),Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_extension_on_coll",node:"coll-extension",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Extension..."),icon:"wcTabIcon icon-extension",data:{action:"create"}},{name:"create_extension",node:"extension",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Extension..."),icon:"wcTabIcon icon-extension",data:{action:"create"}},{name:"create_extension",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Extension..."),icon:"wcTabIcon icon-extension",data:{action:"create"},enable:l.Nodes.database.is_conn_allow}]))},model:o.Browser.Node.Model.extend({idAttribute:"eid",schema:[{id:"name",label:e("Name"),first_empty:!0,type:"text",mode:["properties","create","edit"],visible:!0,url:"avails",readonly:function(e){return!e.isNew()},transform:function(e,t){var i=[],o=t||this,l=o.model.get("name");return o.model.isNew()?e&&n.isArray(e)&&n.each(e,(function(e){null===e.installed_version&&i.push({label:e.name,value:JSON.stringify(e)})})):i.push({label:l,value:l}),i},control:a.NodeAjaxOptionsControl.extend({getValueFromDOM:function(){var e=this.formatter.toRaw(n.unescape(this.$el.find("select").val()),this.model);return""===e?null:("string"==typeof e&&(e=JSON.parse(e)),e.name)},onChange:function(){a.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this.$el.find("select").val();if(""!=e.trim()){var t=this.formatter.toRaw(e,this.model);"string"==typeof t&&(t=JSON.parse(t)),this.model.set({version:"",relocatable:n.isNull(t.relocatable[0])||n.isUndefined(t.relocatable[0])?"":t.relocatable[0]})}else this.model.set({version:"",relocatable:!0,schema:""})}})},{id:"eid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),control:"node-list-by-name",mode:["properties"],node:"role",cell:"string",cache_level:"server"},{id:"schema",label:e("Schema"),type:"text",control:"node-list-by-name",group:e("Definition"),mode:["properties","create","edit"],deps:["relocatable"],node:"schema",first_empty:!0,disabled:function(e){return!!e.has("relocatable")&&!e.get("relocatable")}},{id:"relocatable",label:e("Relocatable?"),cell:"switch",group:e("Definition"),type:"switch",mode:["properties"]},{id:"version",label:e("Version"),cell:"string",mode:["properties","create","edit"],group:e("Definition"),control:"node-ajax-options",url:"avails",first_empty:!0,transform:function(e,t){var i=[],o=(t||this).model.get("name");return n.each(e,(function(e){e.name==o&&e.version&&n.isArray(e.version)&&n.each(e.version,(function(e){i.push({label:e,value:e})}))})),i}},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",readonly:!0}],validate:function(){var t,i={},o=this.get("name");return n.isUndefined(o)||n.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(i.name=e("Name cannot be empty."),t=t||i.name,this.errorModel.set("name",t),t):(this.errorModel.unset("name"),null)}})})),l.Nodes["coll-extension"]}.apply(t,n))||(e.exports=o)},247:function(e,t,i){"use strict";var n,o;i(16),i(11),i(5),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(25),i(67)],void 0===(o=function(e,t,i,n,o,l,a){return l.Nodes["coll-language"]||(l.Nodes["coll-language"]=l.Collection.extend({node:"language",label:e("Languages"),type:"coll-language",columns:["name","lanowner","description"]})),l.Nodes.language||(l.Nodes.language=l.Node.extend({parent_type:"database",type:"language",sqlAlterHelp:"sql-alterlanguage.html",sqlCreateHelp:"sql-createlanguage.html",dialogHelp:t("help.static",{filename:"language_dialog.html"}),label:e("Language"),hasSQL:!0,canDrop:!0,canDropCascade:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_language_on_database",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Language..."),icon:"wcTabIcon icon-language",data:{action:"create"},enable:l.Nodes.database.is_conn_allow},{name:"create_language_on_coll",node:"coll-language",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Language..."),icon:"wcTabIcon icon-language",data:{action:"create"}},{name:"create_language",node:"language",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Language..."),icon:"wcTabIcon icon-language",data:{action:"create"}}]))},model:l.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,lanowner:void 0,comment:void 0,lanacl:[],seclabels:[],trusted:!0,lanproc:void 0,laninl:void 0,lanval:void 0,is_template:!1,template_list:[]},initialize:function(e,t){var i=0===n.size(e);if(i){var o=l.serverInfo[t.node_info.server._id].user;this.set({lanowner:o.name},{silent:!0})}l.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),type:"text",control:"node-ajax-options",mode:["properties","create","edit"],url:"get_templates",select2:{allowClear:!1,tags:!0,multiple:!1},transform:function(e,t){var i=[],o=t||this,l=o.model.get("name");if(o.model.isNew()){var a=[];e&&n.isArray(e)&&n.each(e,(function(e){i.push({label:e.tmplname,value:e.tmplname}),a.push(e.tmplname)})),this.model.set({template_list:a})}else i.push({label:l,value:l});return i}},{id:"oid",label:e("OID"),cell:"string",mode:["properties"],type:"text"},{id:"lanowner",label:e("Owner"),type:"text",control:a.NodeListByNameControl,node:"role",mode:["edit","properties","create"],select2:{allowClear:!1}},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"trusted",label:e("Trusted?"),type:"switch",group:e("Definition"),mode:["edit","properties","create"],deps:["name"],disabled:function(e){return!!e.isNew()&&(-1==e.get("template_list").indexOf(e.get("name"))?(e.set({is_template:!1}),!1):(e.set({is_template:!0}),!0))},readonly:function(e){return!e.isNew()}},{id:"lanproc",label:e("Handler function"),type:"text",control:"node-ajax-options",group:e("Definition"),mode:["edit","properties","create"],url:"get_functions",deps:["name"],first_empty:!1,transform:function(e){var t=[];return e&&n.isArray(e)&&n.each(e,(function(e){"handler"==e.prop_type&&t.push({label:e.label,value:e.label})})),t},disabled:function(e){return!!e.isNew()&&-1!=e.get("template_list").indexOf(e.get("name"))},readonly:function(e){return!e.isNew()}},{id:"laninl",label:e("Inline function"),type:"text",control:"node-ajax-options",group:e("Definition"),mode:["edit","properties","create"],url:"get_functions",deps:["name"],first_empty:!1,transform:function(e){var t=[];return e&&n.isArray(e)&&n.each(e,(function(e){"inline"==e.prop_type&&t.push({label:e.label,value:e.label})})),t},disabled:function(e){return!!e.isNew()&&-1!=e.get("template_list").indexOf(e.get("name"))},readonly:function(e){return!e.isNew()}},{id:"lanval",label:e("Validator function"),type:"text",control:"node-ajax-options",group:e("Definition"),mode:["edit","properties","create"],url:"get_functions",deps:["name"],transform:function(e){var t=[];return e&&n.isArray(e)&&n.each(e,(function(e){"validator"==e.prop_type&&t.push({label:e.label,value:e.label})})),t},disabled:function(e){return!!e.isNew()&&-1!=e.get("template_list").indexOf(e.get("name"))},readonly:function(e){return!e.isNew()}},{id:"lanacl",label:e("Privileges"),type:"collection",group:e("Security"),control:"unique-col-collection",mode:["edit","create"],model:l.Node.PrivilegeRoleModel.extend({privileges:["U"]}),canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"seclabels",label:e("Security labels"),mode:["edit","create"],model:l.SecLabelModel,editable:!1,type:"collection",group:e("Security"),min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(){var t,i=this.get("name");if(n.isUndefined(i)||n.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,""))return t=e("Name cannot be empty."),this.errorModel.set("name",t),t;if(this.errorModel.unset("name"),!this.get("is_template")){var o=this.get("lanproc");if(n.isUndefined(o)||n.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,""))return t=e("Handler function cannot be empty."),this.errorModel.set("lanproc",t),t;this.errorModel.unset("lanproc")}return null}})})),l.Nodes["coll-language"]}.apply(t,n))||(e.exports=o)},248:function(e,t,i){"use strict";var n,o;i(11),i(5),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(25),i(67)],void 0===(o=function(e,t,i,n,o,l,a){var r=l.Node.Model.extend({idAttribute:"fdwoption",defaults:{fdwoption:void 0,fdwvalue:void 0},schema:[{id:"fdwoption",label:e("Option"),type:"text",cellHeaderClasses:"width_percent_50",editable:!0},{id:"fdwvalue",label:e("Value"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0}],validate:function(){if(n.isUndefined(this.get("fdwoption"))||n.isNull(this.get("fdwoption"))||""==String(this.get("fdwoption")).replace(/^\s+|\s+$/g,"")){var e="Please enter an option name";return this.errorModel.set("fdwoption",e),e}return this.errorModel.unset("fdwoption"),null}});return l.Nodes["coll-foreign_data_wrapper"]||(l.Nodes["coll-foreign_data_wrapper"]=l.Collection.extend({node:"foreign_data_wrapper",label:e("Foreign Data Wrappers"),type:"coll-foreign_data_wrapper",columns:["name","fdwowner","description"]})),l.Nodes.foreign_data_wrapper||(l.Nodes.foreign_data_wrapper=l.Node.extend({parent_type:"database",type:"foreign_data_wrapper",sqlAlterHelp:"sql-alterforeigndatawrapper.html",sqlCreateHelp:"sql-createforeigndatawrapper.html",dialogHelp:t("help.static",{filename:"foreign_data_wrapper_dialog.html"}),label:e("Foreign Data Wrapper"),hasSQL:!0,hasDepends:!0,canDrop:!0,canDropCascade:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_foreign_data_wrapper_on_coll",node:"coll-foreign_data_wrapper",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Data Wrapper..."),icon:"wcTabIcon icon-foreign_data_wrapper",data:{action:"create"}},{name:"create_foreign_data_wrapper",node:"foreign_data_wrapper",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Data Wrapper..."),icon:"wcTabIcon icon-foreign_data_wrapper",data:{action:"create"}},{name:"create_foreign_data_wrapper",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Data Wrapper..."),icon:"wcTabIcon icon-foreign_data_wrapper",data:{action:"create"},enable:l.Nodes.database.is_conn_allow}]))},model:l.Node.Model.extend({idAttribute:"fdwoid",defaults:{name:void 0,fdwowner:void 0,comment:void 0,fdwvalue:void 0,fdwhan:void 0,fdwoption:void 0,fdwacl:[]},initialize:function(e,t){var i=0===n.size(e);if(i){var o=l.serverInfo[t.node_info.server._id].user;this.set({fdwowner:o.name},{silent:!0})}l.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",readonly:function(){return"edit"==this.mode}},{id:"fdwoid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"fdwowner",label:e("Owner"),type:"text",control:a.NodeListByNameControl,node:"role",mode:["edit","create","properties"],select2:{allowClear:!1}},{id:"fdwhan",label:e("Handler"),type:"text",control:"node-ajax-options",group:e("Definition"),mode:["edit","create","properties"],url:"get_handlers"},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"fdwoptions",label:e("Options"),type:"collection",group:e("Options"),model:r,control:"unique-col-collection",mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["fdwoption"],columns:["fdwoption","fdwvalue"]},{id:"fdwvalue",label:e("Validator"),type:"text",control:"node-ajax-options",group:e("Definition"),mode:["edit","create","properties"],url:"get_validators"},{id:"security",label:e("Security"),type:"group"},{id:"fdwacl",label:e("Privileges"),type:"collection",group:"security",mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"],model:l.Node.PrivilegeRoleModel.extend({privileges:["U"]}),control:"unique-col-collection"},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"]}],validate:function(){var t=this.get("name");if(n.isUndefined(t)||n.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")){var i=e("Name cannot be empty.");return this.errorModel.set("name",i),i}return this.errorModel.unset("name"),null}})})),l.Nodes.foreign_data_wrapper}.apply(t,n))||(e.exports=o)},249:function(e,t,i){"use strict";var n,o;i(11),i(5),i(9),n=[i(2),i(0),i(1),i(3),i(10),i(18),i(25),i(67)],void 0===(o=function(e,t,i,n,o,l){var a=n.Browser.Node.Model.extend({idAttribute:"fsrvoption",defaults:{fsrvoption:void 0,fsrvvalue:void 0},schema:[{id:"fsrvoption",label:e("Options"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0},{id:"fsrvvalue",label:e("Value"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0}],validate:function(){if(i.isUndefined(this.get("fsrvoption"))||i.isNull(this.get("fsrvoption"))||""==String(this.get("fsrvoption")).replace(/^\s+|\s+$/g,"")){var e="Please enter an option name";return this.errorModel.set("fsrvoption",e),e}return this.errorModel.unset("fsrvoption"),null}});return o.Nodes["coll-foreign_server"]||(n.Browser.Nodes["coll-foreign_server"]=n.Browser.Collection.extend({node:"foreign_server",label:e("Foreign Servers"),type:"coll-foreign_server",columns:["name","fsrvowner","description"]})),o.Nodes.foreign_server||(n.Browser.Nodes.foreign_server=n.Browser.Node.extend({parent_type:"foreign_data_wrapper",type:"foreign_server",sqlAlterHelp:"sql-alterforeignserver.html",sqlCreateHelp:"sql-createforeignserver.html",label:e("Foreign Server"),hasSQL:!0,hasDepends:!0,canDrop:!0,canDropCascade:!0,Init:function(){this.initialized||(this.initialized=!0,o.add_menus([{name:"create_foreign_server_on_coll",node:"coll-foreign_server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Server..."),icon:"wcTabIcon icon-foreign_server",data:{action:"create"}},{name:"create_foreign_server",node:"foreign_server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Server..."),icon:"wcTabIcon icon-foreign_server",data:{action:"create"}},{name:"create_foreign_server",node:"foreign_data_wrapper",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Server..."),icon:"wcTabIcon icon-foreign_server",data:{action:"create"}}]))},model:n.Browser.Node.Model.extend({idAttribute:"fsrvid",defaults:{name:void 0,fsrvtype:void 0,fsrvversion:void 0,fsrvvalue:void 0,fsrvoptions:[],fsrvowner:void 0,description:void 0,fsrvacl:[]},initialize:function(e,t){var l=0===i.size(e);if(l){var a=o.serverInfo[t.node_info.server._id].user;this.set({fsrvowner:a.name},{silent:!0})}n.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:function(){return"edit"==this.mode&&this.node_info.server.version<90200}},{id:"fsrvid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"fsrvowner",label:e("Owner"),type:"text",control:l.NodeListByNameControl,node:"role",mode:["edit","create","properties"],select2:{allowClear:!1}},{id:"fsrvtype",label:e("Type"),cell:"string",group:e("Definition"),type:"text",mode:["edit","create","properties"],disabled:function(e){return!e.isNew()}},{id:"fsrvversion",label:e("Version"),cell:"string",group:e("Definition"),type:"text"},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"fsrvoptions",label:e("Options"),type:"collection",group:e("Options"),model:a,control:"unique-col-collection",mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["fsrvoption"],columns:["fsrvoption","fsrvvalue"]},o.SecurityGroupSchema,{id:"fsrvacl",label:e("Privileges"),type:"collection",group:"security",model:n.Browser.Node.PrivilegeRoleModel.extend({privileges:["U"]}),control:"unique-col-collection",mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"]}],validate:function(){var t=this.get("name");if(i.isUndefined(t)||i.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")){var n=e("Name cannot be empty.");return this.errorModel.set("name",n),n}return this.errorModel.unset("name"),null}})})),o.Nodes["coll-foreign_server"]}.apply(t,n))||(e.exports=o)},250:function(e,t,i){"use strict";var n,o;i(11),i(5),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(25)],void 0===(o=function(e,t,i,n,o,l,a){var r=o.Browser.Node.Model.extend({idAttribute:"umoption",defaults:{umoption:void 0,umvalue:void 0},schema:[{id:"umoption",label:e("Options"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0},{id:"umvalue",label:e("Value"),type:"text",cellHeaderClasses:"width_percent_50",group:null,editable:!0}],validate:function(){if(n.isUndefined(this.get("umoption"))||n.isNull(this.get("umoption"))||""==String(this.get("umoption")).replace(/^\s+|\s+$/g,"")){var e="Please enter an option name";return this.errorModel.set("umoption",e),e}return this.errorModel.unset("umoption"),null}});return l.Nodes["coll-user_mapping"]||(o.Browser.Nodes["coll-user_mapping"]=o.Browser.Collection.extend({node:"user_mapping",label:e("User Mappings"),type:"coll-user_mapping",columns:["name"]})),l.Nodes.user_mapping||(o.Browser.Nodes.user_mapping=o.Browser.Node.extend({parent_type:"foreign_server",type:"user_mapping",sqlAlterHelp:"sql-alterusermapping.html",sqlCreateHelp:"sql-createusermapping.html",dialogHelp:t("help.static",{filename:"user_mapping_dialog.html"}),label:e("User Mapping"),hasSQL:!0,hasDepends:!0,canDrop:!0,canDropCascade:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_user_mapping_on_coll",node:"coll-user_mapping",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("User Mapping..."),icon:"wcTabIcon icon-user_mapping",data:{action:"create"}},{name:"create_user_mapping",node:"user_mapping",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("User Mapping..."),icon:"wcTabIcon icon-user_mapping",data:{action:"create"}},{name:"create_user_mapping",node:"foreign_server",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("User Mapping..."),icon:"wcTabIcon icon-user_mapping",data:{action:"create"}}]))},model:o.Browser.Node.Model.extend({idAttribute:"um_oid",defaults:{name:void 0,um_options:[]},initialize:function(e,t){var i=0===n.size(e);if(i){var a=l.serverInfo[t.node_info.server._id].user;this.set({name:a.name},{silent:!0})}o.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("User"),type:"text",control:a.NodeListByNameControl,node:"role",mode:["edit","create","properties"],select2:{allowClear:!1},disabled:function(e){return!e.isNew()},transform:function(){var e=this,t=e.field.get("schema_node"),i=a.NodeListByNameControl.prototype.defaults.transform.apply(this,arguments);return i.unshift({label:"CURRENT_USER",value:"CURRENT_USER",image:"icon-"+t.type},{label:"PUBLIC",value:"PUBLIC",image:"icon-"+t.type}),i}},{id:"um_oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"umoptions",label:e("Options"),type:"collection",group:e("Options"),model:r,control:"unique-col-collection",mode:["create","edit"],canAdd:!0,canDelete:!0,uniqueCol:["umoption"]}],validate:function(){var t=this.get("name");if(n.isUndefined(t)||n.isNull(t)||""==String(t).replace(/^\s+|\s+$/g,"")){var i=e("Name cannot be empty.");return this.errorModel.set("name",i),i}return this.errorModel.unset("name"),null}})})),l.Nodes["coll-user_mapping"]}.apply(t,n))||(e.exports=o)},251:function(e,t,i){"use strict";var n,o;i(8),i(21),i(36),i(11),i(5),i(9),i(7),i(37),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(30),i(25),i(67)],void 0===(o=function(e,t,i,n,o,l,a,r){return a.VacuumCollectionControl=a.Control.extend({grid_columns:void 0,initialize:function(){a.Control.prototype.initialize.apply(this,arguments);var e=this,t=this.model,o=e.field.get("url");if(o&&t.isNew()){var l,r=e.field.get("node"),s=e.field.get("node_data"),d=e.field.get("node_info"),c=r.generate_url.apply(r,[null,o,s,!1,d]);t.trigger("pgadmin-view:fetching",t,e.field),i.ajax({async:!1,url:c}).done((function(e){l=e})).fail((function(){t.trigger("pgadmin-view:fetch:error",t,e.field)})),t.trigger("pgadmin-view:fetched",t,e.field),l&&n.isArray(l)&&t.get(e.field.get("name")).reset(l,{silent:!0})}},render:function(){var e=this.field.attributes;this.grid&&(this.grid.remove(),delete this.grid,this.grid=void 0),this.$el.empty();var t=n.template(['<div class="subnode-header">','  <span class="control-label col-sm-4"><%-label%></span>',"</div>"].join("\n")),o=i('<div class="pgadmin-control-group backgrid form-group col-12 object subnode"></div>').append(t(e)),l=this.grid=new r.Grid({columns:this.grid_columns,collection:this.model.get(this.field.get("name")),className:"backgrid table table-bordered table-noouter-border table-hover"});return this.$el.addClass("mb-0"),this.$el.append(i(o).append(l.render().$el)),this}}),a.cellFunction=function(e){switch(e.get("column_type")){case"integer":return r.IntegerCell;case"number":return r.NumberCell;case"string":return r.StringCell;default:return r.Cell}},a.VacuumTableModel=l.Node.Model.extend({defaults:{name:void 0,setting:void 0,label:void 0,value:void 0,column_type:void 0},toJSON:function(){var e=l.Node.Model.prototype.toJSON.apply(this);return delete e.label,delete e.setting,delete e.column_type,e}}),a.VacuumSettingsSchema=[{id:"spacer_ctrl",group:e("Table"),mode:["edit","create"],type:"spacer"},{id:"autovacuum_custom",label:e("Custom auto-vacuum?"),group:e("Table"),mode:["edit","create"],type:"switch",disabled:function(e){return e.top&&e.top.get("is_partitioned")?(setTimeout((function(){e.set("autovacuum_custom",!1)}),10),!0):!!e.top.inSchema.apply(this,[e])}},{id:"autovacuum_enabled",label:e("Enabled?"),group:e("Table"),mode:["edit","create"],type:"switch",deps:["autovacuum_custom"],disabled:function(e){return e.top.inSchema.apply(this,[e])||1!=e.get("autovacuum_custom")?(setTimeout((function(){e.set("autovacuum_enabled",!1)}),10),!0):(!n.isUndefined(e.get("reloptions"))&&n.isNull(e.get("reloptions"))&&setTimeout((function(){e.set("autovacuum_enabled",!0)}),10),!1)},control:a.SwitchControl.extend({onChange:function(){a.SwitchControl.prototype.onChange.apply(this,arguments);var e=this.model;e.get("autovacuum_enabled")||n.isUndefined(e.get("reloptions"))||!n.isNull(e.get("reloptions"))||setTimeout((function(){e.set("autovacuum_custom",!1)}),10)}})},{id:"vacuum_table",label:"",model:a.VacuumTableModel,editable:!1,type:"collection",canEdit:!0,group:e("Table"),mode:["edit","create"],url:"get_table_vacuum",control:a.VacuumCollectionControl.extend({grid_columns:[{name:"label",label:e("Label"),headerCell:r.Extension.CustomHeaderCell,cell:"string",editable:!1,cellHeaderClasses:"width_percent_40"},{name:"value",label:e("Value"),cellHeaderClasses:"width_percent_30",cellFunction:a.cellFunction,editable:function(e){return e.handler.get("autovacuum_enabled")},headerCell:r.Extension.CustomHeaderCell},{name:"setting",label:e("Default"),cellHeaderClasses:"width_percent_30",headerCell:r.Extension.CustomHeaderCell,cellFunction:a.cellFunction,editable:!1}]}),deps:["autovacuum_enabled"]},{id:"spacer_ctrl",group:e("TOAST table"),mode:["edit","create"],type:"spacer"},{id:"toast_autovacuum",label:e("Custom auto-vacuum?"),group:e("TOAST table"),mode:["edit","create"],type:"switch",disabled:function(e){return!(!e.top.inSchema.apply(this,[e])&&e.isNew())&&!!(e.top.inSchema.apply(this,[e])||!0!==e.get("toast_autovacuum_enabled")&&!0!==e.top.get("hastoasttable"))}},{id:"toast_autovacuum_enabled",label:e("Enabled?"),group:e("TOAST table"),mode:["edit","create"],type:"switch",deps:["toast_autovacuum"],disabled:function(e){return e.top.inSchema.apply(this,[e])||!0!==e.get("toast_autovacuum")?((e.isNew()||e.get("hastoasttable"))&&setTimeout((function(){e.set("toast_autovacuum_enabled",!1)}),10),!0):(!n.isUndefined(e.get("toast_reloptions"))&&n.isNull(e.get("toast_reloptions"))&&setTimeout((function(){e.set("toast_autovacuum_enabled",!0)}),10),!1)},control:a.SwitchControl.extend({onChange:function(){a.SwitchControl.prototype.onChange.apply(this,arguments);var e=this.model;e.get("toast_autovacuum_enabled")||n.isUndefined(e.get("toast_reloptions"))||!n.isNull(e.get("toast_reloptions"))||setTimeout((function(){e.set("toast_autovacuum",!1)}),10)}})},{id:"vacuum_toast",label:"",model:a.VacuumTableModel,type:"collection",editable:function(e){return e.isNew()},canEdit:!0,group:e("TOAST table"),mode:["properties","edit","create"],url:"get_toast_table_vacuum",control:a.VacuumCollectionControl.extend({grid_columns:[{name:"label",label:e("Label"),headerCell:r.Extension.CustomHeaderCell,cell:"string",editable:!1,cellHeaderClasses:"width_percent_40"},{name:"value",label:e("Value"),cellHeaderClasses:"width_percent_30",headerCell:r.Extension.CustomHeaderCell,cellFunction:a.cellFunction,editable:function(e){return e.handler.get("toast_autovacuum_enabled")}},{name:"setting",label:e("Default"),cellHeaderClasses:"width_percent_30",headerCell:r.Extension.CustomHeaderCell,cellFunction:a.cellFunction,editable:!1}]}),deps:["toast_autovacuum_enabled"]}],l.Nodes["coll-schema"]||(l.Nodes["coll-schema"]=l.Collection.extend({node:"schema",label:e("Schemas"),type:"coll-schema",columns:["name","namespaceowner","description"]})),l.Nodes.schema||(l.Nodes.schema=l.Node.extend({parent_type:"database",type:"schema",sqlAlterHelp:"sql-alterschema.html",sqlCreateHelp:"sql-createschema.html",dialogHelp:t("help.static",{filename:"schema_dialog.html"}),label:e("Schema"),hasSQL:!0,canDrop:!0,canDropCascade:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_schema_on_coll",node:"coll-schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Schema..."),icon:"wcTabIcon icon-schema",data:{action:"create"}},{name:"create_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Schema..."),icon:"wcTabIcon icon-schema",data:{action:"create"}},{name:"create_schema",node:"database",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Schema..."),icon:"wcTabIcon icon-schema",data:{action:"create"},enable:"can_create_schema"}]))},can_create_schema:function(e){return l.Nodes.database.is_conn_allow.call(this,e)},model:l.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,namespaceowner:void 0,description:void 0,is_system_obj:void 0},initialize:function(e,t){var i=0===n.size(e);if(i){var o=l.serverInfo[t.node_info.server._id].user;this.set({namespaceowner:o.name},{silent:!0})}l.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"namespaceowner",label:e("Owner"),cell:"string",type:"text",control:"node-list-by-name",node:"role",select2:{allowClear:!1}},{id:"is_sys_object",label:e("System schema?"),cell:"switch",type:"switch",mode:["properties"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"]},{id:"tblacl",label:e("Default TABLE privileges"),type:"text",group:e("Security"),mode:["properties"]},{id:"seqacl",label:e("Default SEQUENCE privileges"),type:"text",group:e("Security"),mode:["properties"]},{id:"funcacl",label:e("Default FUNCTION privileges"),group:e("Security"),type:"text",mode:["properties"]},{id:"typeacl",label:e("Default TYPE privileges"),type:"text",group:e("Security"),mode:["properties"],min_version:90200,visible:function(){return this.version_compatible}},{id:"nspacl",label:e("Privileges"),model:l.Node.PrivilegeRoleModel.extend({privileges:["C","U"]}),uniqueCol:["grantee","grantor"],editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection"},{id:"seclabels",label:e("Security labels"),model:l.SecLabelModel,editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"},{type:"nested",control:"tab",group:e("Default privileges"),mode:["create","edit"],schema:[{id:"deftblacl",model:l.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),label:"",editable:!1,type:"collection",group:e("Tables"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"defseqacl",model:l.Node.PrivilegeRoleModel.extend({privileges:["r","w","U"]}),label:"",editable:!1,type:"collection",group:e("Sequences"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"deffuncacl",model:l.Node.PrivilegeRoleModel.extend({privileges:["X"]}),label:"",editable:!1,type:"collection",group:e("Functions"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"]},{id:"deftypeacl",model:l.Node.PrivilegeRoleModel.extend({privileges:["U"]}),label:"",editable:!1,type:"collection",group:e("Types"),mode:["edit","create"],control:"unique-col-collection",canAdd:!0,canDelete:!0,uniqueCol:["grantee","grantor"],min_version:90200}]}],validate:function(){var t=null;return this.errorModel.clear(),n.isUndefined(this.get("name"))||n.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Name cannot be empty."),this.errorModel.set("name",t),t):n.isUndefined(this.get("namespaceowner"))||n.isNull(this.get("namespaceowner"))||""==String(this.get("namespaceowner")).replace(/^\s+|\s+$/g,"")?(t=e("Owner cannot be empty."),this.errorModel.set("namespaceowner",t),t):null}})}),l.tableChildTreeNodeHierarchy=function(e){return this.getTreeNodeHierarchy(e)}),r.Extension.TableChildSwitchCell=r.Extension.SwitchCell.extend({initialize:function(){r.Extension.SwitchCell.prototype.initialize.apply(this,arguments),r.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){var e=this.model,t=this.column,i=this.column.get("editable"),o=this.$el.find("input[type=checkbox]").first(),l=t.get("name");return(n.isFunction(i)?!!i.apply(t,[e]):!!i)?(this.$el.addClass("editable"),o.bootstrapToggle("disabled",!1)):(this.$el.removeClass("editable"),o.bootstrapToggle("disabled",!0),setTimeout((function(){e.set(l,!1)}),10)),this.delegateEvents(),this},remove:r.Extension.DependentCell.prototype.remove}),l.Nodes.schema}.apply(t,n))||(e.exports=o)},252:function(e,t,i){"use strict";var n,o;i(11),n=[i(2),i(0),i(1),i(3),i(10),i(25)],void 0===(o=function(e,t,i,n,o){return o.Nodes["coll-catalog"]||(o.Nodes["coll-catalog"]=o.Collection.extend({node:"catalog",label:e("Catalogs"),type:"coll-catalog",columns:["name","namespaceowner","description"],canDrop:!1,canDropCascade:!1})),o.Nodes.catalog||(o.Nodes.catalog=o.Node.extend({parent_type:"database",type:"catalog",label:e("Catalog"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0)},model:o.Node.Model.extend({defaults:{name:void 0,namespaceowner:void 0,nspacl:void 0,description:void 0,securitylabel:[]},initialize:function(e,t){var n=0===i.size(e);if(n){var l=o.serverInfo[t.node_info.server._id].user;this.set({namespaceowner:l.name},{silent:!0})}o.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",readonly:!0},{id:"oid",label:e("OID"),cell:"string",mode:["properties"],type:"text"},{id:"namespaceowner",label:e("Owner"),cell:"string",type:"text",readonly:!0},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"seclabels",label:e("Security labels"),model:o.SecLabelModel,editable:!1,type:"collection",group:e("Security"),mode:["edit","create"],min_version:90200,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(){return null}})})),o.Nodes.catalog}.apply(t,n))||(e.exports=o)},253:function(e,t,i){"use strict";var n,o;n=[i(2),i(0),i(1),i(3),i(10),i(25)],void 0===(o=function(e,t,i,n,o){return o.Nodes["coll-catalog_object"]||(n.Browser.Nodes["coll-catalog_object"]=n.Browser.Collection.extend({node:"catalog_object",label:e("Catalog Objects"),type:"coll-catalog_object",columns:["name","owner","description"],canDrop:!1,canDropCascade:!1})),o.Nodes.catalog_object||(n.Browser.Nodes.catalog_object=n.Browser.Node.extend({parent_type:"catalog",type:"catalog_object",label:e("Catalog Object"),hasSQL:!1,hasScriptTypes:[],hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0)},model:n.Browser.Node.Model.extend({defaults:{name:void 0,namespaceowner:void 0,nspacl:void 0,description:void 0},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",readonly:!0},{id:"oid",label:e("OID"),cell:"string",type:"text"},{id:"owner",label:e("Owner"),cell:"string",type:"text",readonly:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline",readonly:!0}]})})),o.Nodes.catalog_object}.apply(t,n))||(e.exports=o)},254:function(e,t,i){"use strict";var n,o;i(36),i(11),i(5),i(59),i(9),i(37),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(64),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r){return l.Nodes["coll-collation"]||(o.Browser.Nodes["coll-collation"]=o.Browser.Collection.extend({node:"collation",label:e("Collations"),type:"coll-collation",columns:["name","owner","description"],canDrop:r.isTreeItemOfChildOfSchema,canDropCascade:r.isTreeItemOfChildOfSchema})),l.Nodes.collation||(o.Browser.Nodes.collation=a.SchemaChildNode.extend({type:"collation",sqlAlterHelp:"sql-altercollation.html",sqlCreateHelp:"sql-createcollation.html",dialogHelp:t("help.static",{filename:"collation_dialog.html"}),label:e("Collation"),collection_type:"coll-collation",hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_collation_on_coll",node:"coll-collation",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Collation..."),icon:"wcTabIcon icon-collation",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_collation",node:"collation",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Collation..."),icon:"wcTabIcon icon-collation",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_collation",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Collation..."),icon:"wcTabIcon icon-collation",data:{action:"create",check:!1},enable:"canCreate"}]))},model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,owner:void 0,lc_type:void 0,lc_collate:void 0,description:void 0},initialize:function(e,t){var i=0===n.size(e);if(i){var a=l.serverInfo[t.node_info.server._id].user,r=t.node_info.schema;this.set({owner:a.name},{silent:!0}),this.set({schema:r._label},{silent:!0})}o.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchema"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchema",control:"node-list-by-name",node:"role"},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",disabled:"inSchema",filter:function(e){return!e||!e.label.match(/^pg_/)},control:"node-list-by-name",cache_node:"database",cached_level:"database"},{id:"copy_collation",label:e("Copy collation"),cell:"string",control:"node-ajax-options",type:"text",mode:["create","edit"],group:e("Definition"),url:"get_collations",disabled:"inSchemaWithModelCheck",readonly:function(e){return!e.isNew},deps:["locale","lc_collate","lc_type"]},{id:"locale",label:e("Locale"),cell:"string",type:"text",mode:["create","edit"],group:e("Definition"),disabled:"inSchemaWithModelCheck",readonly:function(e){return!e.isNew},deps:["lc_collate","lc_type","copy_collation"]},{id:"lc_collate",label:e("LC_COLLATE"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Definition"),deps:["locale","copy_collation"],disabled:"inSchemaWithModelCheck",readonly:function(e){return!e.isNew}},{id:"lc_type",label:e("LC_TYPE"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Definition"),disabled:"inSchemaWithModelCheck",readonly:function(e){return!e.isNew},deps:["locale","copy_collation"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function(){var t=void 0,i=this.changed,o=!1,l=!1,a=!1,r=!1,s=this.toJSON();return this.errorModel.clear(),(n.has(i,s.name)&&n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(t=e("Name cannot be empty."),this.errorModel.set("name",t)),n.has(i,s.locale)&&(n.isUndefined(this.get("locale"))||""==String(this.get("locale")).replace(/^\s+|\s+$/g,""))&&(o=!0),n.has(i,s.lc_collate)&&(n.isUndefined(this.get("lc_collate"))||""==String(this.get("lc_collate")).replace(/^\s+|\s+$/g,""))&&(a=!0),n.has(i,s.lc_type)&&(n.isUndefined(this.get("lc_type"))||""==String(this.get("lc_type")).replace(/^\s+|\s+$/g,""))&&(l=!0),n.has(i,s.copy_collation)&&(n.isUndefined(this.get("copy_collation"))||""==String(this.get("copy_collation")).replace(/^\s+|\s+$/g,""))&&(r=!0),o&&(a||l)&&r&&(t=e("Definition incomplete. Please provide Locale OR Copy Collation OR LC_TYPE/LC_COLLATE.")),null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){if(this.node_info&&"schema"in this.node_info){if(e.isNew()&&"copy_collation"==this.name)return!!e.get("locale")||!(!e.get("lc_collate")&&!e.get("lc_type"));if(e.isNew()&&("lc_collate"==this.name||"lc_type"==this.name))return!!e.get("locale")||!!e.get("copy_collation");if(e.isNew()&&"locale"==this.name)return!(!e.get("lc_collate")&&!e.get("lc_type"))||!!e.get("copy_collation")}return!0}})})),l.Nodes.collation}.apply(t,n))||(e.exports=o)},255:function(e,t,i){"use strict";var n,o;i(36),i(11),i(5),i(9),i(7),i(37),n=[i(2),i(6),i(0),i(1),i(14),i(3),i(10),i(18),i(30),i(64),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r,s,d,c){a.Nodes["coll-domain"]||(a.Nodes["coll-domain"]=a.Collection.extend({node:"domain",label:e("Domains"),type:"coll-domain",columns:["name","owner","description"],canDrop:c.isTreeItemOfChildOfSchema,canDropCascade:c.isTreeItemOfChildOfSchema}));var p=a.Node.Model.extend({idAttribute:"conoid",initialize:function(e){0===!n.size(e)&&(this.convalidated_default=this.get("convalidated")),a.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{conoid:void 0,conname:void 0,consrc:void 0,convalidated:!0},convalidated_default:!0,schema:[{id:"conoid",type:"text",cell:"string",visible:!1},{id:"conname",label:e("Name"),type:"text",cell:"string",cellHeaderClasses:"width_percent_40",editable:function(e){if(n.isUndefined(e.isNew))return!0;if(!e.isNew()&&this.get("node_info").server.version<90200)return!1;return!0}},{id:"consrc",label:e("Check"),type:"multiline",cell:s.Extension.TextareaCell,group:e("Definition"),cellHeaderClasses:"width_percent_60",editable:function(e){return!!n.isUndefined(e.isNew)||e.isNew()}},{id:"convalidated",label:e("Validate?"),type:"switch",cell:"boolean",group:e("Definition"),editable:function(e){return!(this.get("node_info").server.version<90200)&&(!!n.isUndefined(e.isNew)||(!!e.isNew()||(!e.get("convalidated")||!e.convalidated_default)))}}],toJSON:o.Model.prototype.toJSON,validate:function(){return null}});return a.Nodes.domain||(a.Nodes.domain=d.SchemaChildNode.extend({type:"domain",sqlAlterHelp:"sql-alterdomain.html",sqlCreateHelp:"sql-createdomain.html",dialogHelp:t("help.static",{filename:"domain_dialog.html"}),label:e("Domain"),collection_type:"coll-domain",hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_domain_on_coll",node:"coll-domain",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Domain..."),icon:"wcTabIcon icon-domain",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_domain",node:"domain",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Domain..."),icon:"wcTabIcon icon-domain",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_domain",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Domain..."),icon:"wcTabIcon icon-domain",data:{action:"create",check:!1},enable:"canCreate"}]))},model:a.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){var i=0===n.size(e);if(i){var o=t.node_info.schema.label;this.set({basensp:o},{silent:!0});var l=a.serverInfo[t.node_info.server._id].user;this.set({owner:l.name},{silent:!0})}a.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:void 0,oid:void 0,owner:void 0,basensp:void 0,description:void 0,basetype:void 0,typlen:void 0,precision:void 0,typdefault:void 0,typnotnull:void 0,sysdomain:void 0,collname:void 0,constraints:[],seclabels:[]},type_options:void 0,schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"]},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",control:r.NodeListByNameControl,node:"role",type:"text",mode:["edit","create","properties"]},{id:"basensp",label:e("Schema"),cell:"node-list-by-name",control:"node-list-by-name",cache_level:"database",type:"text",node:"schema",mode:["create","edit"]},{id:"sysdomain",label:e("System domain?"),cell:"boolean",type:"switch",mode:["properties"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"basetype",label:e("Base type"),cell:"string",control:"node-ajax-options",type:"text",url:"get_types",mode:["properties","create","edit"],group:e("Definition"),first_empty:!0,cache_node:"type",readonly:function(e){return!e.isNew()},transform:function(e){return this.model.type_options=e,e}},{id:"typlen",label:e("Length"),cell:"string",type:"text",group:e("Definition"),deps:["basetype"],readonly:function(e){return!e.isNew()},disabled:function(e){var t=e.get("basetype");return e.type_options&&(n.each(e.type_options,(function(i){t==i.value&&(i.length?(e.set("is_tlength",!0,{silent:!0}),e.set("min_val",i.min_val,{silent:!0}),e.set("max_val",i.max_val,{silent:!0})):e.set("is_tlength",!1,{silent:!0}))})),!e.get("is_tlength")&&setTimeout((function(){e.get("typlen")&&e.set("typlen",null)}),10)),!e.get("is_tlength")}},{id:"precision",label:e("Precision"),cell:"string",type:"text",group:e("Definition"),deps:["basetype"],readonly:function(e){return!e.isNew()},disabled:function(e){var t=e.get("basetype");return e.type_options&&(n.each(e.type_options,(function(i){t==i.value&&(i.precision?(e.set("is_precision",!0,{silent:!0}),e.set("min_val",i.min_val,{silent:!0}),e.set("max_val",i.max_val,{silent:!0})):e.set("is_precision",!1,{silent:!0}))})),!e.get("is_precision")&&setTimeout((function(){e.get("precision")&&e.set("precision",null)}),10)),!e.get("is_precision")}},{id:"typdefault",label:e("Default"),cell:"string",type:"text",group:e("Definition"),placeholder:"Enter an expression or a value."},{id:"typnotnull",label:e("Not NULL?"),cell:"boolean",type:"switch",group:e("Definition")},{id:"collname",label:e("Collation"),cell:"string",control:"node-ajax-options",type:"text",url:"get_collations",group:e("Definition"),cache_level:"database",cache_node:"schema",readonly:function(e){return!e.isNew()}},{id:"constraints",label:e("Constraints"),cell:"string",type:"collection",group:e("Constraints"),mode:["edit","create"],model:p,canAdd:!0,canDelete:!0,canEdit:!1,columns:["conname","consrc","convalidated"]},a.SecurityGroupSchema,{id:"seclabels",label:e("Security labels"),model:a.SecLabelModel,type:"collection",group:"security",mode:["edit","create"],min_version:90100,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection",uniqueCol:["provider"]}],validate:function(){var t,i={};return(n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(i.name=e("Name cannot be empty."),t=t||i.name),(n.isUndefined(this.get("basetype"))||""==String(this.get("basetype")).replace(/^\s+|\s+$/g,""))&&(i.basetype=e("Base Type cannot be empty."),t=t||i.basetype),this.errorModel.clear().set(i),t}})})),a.Nodes.domain}.apply(t,n))||(e.exports=o)},256:function(e,t,i){"use strict";var n,o;i(5),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a){return l.Nodes["coll-domain_constraints"]||(o.Browser.Nodes["coll-domain_constraints"]=o.Browser.Collection.extend({node:"domain_constraints",label:e("Domain Constraints"),type:"coll-domain_constraints",columns:["name","description"],canDrop:a.isTreeItemOfChildOfSchema,canDropCascade:!1})),l.Nodes.domain_constraints||(o.Browser.Nodes.domain_constraints=l.Node.extend({type:"domain_constraints",sqlAlterHelp:"sql-alterdomain.html",sqlCreateHelp:"sql-alterdomain.html",dialogHelp:t("help.static",{filename:"domain_constraint_dialog.html"}),label:e("Domain Constraints"),collection_type:"coll-domain_constraints",hasSQL:!0,hasDepends:!0,parent_type:["domain"],Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_domain_on_coll",node:"coll-domain_constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Domain Constraint..."),icon:"wcTabIcon icon-domain_constraints",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_domain_constraints",node:"domain_constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Domain Constraint..."),icon:"wcTabIcon icon-domain_constraints",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_domain_constraints",node:"domain",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Domain Constraint..."),icon:"wcTabIcon icon-domain_constraints",data:{action:"create",check:!1},enable:"canCreate"}]))},canDrop:a.isTreeItemOfChildOfSchema,model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,description:void 0,consrc:void 0,connoinherit:void 0,convalidated:!0},schema:[{id:"name",label:e("Name"),type:"text",cell:"string"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"description",label:e("Comment"),type:"multiline",cell:"string",mode:["properties","create","edit"],min_version:90500},{id:"consrc",label:e("Check"),type:"multiline",cel:"string",group:e("Definition"),mode:["properties","create","edit"],readonly:function(e){return!e.isNew()}},{id:"connoinherit",label:e("No inherit?"),type:"switch",cell:"boolean",group:e("Definition"),mode:["properties","create","edit"],visible:!1},{id:"convalidated",label:e("Validate?"),type:"switch",cell:"boolean",group:e("Definition"),min_version:90200,disabled:function(e){return!(e.isNew()||!e.get("convalidated"))},mode:["properties","create","edit"]}],validate:function(){var t,i={};return(n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(i.name=e("Name cannot be empty."),t=t||i.name),(n.isUndefined(this.get("consrc"))||""==String(this.get("consrc")).replace(/^\s+|\s+$/g,""))&&(i.consrc=e("Check cannot be empty."),t=t||i.consrc),this.errorModel.clear().set(i),n.size(i)?(this.trigger("on-status",{msg:t}),t):null}})})),l.Nodes.domain}.apply(t,n))||(e.exports=o)},257:function(e,t,i){"use strict";var n,o;i(21),i(36),i(11),i(35),i(5),i(9),i(29),i(7),i(37),n=[i(2),i(6),i(0),i(1),i(14),i(3),i(10),i(18),i(30),i(64),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r,s,d,c){a.Nodes["coll-foreign_table"]||(a.Nodes["coll-foreign_table"]=a.Collection.extend({node:"foreign_table",label:e("Foreign Tables"),type:"coll-foreign_table",columns:["name","owner","description"],canDrop:c.isTreeItemOfChildOfSchema,canDropCascade:c.isTreeItemOfChildOfSchema}));var p=a.Node.Model.extend({idAttribute:"option",defaults:{option:void 0,value:void 0},schema:[{id:"option",label:e("Option"),type:"text",editable:!0,cellHeaderClasses:"width_percent_30"},{id:"value",label:e("Value"),type:"text",editable:!0,cellHeaderClasses:"width_percent_50"}],validate:function(){if(n.isUndefined(this.get("value"))||n.isNull(this.get("value"))||""==String(this.get("value")).replace(/^\s+|\s+$/g,"")){var e="Please enter a value.";return this.errorModel.set("value",e),e}return this.errorModel.unset("value"),null}}),u=a.Node.Model.extend({idAttribute:"attnum",defaults:{attname:void 0,datatype:void 0,typlen:void 0,precision:void 0,typdefault:void 0,attnotnull:void 0,collname:void 0,attnum:void 0,inheritedfrom:void 0,inheritedid:void 0,attstattarget:void 0,coloptions:[]},type_options:void 0,schema:[{id:"attname",label:e("Name"),cell:"string",type:"text",editable:"is_editable_column",cellHeaderClasses:"width_percent_40"},{id:"datatype",label:e("Data type"),cell:"node-ajax-options",control:"node-ajax-options",type:"text",url:"get_types",editable:"is_editable_column",cellHeaderClasses:"width_percent_0",group:e("Definition"),transform:function(e,t){return t.model.type_options=e,e}},{id:"typlen",label:e("Length"),cell:"string",group:e("Definition"),type:"int",deps:["datatype"],disabled:function(e){var t=e.get("typlen");if(!(n.isUndefined(e.get("inheritedid"))||n.isNull(e.get("inheritedid"))||n.isUndefined(e.get("inheritedfrom"))||n.isNull(e.get("inheritedfrom"))))return n.isUndefined(t)||setTimeout((function(){e.set("typlen",void 0)}),10),!0;var i=e.get("datatype"),o=!1;return e.type_options?(e.set("is_tlength",!1,{silent:!0}),n.each(e.type_options,(function(t){i==t.value&&t.length&&(o=!0,e.set("is_tlength",!0,{silent:!0}),e.set("min_val",t.min_val,{silent:!0}),e.set("max_val",t.max_val,{silent:!0}))})),o||n.isUndefined(t)||setTimeout((function(){e.set("typlen",void 0)}),10),!e.get("is_tlength")):(o||n.isUndefined(t)||setTimeout((function(){e.set("typlen",void 0)}),10),!0)},cellHeaderClasses:"width_percent_10"},{id:"precision",label:e("Precision"),type:"int",deps:["datatype"],cell:"string",group:e("Definition"),disabled:function(e){var t=e.get("precision");if(!(n.isUndefined(e.get("inheritedid"))||n.isNull(e.get("inheritedid"))||n.isUndefined(e.get("inheritedfrom"))||n.isNull(e.get("inheritedfrom"))))return n.isUndefined(t)||setTimeout((function(){e.set("precision",void 0)}),10),!0;var i=e.get("datatype"),o=!1;return e.type_options?(e.set("is_precision",!1,{silent:!0}),n.each(e.type_options,(function(t){i==t.value&&t.precision&&(o=!0,e.set("is_precision",!0,{silent:!0}),e.set("min_val",t.min_val,{silent:!0}),e.set("max_val",t.max_val,{silent:!0}))})),o||n.isUndefined(t)||setTimeout((function(){e.set("precision",void 0)}),10),!e.get("is_precision")):(o||n.isUndefined(t)||setTimeout((function(){e.set("precision",void 0)}),10),!0)},cellHeaderClasses:"width_percent_10"},{id:"typdefault",label:e("Default"),type:"text",cell:"string",min_version:90300,group:e("Definition"),placeholder:"Enter an expression or a value.",cellHeaderClasses:"width_percent_10",editable:function(e){return!!(n.isUndefined(e.get("inheritedid"))||n.isNull(e.get("inheritedid"))||n.isUndefined(e.get("inheritedfrom"))||n.isNull(e.get("inheritedfrom")))&&!(this.get("node_info").server.version<90300)}},{id:"attnotnull",label:e("Not NULL?"),cell:"boolean",type:"switch",editable:"is_editable_column",cellHeaderClasses:"width_percent_10",group:e("Definition")},{id:"attstattarget",label:e("Statistics"),min_version:90200,cell:"integer",type:"int",group:e("Definition"),editable:function(e){return!n.isUndefined(e.isNew)&&!e.isNew()&&(!(this.get("node_info").server.version<90200)&&!!(n.isUndefined(e.get("inheritedid"))||n.isNull(e.get("inheritedid"))||n.isUndefined(e.get("inheritedfrom"))||n.isNull(e.get("inheritedfrom"))))},cellHeaderClasses:"width_percent_10"},{id:"collname",label:e("Collation"),cell:"node-ajax-options",control:"node-ajax-options",type:"text",url:"get_collations",min_version:90300,editable:function(e){return!(!n.isUndefined(e.isNew)&&!e.isNew())&&!!(n.isUndefined(e.get("inheritedid"))||n.isNull(e.get("inheritedid"))||n.isUndefined(e.get("inheritedfrom"))||n.isNull(e.get("inheritedfrom")))},cellHeaderClasses:"width_percent_20",group:e("Definition")},{id:"attnum",cell:"string",type:"text",visible:!1},{id:"inheritedfrom",label:e("Inherited From"),cell:"string",type:"text",visible:!1,mode:["properties","edit"],cellHeaderClasses:"width_percent_10"},{id:"coloptions",label:e("Options"),cell:"string",type:"collection",group:e("Options"),mode:["edit","create"],model:p,canAdd:!0,canDelete:!0,canEdit:!1,control:r.UniqueColCollectionControl,uniqueCol:["option"],min_version:90200}],validate:function(){var t=null;return n.isUndefined(this.get("attname"))||""==String(this.get("attname")).replace(/^\s+|\s+$/g,"")?(t=e("Column Name cannot be empty."),this.errorModel.set("attname",t)):this.errorModel.unset("attname"),n.isUndefined(this.get("datatype"))||""==String(this.get("datatype")).replace(/^\s+|\s+$/g,"")?(t=e("Column Datatype cannot be empty."),this.errorModel.set("datatype",t)):this.errorModel.unset("datatype"),t},is_editable_column:function(e){return!!(n.isUndefined(e.get("inheritedid"))||n.isNull(e.get("inheritedid"))||n.isUndefined(e.get("inheritedfrom"))||n.isNull(e.get("inheritedfrom")))},toJSON:o.Model.prototype.toJSON}),m=r.NodeAjaxOptionsControl.extend({onChange:function(){var e=this.model,t=this.field.get("name").split("."),i=t.shift(),l=t.join("."),a=this.getValueFromDOM(),r={},s=e.get("columns"),d=e.get(i);if(this.model.errorModel instanceof o.Model)if(n.isEmpty(l))this.model.errorModel.unset(i);else{var c=this.model.errorModel.get(i);c&&(this.keyPathSetter(c,l,null),this.model.errorModel.set(i,c))}var p=this;if("string"==typeof d&&(d=JSON.parse(d)),n.size(a)<n.size(d)){var u=n.difference(d,a),m=s.where({inheritedid:parseInt(u[0])});s.remove(m)}else n.each(a,(function(e){var t=s.where({inheritedid:parseInt(e)});if(t&&t.length<=0){var i=p.fetchColumns(e);s.add(i)}}));r[i]=n.isEmpty(l)?a:n.clone(e.get(i))||{},this.stopListening(this.model,"change:"+i,this.render),e.set(r),this.listenTo(this.model,"change:"+i,this.render)},fetchColumns:function(e){var t=this,n="get_columns",o=t.model.top||t.model,l=this.field.get("schema_node"),r=this.field.get("node_info"),s=l.generate_url.apply(l,[null,n,this.field.get("node_data"),this.field.get("url_with_id")||!1,r]),d=this.field.get("cache_level")||l.type,c=this.field.get("cache_node");c=c&&a.Nodes.cache_node||l,o.trigger("pgadmin:view:fetching",o,t.field);var p={attrelid:e};return i.ajax({async:!1,url:s,data:p}).done((function(e){p=c.cache(n,r,d,e.data)})).fail((function(){o.trigger("pgadmin:view:fetch:error",o,t.field)})),o.trigger("pgadmin:view:fetched",o,t.field),p=p&&p.data||[]}}),h=a.Node.Model.extend({idAttribute:"conoid",initialize:function(e){var t=0===n.size(e);t||(this.convalidated_default=this.get("convalidated")),a.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{conoid:void 0,conname:void 0,consrc:void 0,connoinherit:void 0,convalidated:!0,conislocal:void 0},convalidated_default:!0,schema:[{id:"conoid",type:"text",cell:"string",visible:!1},{id:"conname",label:e("Name"),type:"text",cell:"string",editable:"is_editable",cellHeaderClasses:"width_percent_30"},{id:"consrc",label:e("Check"),type:"multiline",editable:"is_editable",cell:s.Extension.TextareaCell,cellHeaderClasses:"width_percent_30"},{id:"connoinherit",label:e("No inherit?"),type:"switch",cell:"boolean",editable:"is_editable",cellHeaderClasses:"width_percent_20"},{id:"convalidated",label:e("Validate?"),type:"switch",cell:"boolean",cellHeaderClasses:"width_percent_20",editable:function(e){return!!n.isUndefined(e.isNew)||(!!e.isNew()||(!e.get("convalidated")||!e.convalidated_default))}}],validate:function(){var t,i={};return(n.isUndefined(this.get("conname"))||""==String(this.get("conname")).replace(/^\s+|\s+$/g,""))&&(i.conname=e("Constraint Name cannot be empty."),t=t||i.conname),(n.isUndefined(this.get("consrc"))||""==String(this.get("consrc")).replace(/^\s+|\s+$/g,""))&&(i.consrc=e("Constraint Check cannot be empty."),t=t||i.consrc),this.errorModel.clear().set(i),t},is_editable:function(e){return!!n.isUndefined(e.isNew)||e.isNew()},toJSON:o.Model.prototype.toJSON}),g=a.Node.Model.extend({defaults:{option:void 0,value:void 0},schema:[{id:"option",label:e("Option"),cell:"string",type:"text",editable:!0,cellHeaderClasses:"width_percent_50"},{id:"value",label:e("Value"),cell:"string",type:"text",editable:!0,cellHeaderClasses:"width_percent_50"}],validate:function(){},toJSON:o.Model.prototype.toJSON});return a.Nodes.foreign_table||(a.Nodes.foreign_table=d.SchemaChildNode.extend({type:"foreign_table",sqlAlterHelp:"sql-alterforeigntable.html",sqlCreateHelp:"sql-createforeigntable.html",dialogHelp:t("help.static",{filename:"foreign_table_dialog.html"}),label:e("Foreign Table"),collection_type:"coll-foreign_table",hasSQL:!0,hasDepends:!0,hasScriptTypes:["create","select","insert","update","delete"],parent_type:["schema"],Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_foreign_table_on_coll",node:"coll-foreign_table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Table..."),icon:"wcTabIcon icon-foreign_table",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_foreign_table",node:"foreign_table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Table..."),icon:"wcTabIcon icon-foreign_table",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_foreign_table",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign Table..."),icon:"wcTabIcon icon-foreign_table",data:{action:"create",check:!1},enable:"canCreate"}]))},model:a.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){var i=0===n.size(e);if(i){var o=t.node_info.schema._label,l=a.serverInfo[t.node_info.server._id].user;this.set({basensp:o,owner:l.name},{silent:!0})}a.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:void 0,oid:void 0,owner:void 0,basensp:void 0,description:void 0,ftsrvname:void 0,strftoptions:void 0,inherits:[],columns:[],constraints:[],ftoptions:[],relacl:[],stracl:[],seclabels:[]},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"]},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",control:r.NodeListByNameControl,node:"role",type:"text",select2:{allowClear:!1}},{id:"basensp",label:e("Schema"),cell:"node-list-by-name",control:"node-list-by-name",cache_level:"database",type:"text",node:"schema",mode:["create","edit"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline"},{id:"ftsrvname",label:e("Foreign server"),cell:"string",control:"node-ajax-options",type:"text",group:e("Definition"),url:"get_foreign_servers",readonly:function(e){return!e.isNew()},cache_node:"database"},{id:"inherits",label:e("Inherits"),group:e("Definition"),type:"array",min_version:90500,control:m,url:"get_tables",select2:{multiple:!0},cache_level:"database",transform:function(e){if("edit"==this.field.get("mode")){var t=this.model.get("oid"),i=n.findWhere(e,{id:t});i&&(e=n.reject(e,i))}return e}},{id:"columns",label:e("Columns"),cell:"string",type:"collection",group:e("Columns"),mode:["edit","create"],model:u,canAdd:!0,canDelete:!0,canEdit:!0,columns:["attname","datatype","inheritedfrom"],canDeleteRow:function(e){return!!(n.isUndefined(e.get("inheritedid"))||n.isNull(e.get("inheritedid"))||n.isUndefined(e.get("inheritedfrom"))||n.isNull(e.get("inheritedfrom")))},canEditRow:function(e){return!!(n.isUndefined(e.get("inheritedid"))||n.isNull(e.get("inheritedid"))||n.isUndefined(e.get("inheritedfrom"))||n.isNull(e.get("inheritedfrom")))}},{id:"constraints",label:e("Constraints"),cell:"string",type:"collection",group:e("Constraints"),mode:["edit","create"],model:h,canAdd:!0,canDelete:!0,columns:["conname","consrc","connoinherit","convalidated"],canEdit:function(e){return!(e instanceof o.Model&&e instanceof h)||e.isNew()},min_version:90500,canDeleteRow:function(e){return!(1!=e.get("conislocal")&&!n.isUndefined(e.get("conislocal")))}},{id:"strftoptions",label:e("Options"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"ftoptions",label:e("Options"),cell:"string",type:"collection",group:e("Options"),mode:["edit","create"],model:g,canAdd:!0,canDelete:!0,canEdit:!1,control:"unique-col-collection",uniqueCol:["option"]},{id:"relacl",label:e("Privileges"),cell:"string",type:"text",group:e("Security"),mode:["properties"],min_version:90200},a.SecurityGroupSchema,{id:"acl",label:e("Privileges"),model:l.Browser.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","x"]}),uniqueCol:["grantee","grantor"],editable:!1,type:"collection",group:"security",mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection",min_version:90200},{id:"seclabels",label:e("Security labels"),model:a.SecLabelModel,type:"collection",group:"security",mode:["edit","create"],min_version:90100,canAdd:!0,canEdit:!1,canDelete:!0,control:"unique-col-collection",uniqueCol:["provider"]}],validate:function(){var t={},i=null;return(n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(t.name=e("Name cannot be empty."),i=i||t.name),(n.isUndefined(this.get("basensp"))||""==String(this.get("basensp")).replace(/^\s+|\s+$/g,""))&&(t.basensp=e("Schema cannot be empty."),i=i||t.basensp),(n.isUndefined(this.get("ftsrvname"))||""==String(this.get("ftsrvname")).replace(/^\s+|\s+$/g,""))&&(t.ftsrvname=e("Foreign server cannot be empty."),i=i||t.ftsrvname),this.errorModel.clear().set(t),i}})})),a.Nodes.foreign_table}.apply(t,n))||(e.exports=o)},258:function(e,t,i){"use strict";var n,o;i(28),i(8),i(16),i(21),i(36),i(15),i(11),i(5),i(9),i(7),i(37),n=[i(2),i(6),i(0),i(1),i(14),i(3),i(10),i(18),i(30),i(64),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r,s,d,c){var p=l.Browser.Node.Model.extend({defaults:{token:void 0,dictname:void 0},keys:["token"],schema:[{id:"token",label:e("Token"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:!1,cell:"string",url:"tokens"},{id:"dictname",label:e("Dictionaries"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:!0,cell:s.Extension.MultiSelectAjaxCell,url:"dictionaries"}],validate:function(){var t;this.errorModel.clear();var i=this.get("token"),o=this.get("dictname");return n.isNull(i)||n.isUndefined(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(t=e("Token cannot be empty."),this.errorModel.set("token",t),t):n.isNull(o)||n.isUndefined(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(t=e("Dictionary name cannot be empty."),this.errorModel.set("dictname",t),t):null}}),u=r.TokenControl=r.UniqueColCollectionControl.extend({initialize:function(){r.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var t=this,a=[{id:"token",label:"",type:"text",url:"tokens",node:"fts_configuration",canAdd:!0,url_with_id:!0,control:r.NodeAjaxOptionsControl.extend({formatter:r.NodeAjaxOptionsControl.prototype.formatter,initialize:function(){r.NodeAjaxOptionsControl.prototype.initialize.apply(this,arguments);var e=this,t=e.field.get("url")||e.defaults.url,o=e.model.top||e.model;if(t){var a=this.field.get("schema_node"),s=this.field.get("node_info"),d=a.generate_url.apply(a,[null,t,this.field.get("node_data"),this.field.get("url_with_id")||!1,s]),c=this.field.get("cache_level")||a.type,p=this.field.get("cache_node"),u=(p=p&&l.Browser.Nodes[p]||a).cache(t,s,c);this.field.get("version_compatible")&&(n.isUndefined(u)||n.isNull(u))&&(o.trigger("pgadmin:view:fetching",o,e.field),i.ajax({async:!1,url:d}).done((function(e){u=p.cache(t,s,c,e.data)})).fail((function(){o.trigger("pgadmin:view:fetch:error",o,e.field)})),o.trigger("pgadmin:view:fetched",o,e.field)),u=u&&u.data||[];var m=this.field.get("transform")||e.defaults.transform;m&&n.isFunction(m)?e.field.set("options",m.bind(e,u)):e.field.set("options",u)}}}),select2:{allowClear:!0,width:"style",placeholder:e("Select token")},first_empty:!0,disabled:function(){return n.isUndefined(t.model.get("oid"))}}],s={token:null},d=["token","dictname"];t.headerData=new(o.Model.extend({defaults:s,schema:a}))({});var c=r.generateViewSchema(t.field.get("node_info"),t.headerData,"create",t.field.get("schema_node"),t.field.get("node_data")),p=[];n.each(c,(function(e){p=p.concat(e.fields)})),t.headerFields=new r.Fields(p),t.gridSchema=r.generateGridColumnsFromModel(t.field.get("node_info"),t.field.get("model"),"edit",d,t.field.get("schema_node")),t.controls=[],t.listenTo(t.headerData,"change",t.headerDataChanged),t.listenTo(t.headerData,"select2",t.headerDataChanged),t.listenTo(t.collection,"add",t.onAddorRemoveTokens),t.listenTo(t.collection,"remove",t.onAddorRemoveTokens)},generateHeader:function(t){var o=['<div class="subnode-header-form">',' <div class="container-fluid">','  <div class="row">','   <div class="col-3">','    <label class="control-label"><%-token_label%></label>',"   </div>",'   <div class="col-6" header="token"></div>','   <div class="col-2">','     <button class="btn btn-sm-sq btn-secondary add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> ></button>',"   </div>","  </div>"," </div>","</div>"].join("\n");n.extend(t,{token_label:e("Tokens")});var l=this,a=n.template(o),r=i(a(t)),s=this.controls;return l.headerFields.each((function(e){var t=new(e.get("control"))({field:e,model:l.headerData});r.find('div[header="'+e.get("name")+'"]').append(t.render().$el),t.$el.find(".control-label").remove(),s.push(t)})),"properties"==t.mode&&r.find("button.add").remove(),"create"==t.mode&&r.find("button.add").attr("disabled",!0),l.$header=r,r},events:n.extend({},r.UniqueColCollectionControl.prototype.events,{"click button.add":"addTokens"}),showGridControl:function(e){var t=this,o=n.template("<div class='subnode-header'></div>"),l=i("<div></div>",{class:"pgadmin-control-group backgrid form-group col-12 object subnode"}).append(o({label:e.label}));l.append(t.generateHeader(e));var a=n.clone(this.gridSchema.columns);0==e.disabled&&e.canDelete&&a.unshift({name:"pg-backform-delete",label:"",cell:s.Extension.DeleteCell,editable:!1,cell_priority:-1}),t.grid&&(t.grid.remove(),t.grid.null);var r=t.grid=new s.Grid({columns:a,collection:t.collection,className:"backgrid table-bordered"});return t.$grid=r.render().$el,l.append(t.$grid),setTimeout((function(){t.headerData.set({token:t.$header.find('div[header="token"] select').val()},{silent:!0})}),10),l},headerDataChanged:function(){var e=this.headerData.toJSON(),t=n.isEmpty(e)||n.isUndefined(e);this.$header&&this.$header.find("button.add").prop("disabled",t)},addTokens:function(e){e.preventDefault();var t=this.headerData.get("token");if(!t||""==t)return!1;var o=this.model.get(this.field.get("name")),l=new(this.field.get("model"))(this.headerData.toJSON(),{silent:!0,top:this.model.top,collection:o,handler:o}),a=["token"],r=-1;this.collection.each((function(e){n.each(a,(function(i){e.get(i)==t&&(r=o.indexOf(e))}))})),-1==r&&(o.add(l),r=o.indexOf(l)),this.$grid.find(".new").removeClass("new");var s=this.grid.body.rows[r].$el;return s.addClass("new"),i(s).pgMakeVisible("backform-tab"),!1},onAddorRemoveTokens:function(){var e=this;setTimeout((function(){e.collection.trigger("pgadmin:tokens:updated",e.collection),e.headerDataChanged()}),10)},remove:function(){this.stopListening(this.headerData,"change",this.headerDataChanged),this.listenTo(this.headerData,"select2",this.headerDataChanged),this.listenTo(this.collection,"remove",this.onAddorRemoveTokens),n.each(this.controls,(function(e){e.remove()})),u.__super__.remove.apply(this,arguments),delete this.headerData}});return a.Nodes["coll-fts_configuration"]||(l.Browser.Nodes["coll-fts_configuration"]=l.Browser.Collection.extend({node:"fts_configuration",label:e("FTS Configurations"),type:"coll-fts_configuration",columns:["name","description"],canDrop:c.isTreeItemOfChildOfSchema,canDropCascade:c.isTreeItemOfChildOfSchema})),a.Nodes.fts_configuration||(l.Browser.Nodes.fts_configuration=d.SchemaChildNode.extend({type:"fts_configuration",sqlAlterHelp:"sql-altertsconfig.html",sqlCreateHelp:"sql-createtsconfig.html",dialogHelp:t("help.static",{filename:"fts_configuration_dialog.html"}),label:e("FTS Configuration"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_fts_configuration_on_schema",node:"schema",module:this,category:"create",priority:4,applies:["object","context"],callback:"show_obj_properties",label:e("FTS Configuration..."),icon:"wcTabIcon icon-fts_configuration",data:{action:"create"},enable:"canCreate"},{name:"create_fts_configuration_on_coll",module:this,priority:4,node:"coll-fts_configuration",applies:["object","context"],callback:"show_obj_properties",category:"create",label:e("FTS Configuration..."),data:{action:"create"},icon:"wcTabIcon icon-fts_configuration",enable:"canCreate"},{name:"create_fts_configuration",node:"fts_configuration",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Configuration..."),data:{action:"create"},icon:"wcTabIcon icon-fts_configuration",enable:"canCreate"}]))},model:l.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,owner:void 0,description:void 0,schema:void 0,prsname:void 0,copy_config:void 0,tokens:void 0},initialize:function(e,t){var i=0===n.size(e);if(l.Browser.Node.Model.prototype.initialize.apply(this,arguments),i){var o=a.serverInfo[t.node_info.server._id].user;this.set({owner:o.name,schema:t.node_info.schema._id},{silent:!0})}},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",editable:!1,type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",type:"text",mode:["properties","edit","create"],node:"role",control:r.NodeListByNameControl,select2:{allowClear:!1}},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",control:"node-list-by-id",cache_node:"database",cache_level:"database"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"prsname",label:e("Parser"),type:"text",url:"parsers",first_empty:!0,group:e("Definition"),control:"node-ajax-options",deps:["copy_config"],disabled:function(e){var t=e.get("copy_config");return!n.isNull(t)&&!n.isUndefined(t)&&""!==t},readonly:function(e){return!e.isNew()}},{id:"copy_config",label:e("Copy config"),type:"text",mode:["create"],group:e("Definition"),control:"node-ajax-options",url:"copyConfig",deps:["prsname"],disabled:function(e){var t=e.get("prsname");return!n.isNull(t)&&!n.isUndefined(t)&&""!==t},readonly:function(e){return!e.isNew()}},{id:"tokens",label:e("Tokens"),type:"collection",group:e("Tokens"),control:u,model:p,columns:["token","dictionary"],uniqueCol:["token"],mode:["create","edit"],canAdd:!0,canEdit:!1,canDelete:!0}],validate:function(){var t,i=this.get("name"),o=this.get("prsname"),l=""===o||n.isUndefined(o)||n.isNull(o)?this.get("copy_config"):this.get("prsname"),a=this.get("schema");return this.errorModel.clear(),this.trigger("on-status-clear"),n.isUndefined(i)||n.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(t=e("Name must be specified."),this.errorModel.set("name",t),t):n.isUndefined(l)||n.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")?(t=e("Select parser or configuration to copy."),this.errorModel.set("parser",t),t):n.isUndefined(a)||n.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(t=e("Schema must be selected."),this.errorModel.set("schema",t),t):null}})})),a.Nodes["coll-fts_configuration"]}.apply(t,n))||(e.exports=o)},259:function(e,t,i){"use strict";var n,o;i(11),i(5),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(64),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r,s){var d=o.Browser.Node.Model.extend({defaults:{options:void 0,value:void 0},schema:[{id:"option",label:e("Option"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:!0},{id:"value",label:e("Value"),type:"text",group:null,cellHeaderClasses:"width_percent_50",editable:!0}],validate:function(){var t;return(this.errorModel.clear(),n.isUndefined(this.get("option"))||""==String(this.get("option")).replace(/^\s+|\s+$/g,"")?(t=e("Option cannot be empty."),this.errorModel.set("option",t),t):n.isUndefined(this.get("value"))||""==String(this.get("value")).replace(/^\s+|\s+$/g,"")?(t=e("Value cannot be empty."),this.errorModel.set("value",t),t):t)}});return l.Nodes["coll-fts_dictionary"]||(o.Browser.Nodes["coll-fts_dictionary"]=o.Browser.Collection.extend({node:"fts_dictionary",label:e("FTS Dictionaries"),type:"coll-fts_dictionary",columns:["name","description"],canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})),l.Nodes.fts_dictionary||(o.Browser.Nodes.fts_dictionary=r.SchemaChildNode.extend({type:"fts_dictionary",sqlAlterHelp:"sql-altertsdictionary.html",sqlCreateHelp:"sql-createtsdictionary.html",dialogHelp:t("help.static",{filename:"fts_dictionary_dialog.html"}),label:e("FTS Dictionary"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_fts_dictionary_on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Dictionary..."),icon:"wcTabIcon icon-fts_dictionary",data:{action:"create"},enable:"canCreate"},{name:"create_fts_dictionary_on_coll",node:"coll-fts_dictionary",module:this,applies:["object","context"],priority:4,callback:"show_obj_properties",category:"create",label:e("FTS Dictionary..."),data:{action:"create"},icon:"wcTabIcon icon-fts_dictionary",enable:"canCreate"},{name:"create_fts_dictionary",node:"fts_dictionary",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Dictionary..."),icon:"wcTabIcon icon-fts_dictionary",data:{action:"create"},enable:"canCreate"}]))},model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,owner:void 0,description:void 0,schema:void 0,template:void 0,options:void 0},initialize:function(e,t){var i=0===n.size(e);if(o.Browser.Node.Model.prototype.initialize.apply(this,arguments),i){var a=l.serverInfo[t.node_info.server._id].user;this.set({owner:a.name,schema:t.node_info.schema._id},{silent:!0})}},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",editable:!1,type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",type:"text",mode:["properties","edit","create"],node:"role",control:a.NodeListByNameControl},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",cache_node:"database",control:"node-list-by-id"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"template",label:e("Template"),type:"text",readonly:function(e){return!e.isNew()},url:"fetch_templates",group:e("Definition"),control:"node-ajax-options",cache_node:"fts_template"},{id:"options",label:e("Option"),type:"collection",group:e("Options"),control:"unique-col-collection",model:d,columns:["option","value"],uniqueCol:["option"],mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:!0}],validate:function(){var t,i=this.get("name"),o=this.get("template"),l=this.get("schema");return n.isUndefined(i)||n.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(t=e("Name must be specified."),this.errorModel.set("name",t),t):n.isUndefined(o)||n.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(t=e("Template must be selected."),this.errorModel.set("template",t),t):n.isUndefined(l)||n.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")?(t=e("Schema must be selected."),this.errorModel.set("schema",t),t):(this.errorModel.clear(),this.trigger("on-status-clear"),null)}})})),l.Nodes.fts_dictionary}.apply(t,n))||(e.exports=o)},260:function(e,t,i){"use strict";var n,o;i(5),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(64),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r){return l.Nodes["coll-fts_parser"]||(o.Browser.Nodes["coll-fts_parser"]=o.Browser.Collection.extend({node:"fts_parser",label:e("FTS Parsers"),type:"coll-fts_parser",columns:["name","description"],canDrop:r.isTreeItemOfChildOfSchema,canDropCascade:r.isTreeItemOfChildOfSchema})),l.Nodes.fts_parser||(o.Browser.Nodes.fts_parser=a.SchemaChildNode.extend({type:"fts_parser",sqlAlterHelp:"sql-altertsparser.html",sqlCreateHelp:"sql-createtsparser.html",dialogHelp:t("help.static",{filename:"fts_parser_dialog.html"}),label:e("FTS Parser"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_fts_parser_on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Parser..."),icon:"wcTabIcon icon-fts_parser",data:{action:"create"},enable:"canCreate"},{name:"create_fts_parser_on_coll",node:"coll-fts_parser",applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Parser..."),icon:"wcTabIcon icon-fts_parser",data:{action:"create"},module:this,enable:"canCreate"},{name:"create_fts_parser",node:"fts_parser",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Parser..."),icon:"wcTabIcon icon-fts_parser",data:{action:"create"},enable:"canCreate"}]))},model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,description:void 0,schema:void 0,prsstart:void 0,prstoken:void 0,prsend:void 0,prslextype:void 0,prsheadline:void 0},initialize:function(e,t){var i=0===n.size(e);o.Browser.Node.Model.prototype.initialize.apply(this,arguments),i&&this.set("schema",t.node_info.schema._id)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",editable:!1,type:"text",mode:["properties"]},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",control:"node-list-by-id",cache_node:"database",cache_level:"database"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"prsstart",label:e("Start function"),type:"text",readonly:function(e){return!e.isNew()},control:"node-ajax-options",url:"start_functions",group:e("Definition"),cache_level:"database",cache_node:"schema"},{id:"prstoken",label:e("Get next token function"),type:"text",readonly:function(e){return!e.isNew()},control:"node-ajax-options",url:"token_functions",group:e("Definition"),cache_level:"database",cache_node:"schema"},{id:"prsend",label:e("End function"),type:"text",readonly:function(e){return!e.isNew()},control:"node-ajax-options",url:"end_functions",group:e("Definition"),cache_level:"database",cache_node:"schema"},{id:"prslextype",label:e("Lextypes function"),type:"text",readonly:function(e){return!e.isNew()},control:"node-ajax-options",url:"lextype_functions",group:e("Definition"),cache_level:"database",cache_node:"schema"},{id:"prsheadline",label:e("Headline function"),type:"text",readonly:function(e){return!e.isNew()},control:"node-ajax-options",url:"headline_functions",group:e("Definition"),cache_level:"database",cache_node:"schema"}],validate:function(){var t,i=this.get("name"),o=this.get("prsstart"),l=this.get("prstoken"),a=this.get("prsend"),r=this.get("prslextype"),s=this.get("schema");return n.isUndefined(i)||n.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(t=e("Name must be specified."),this.errorModel.set("name",t),t):n.isUndefined(o)||n.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(t=e("Start function must be selected."),this.errorModel.set("prsstart",t),t):n.isUndefined(l)||n.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")?(t=e("Get next token function must be selected."),this.errorModel.set("prstoken",t),t):n.isUndefined(a)||n.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(t=e("End function must be selected."),this.errorModel.set("prsend",t),t):n.isUndefined(r)||n.isNull(r)||""==String(r).replace(/^\s+|\s+$/g,"")?(t=e("Lextype function must be selected."),this.errorModel.set("prslextype",t),t):n.isUndefined(s)||n.isNull(s)||""==String(s).replace(/^\s+|\s+$/g,"")?(t=e("Schema must be selected."),this.errorModel.set("schema",t),t):(this.errorModel.clear(),this.trigger("on-status-clear"),null)}})})),l.Nodes["coll-fts_parser"]}.apply(t,n))||(e.exports=o)},261:function(e,t,i){"use strict";var n,o;i(5),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(64),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r){return l.Nodes["coll-fts_template"]||(o.Browser.Nodes["coll-fts_template"]=o.Browser.Collection.extend({node:"fts_template",label:e("FTS Templates"),type:"coll-fts_template",columns:["name","description"],canDrop:r.isTreeItemOfChildOfSchema,canDropCascade:r.isTreeItemOfChildOfSchema})),l.Nodes.fts_template||(o.Browser.Nodes.fts_template=a.SchemaChildNode.extend({type:"fts_template",sqlAlterHelp:"sql-altertstemplate.html",sqlCreateHelp:"sql-createtstemplate.html",dialogHelp:t("help.static",{filename:"fts_template_dialog.html"}),label:e("FTS Template"),hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_fts_template_on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Template..."),icon:"wcTabIcon icon-fts_template",data:{action:"create"},enable:"canCreate"},{name:"create_fts_template_on_coll",node:"coll-fts_template",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Template..."),icon:"wcTabIcon icon-fts_template",data:{action:"create"},enable:"canCreate"},{name:"create_fts_template",node:"fts_template",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("FTS Template..."),icon:"wcTabIcon icon-fts_template",data:{action:"create"},enable:"canCreate"}]))},model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,description:void 0,schema:void 0,tmplinit:void 0,tmpllexize:void 0},initialize:function(e,t){var i=0===n.size(e);o.Browser.Node.Model.prototype.initialize.apply(this,arguments),i&&this.set("schema",t.node_info.schema._id)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",editable:!1,type:"text",mode:["properties"]},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",control:"node-list-by-id",cache_node:"database",cache_level:"database"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",cellHeaderClasses:"width_percent_50"},{id:"tmplinit",label:e("Init function"),group:e("Definition"),type:"text",readonly:function(e){return!e.isNew()},control:"node-ajax-options",url:"get_init",cache_level:"database",cache_node:"schema"},{id:"tmpllexize",label:e("Lexize function"),group:e("Definition"),type:"text",readonly:function(e){return!e.isNew()},control:"node-ajax-options",url:"get_lexize",cache_level:"database",cache_node:"schema"}],validate:function(){var t,i=this.get("name"),o=this.get("tmpllexize"),l=this.get("schema");return n.isUndefined(i)||n.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(t=e("Name must be specified."),this.errorModel.set("name",t),t):n.isUndefined(o)||n.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(t=e("Lexize function must be selected."),this.errorModel.set("tmpllexize",t),t):n.isUndefined(l)||n.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")?(t=e("Schema must be selected."),this.errorModel.set("schema",t),t):(this.errorModel.clear(),this.trigger("on-status-clear"),null)}})})),l.Nodes.fts_template}.apply(t,n))||(e.exports=o)},262:function(e,t,i){"use strict";var n,o;i(11),i(5),i(9),i(7),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(48),i(196),i(64),i(45),i(25),i(67)],void 0===(o=function(e,t,i,n,o,l,a,r,s,d){return l.Nodes["coll-procedure"]||(o.Browser.Nodes["coll-procedure"]=o.Browser.Collection.extend({node:"procedure",label:e("Procedures"),type:"coll-procedure",columns:["name","funcowner","description"],hasStatistics:!0,canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema})),l.Nodes.procedure||(o.Browser.Nodes.procedure=s.SchemaChildNode.extend({type:"procedure",sqlAlterHelp:"sql-alterprocedure.html",sqlCreateHelp:"sql-createprocedure.html",dialogHelp:t("help.static",{filename:"procedure_dialog.html"}),label:e("Procedure"),collection_type:"coll-procedure",hasSQL:!0,hasDepends:!0,hasStatistics:!0,hasScriptTypes:["create","exec"],width:l.stdW.md+"px",Init:function(){this.proc_initialized||(this.proc_initialized=!0,l.add_menus([{name:"create_procedure_on_coll",node:"coll-procedure",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Procedure..."),icon:"wcTabIcon icon-procedure",data:{action:"create",check:!1},enable:"canCreateProc"},{name:"create_procedure",node:"procedure",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Procedure..."),icon:"wcTabIcon icon-procedure",data:{action:"create",check:!0},enable:"canCreateProc"},{name:"create_procedure",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Procedure..."),icon:"wcTabIcon icon-procedure",data:{action:"create",check:!0},enable:"canCreateProc"}]))},canCreateProc:function(e,t){var i=this.getTreeNodeHierarchy.apply(this,[t]);return!("catalog"in i)&&("server"in i&&("ppas"==i.server.server_type||"pg"==i.server.server_type&&i.server.version>=11e4))},model:r.model.extend({defaults:n.extend({},r.model.prototype.defaults,{lanname:"edbspl"}),canVarAdd:function(){return!(this.node_info.server.version<90500)},isVisible:function(){return"sysfunc"!=this.name&&"sysproc"==this.name},isDisabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;switch(this.name){case"provolatile":case"proisstrict":case"procost":case"proleakproof":return(this.node_info.server.version<90500||"ppas"!=this.node_info.server.server_type||"edbspl"!=e.get("lanname"))&&(setTimeout((function(){e.set("provolatile",void 0),e.set("proisstrict",void 0),e.set("procost",void 0),e.set("proleakproof",void 0)}),10),!0);case"variables":case"prosecdef":return this.node_info.server.version<90500;case"prorows":return!(this.node_info.server.version>=90500&&1==e.get("proretset"));case"proparallel":return(this.node_info.server.version<90600||"ppas"!=this.node_info.server.server_type||"edbspl"!=e.get("lanname"))&&(setTimeout((function(){e.set("proparallel",void 0)}),10),!0);case"lanname":return this.node_info.server.version<11e4;default:return!1}},validate:function(){var t,i={},o=this.get("seclabels");if((n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(i.name=e("Name cannot be empty."),t=t||i.name),(n.isUndefined(this.get("pronamespace"))||""==String(this.get("pronamespace")).replace(/^\s+|\s+$/g,""))&&(i.pronamespace=e("Schema cannot be empty."),t=t||i.pronamespace),(n.isUndefined(this.get("lanname"))||""==String(this.get("lanname")).replace(/^\s+|\s+$/g,""))&&(i.lanname=e("Language cannot be empty."),t=t||i.lanname),"c"==String(this.get("lanname"))?((n.isUndefined(this.get("probin"))||""==String(this.get("probin")).replace(/^\s+|\s+$/g,""))&&(i.probin=e("Object File cannot be empty."),t=t||i.probin),(n.isUndefined(this.get("prosrc_c"))||""==String(this.get("prosrc_c")).replace(/^\s+|\s+$/g,""))&&(i.prosrc_c=e("Link Symbol cannot be empty."),t=t||i.prosrc_c)):(n.isUndefined(this.get("prosrc"))||""==String(this.get("prosrc")).replace(/^\s+|\s+$/g,""))&&(i.prosrc=e("Code cannot be empty."),t=t||i.prosrc),o)for(var l,a=0;a<o.models.length&&!l;a++)(l=o.models[a].validate.apply(o.models[a]))&&(i.seclabels=l,t=t||l);return this.errorModel.clear().set(i),null}})})),l.Nodes.procedure}.apply(t,n))||(e.exports=o)},263:function(e,t,i){"use strict";var n,o;i(11),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(197),i(25),i(67)],void 0===(o=function(e,t,i,n,o,l,a){return l.Nodes["coll-edbproc"]||(o.Browser.Nodes["coll-edbproc"]=o.Browser.Collection.extend({node:"edbproc",label:e("Procedures"),type:"coll-edbproc",columns:["name","funcowner","description"],hasStatistics:!0,canDrop:!1,canDropCascade:!1})),l.Nodes.edbproc||(o.Browser.Nodes.edbproc=l.Node.extend({type:"edbproc",dialogHelp:t("help.static",{filename:"edbproc_dialog.html"}),label:e("Procedure"),collection_type:"coll-edbproc",hasDepends:!0,canEdit:!1,hasSQL:!0,hasScriptTypes:[],parent_type:["package"],Init:function(){this.proc_initialized||(this.proc_initialized=!0)},canDrop:!1,canDropCascade:!1,model:a.model.extend({defaults:n.extend({},a.model.prototype.defaults,{lanname:"edbspl"}),isVisible:function(){return"sysfunc"!=this.name&&"sysproc"==this.name},validate:function(){return null}})})),l.Nodes.edbproc}.apply(t,n))||(e.exports=o)},264:function(e,t,i){"use strict";var n,o;n=[i(2),i(6),i(0),i(1),i(3),i(10),i(25),i(67)],void 0===(o=function(e,t,i,n,o,l){return l.Nodes["coll-edbvar"]||(l.Nodes["coll-edbvar"]=l.Collection.extend({node:"edbvar",label:e("Variables"),type:"coll-edbvar",columns:["name","funcowner","description"],canDrop:!1,canDropCascade:!1})),l.Nodes.edbvar||(l.Nodes.edbvar=l.Node.extend({type:"edbvar",dialogHelp:t("help.static",{filename:"edbvar_dialog.html"}),label:e("Function"),collection_type:"coll-edbvar",canEdit:!1,hasSQL:!0,hasScriptTypes:[],parent_type:["package"],Init:function(){this.initialized||(this.initialized=!0)},canDrop:!1,canDropCascade:!1,model:l.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,datatype:void 0,visibility:"Unknown"},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties"]},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"datatype",label:e("Data type"),cell:"string",type:"text",readonly:!0},{id:"visibility",label:e("Visibility"),cell:"string",type:"text",mode:["properties"]}],validate:function(){return null}})})),l.Nodes.edbvar}.apply(t,n))||(e.exports=o)},265:function(e,t,i){"use strict";var n,o;i(11),i(5),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(64),i(45),i(25),i(67)],void 0===(o=function(e,t,i,n,o,l,a,r,s){return l.Nodes["coll-trigger_function"]||(l.Nodes["coll-trigger_function"]=l.Collection.extend({node:"trigger_function",label:e("Trigger functions"),type:"coll-trigger_function",columns:["name","funcowner","description"],hasStatistics:!0,canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})),l.Nodes.trigger_function||(l.Nodes.trigger_function=r.SchemaChildNode.extend({type:"trigger_function",sqlAlterHelp:"plpgsql-trigger.html",sqlCreateHelp:"plpgsql-trigger.html",dialogHelp:t("help.static",{filename:"trigger_function_dialog.html"}),label:e("Trigger function"),collection_type:"coll-trigger_function",hasSQL:!0,hasDepends:!0,hasStatistics:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_trigger_function_on_coll",node:"coll-trigger_function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger function..."),icon:"wcTabIcon icon-trigger_function",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger_function",node:"trigger_function",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger function..."),icon:"wcTabIcon icon-trigger_function",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger_function",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger function..."),icon:"wcTabIcon icon-trigger_function",data:{action:"create",check:!1},enable:"canCreate"}]))},model:l.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){var i=0===n.size(e);if(i){var o=t.node_info.schema._id;this.set({pronamespace:o},{silent:!0});var a=l.serverInfo[t.node_info.server._id].user;this.set({funcowner:a.name},{silent:!0})}l.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{name:void 0,oid:void 0,xmin:void 0,funcowner:void 0,pronamespace:void 0,description:void 0,pronargs:void 0,proargs:void 0,proargtypenames:void 0,prorettypename:"trigger",lanname:"plpgsql",provolatile:void 0,proretset:void 0,proisstrict:void 0,prosecdef:void 0,proiswindow:void 0,procost:void 0,prorows:void 0,proleakproof:void 0,args:[],prosrc:void 0,prosrc_c:void 0,probin:"$libdir/",options:[],variables:[],proacl:void 0,seclabels:[],acl:[],sysfunc:void 0,sysproc:void 0},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"isDisabled",readonly:"isReadonly"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"funcowner",label:e("Owner"),cell:"string",control:a.NodeListByNameControl,node:"role",type:"text",disabled:"isDisabled",readonly:"isReadonly"},{id:"pronamespace",label:e("Schema"),cell:"string",control:"node-list-by-id",type:"text",cache_level:"database",node:"schema",disabled:"isDisabled",readonly:"isReadonly",mode:["create","edit"]},{id:"sysfunc",label:e("System function?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"sysproc",label:e("System procedure?"),cell:"boolean",type:"switch",mode:["properties"],visible:"isVisible"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",disabled:"isDisabled",readonly:"isReadonly"},{id:"pronargs",label:e("Argument count"),cell:"string",type:"text",group:e("Definition"),mode:["properties"]},{id:"proargs",label:e("Arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties","edit"],disabled:"isDisabled",readonly:"isReadonly"},{id:"proargtypenames",label:e("Signature arguments"),cell:"string",type:"text",group:e("Definition"),mode:["properties"],disabled:"isDisabled",readonly:"isReadonly"},{id:"prorettypename",label:e("Return type"),cell:"string",control:"select2",type:"text",group:e("Definition"),disabled:"isDisabled",readonly:"isReadonly",first_empty:!0,select2:{width:"100%",allowClear:!1},mode:["create"],visible:"isVisible",options:[{label:e("trigger"),value:"trigger"},{label:e("event_trigger"),value:"event_trigger"}]},{id:"prorettypename",label:e("Return type"),cell:"string",type:"text",group:e("Definition"),mode:["properties","edit"],disabled:"isDisabled",readonly:"isReadonly",visible:"isVisible"},{id:"lanname",label:e("Language"),cell:"string",control:"node-ajax-options",type:"text",group:e("Definition"),url:"get_languages",disabled:"isDisabled",readonly:"isReadonly",transform:function(e){return n.reject(e,(function(e){return"sql"==e.label||"edbspl"==e.label}))},select2:{allowClear:!1}},{id:"prosrc",label:e("Code"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Code"),deps:["lanname"],tabPanelCodeClass:"sql-code-control",control:a.SqlCodeControl,visible:function(e){return"c"!=e.get("lanname")},disabled:"isDisabled",readonly:"isReadonly"},{id:"probin",label:e("Object file"),cell:"string",type:"text",group:e("Definition"),deps:["lanname"],visible:function(e){return"c"==e.get("lanname")},disabled:"isDisabled",readonly:"isReadonly"},{id:"prosrc_c",label:e("Link symbol"),cell:"string",type:"text",group:e("Definition"),deps:["lanname"],visible:function(e){return"c"==e.get("lanname")},disabled:"isDisabled",readonly:"isReadonly"},{id:"provolatile",label:e("Volatility"),cell:"string",control:"node-ajax-options",type:"text",group:e("Options"),options:[{label:"VOLATILE",value:"v"},{label:"STABLE",value:"s"},{label:"IMMUTABLE",value:"i"}],disabled:"isDisabled",readonly:"isReadonly",select2:{allowClear:!1}},{id:"proretset",label:e("Returns a set?"),type:"switch",group:e("Options"),disabled:"isDisabled",readonly:"isReadonly",visible:"isVisible"},{id:"proisstrict",label:e("Strict?"),type:"switch",disabled:"isDisabled",readonly:"isReadonly",group:e("Options")},{id:"prosecdef",label:e("Security of definer?"),group:e("Options"),cell:"boolean",type:"switch",disabled:"isDisabled",readonly:"isReadonly"},{id:"proiswindow",label:e("Window?"),group:e("Options"),cell:"boolean",type:"switch",disabled:"isDisabled",readonly:"isReadonly",visible:"isVisible"},{id:"procost",label:e("Estimated cost"),type:"text",group:e("Options"),disabled:"isDisabled",readonly:"isReadonly"},{id:"prorows",label:e("Estimated rows"),type:"text",group:e("Options"),disabled:"isDisabled",readonly:"isReadonly",deps:["proretset"],visible:"isVisible"},{id:"proleakproof",label:e("Leak proof?"),group:e("Options"),cell:"boolean",type:"switch",min_version:90200,disabled:"isDisabled",readonly:"isReadonly"},l.SecurityGroupSchema,{id:"proacl",label:e("Privileges"),mode:["properties"],group:e("Security"),type:"text"},{id:"variables",label:"",type:"collection",group:e("Parameters"),control:"variable-collection",model:l.Node.VariableModel,mode:["edit","create"],canAdd:"canVarAdd",canEdit:!1,canDelete:!0,disabled:"isDisabled",readonly:"isReadonly"},{id:"acl",label:e("Privileges"),editable:!1,type:"collection",group:"security",mode:["edit","create"],model:l.Node.PrivilegeRoleModel.extend({privileges:["X"]}),uniqueCol:["grantee","grantor"],disabled:"isDisabled",readonly:"isReadonly",canAdd:!0,canDelete:!0,control:"unique-col-collection"},{id:"seclabels",label:e("Security labels"),canEdit:!0,model:l.SecLabelModel,type:"collection",min_version:90100,group:"security",mode:["edit","create"],canDelete:!0,control:"unique-col-collection",canAdd:!0,uniqueCol:["provider"],disabled:"isDisabled",readonly:"isReadonly"}],validate:function(t){var i,o={},l=this.get("seclabels");if(t&&0==t.length)return this.errorModel.clear(),null;if((n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))&&(o.name=e("Name cannot be empty."),i=i||o.name),(n.isUndefined(this.get("funcowner"))||""==String(this.get("funcowner")).replace(/^\s+|\s+$/g,""))&&(o.funcowner=e("Owner cannot be empty."),i=i||o.funcowner),(n.isUndefined(this.get("pronamespace"))||""==String(this.get("pronamespace")).replace(/^\s+|\s+$/g,""))&&(o.pronamespace=e("Schema cannot be empty."),i=i||o.pronamespace),(n.isUndefined(this.get("prorettypename"))||""==String(this.get("prorettypename")).replace(/^\s+|\s+$/g,""))&&(o.prorettypename=e("Return type cannot be empty."),i=i||o.prorettypename),(n.isUndefined(this.get("lanname"))||""==String(this.get("lanname")).replace(/^\s+|\s+$/g,""))&&(o.lanname=e("Language cannot be empty."),i=i||o.lanname),"c"==String(this.get("lanname"))?((n.isUndefined(this.get("probin"))||""==String(this.get("probin")).replace(/^\s+|\s+$/g,""))&&(o.probin=e("Object File cannot be empty."),i=i||o.probin),(n.isUndefined(this.get("prosrc_c"))||""==String(this.get("prosrc_c")).replace(/^\s+|\s+$/g,""))&&(o.prosrc_c=e("Link Symbol cannot be empty."),i=i||o.prosrc_c)):(n.isUndefined(this.get("prosrc"))||""==String(this.get("prosrc")).replace(/^\s+|\s+$/g,""))&&(o.prosrc=e("Code cannot be empty."),i=i||o.prosrc),l)for(var a,r=0;r<l.models.length&&!a;r++)(a=l.models[r].validate.apply(l.models[r]))&&(o.seclabels=a,i=i||a);return this.errorModel.clear().set(o),n.size(o)?(this.trigger("on-status",{msg:i}),i):null},isVisible:function(){return"sysproc"!=this.name},isReadonly:function(e){switch(this.name){case"proargs":case"proargtypenames":case"prorettypename":case"proretset":case"proiswindow":return!e.isNew();default:return!1}},isDisabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;switch(this.name){case"prorows":return 1!=e.get("proretset");default:return!1}},canVarAdd:function(){return!(this.node_info&&"catalog"in this.node_info)}})})),l.Nodes.trigger_function}.apply(t,n))||(e.exports=o)},266:function(e,t,i){"use strict";var n,o;i(11),i(5),i(59),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(64),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r,s){return l.Nodes["coll-package"]||(l.Nodes["coll-package"]=l.Collection.extend({node:"package",label:e("Packages"),type:"coll-package",columns:["name","owner","description"],canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})),l.Nodes.package||(l.Nodes.package=r.SchemaChildNode.extend({type:"package",dialogHelp:t("help.static",{filename:"package_dialog.html"}),label:e("Package"),collection_type:"coll-package",hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_package_on_coll",node:"coll-package",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Package..."),icon:"wcTabIcon icon-package",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_package",node:"package",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Package..."),icon:"wcTabIcon icon-package",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_package",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Package..."),icon:"wcTabIcon icon-package",data:{action:"create",check:!0},enable:"canCreate"}]))},canCreate:function(e,t,i){if(i&&0==i.check)return!0;var n=this.getTreeNodeHierarchy(t),o=n.server;return(!o||"pg"!==o.server_type)&&null==n.catalog},model:l.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,owner:void 0,is_sys_object:void 0,description:void 0,pkgheadsrc:void 0,pkgbodysrc:void 0,acl:void 0,pkgacl:[]},initialize:function(e,t){if(0===n.size(e)){var i=l.serverInfo[t.node_info.server._id].user,a=t.node_info.schema;this.set({owner:i.name,schema:a._label},{silent:!0})}o.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],readonly:function(e){return!e.isNew()}},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],readonly:!0,editable:!1,visible:function(e){return!e.isNew()}},{id:"schema",label:e("Schema"),type:"text",node:"schema",control:"node-list-by-name",readonly:function(e){return!e.isNew()},filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database"},{id:"is_sys_object",label:e("System package?"),cell:"boolean",type:"switch",mode:["properties"]},{id:"description",label:e("Comment"),type:"multiline",mode:["properties","create","edit"]},{id:"pkgheadsrc",label:e("Header"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Header"),tabPanelCodeClass:"sql-code-control",control:a.SqlCodeControl},{id:"pkgbodysrc",label:e("Body"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Body"),tabPanelCodeClass:"sql-code-control",control:a.SqlCodeControl},{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"]},{id:"pkgacl",label:e("Privileges"),type:"collection",model:l.Node.PrivilegeRoleModel.extend({privileges:["X"]}),uniqueCol:["grantee","grantor"],editable:!1,group:e("Security"),mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection"}],validate:function(){var t=void 0;return this.errorModel.clear(),n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Name cannot be empty."),this.errorModel.set("name",t),t):n.isUndefined(this.get("pkgheadsrc"))||""==String(this.get("pkgheadsrc")).replace(/^\s+|\s+$/g,"")?(t=e("Header cannot be empty."),this.errorModel.set("pkgheadsrc",t),t):null}})})),l.Nodes.package}.apply(t,n))||(e.exports=o)},267:function(e,t,i){"use strict";var n,o;i(11),i(35),i(5),i(59),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(64),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r,s){return l.Nodes["coll-sequence"]||(l.Nodes["coll-sequence"]=l.Collection.extend({node:"sequence",label:e("Sequences"),type:"coll-sequence",columns:["name","seqowner","comment"],hasStatistics:!0,canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})),l.Nodes.sequence||(l.Nodes.sequence=r.SchemaChildNode.extend({type:"sequence",sqlAlterHelp:"sql-altersequence.html",sqlCreateHelp:"sql-createsequence.html",dialogHelp:t("help.static",{filename:"sequence_dialog.html"}),label:e("Sequence"),collection_type:"coll-sequence",hasSQL:!0,hasDepends:!0,hasStatistics:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_sequence_on_coll",node:"coll-sequence",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Sequence..."),icon:"wcTabIcon icon-sequence",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_sequence",node:"sequence",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Sequence..."),icon:"wcTabIcon icon-sequence",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_sequence",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Sequence..."),icon:"wcTabIcon icon-sequence",data:{action:"create",check:!1},enable:"canCreate"}]))},model:l.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,seqowner:void 0,schema:void 0,comment:void 0,increment:void 0,start:void 0,current_value:void 0,minimum:void 0,maximum:void 0,cache:void 0,cycled:void 0,relacl:[],securities:[]},initialize:function(e,t){var i=0===n.size(e);if(i){var o=l.serverInfo[t.node_info.server._id].user,a=t.node_info.schema;this.set({seqowner:o.name},{silent:!0}),this.set({schema:a._label},{silent:!0})}l.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"]},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"seqowner",label:e("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],node:"role",control:a.NodeListByNameControl},{id:"schema",label:e("Schema"),cell:"string",control:"node-list-by-name",node:"schema",type:"text",mode:["create","edit"],filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database"},{id:"comment",label:e("Comment"),type:"multiline",mode:["properties","create","edit"]},{id:"current_value",label:e("Current value"),type:"int",mode:["properties","edit"],group:e("Definition")},{id:"increment",label:e("Increment"),type:"int",mode:["properties","create","edit"],group:e("Definition")},{id:"start",label:e("Start"),type:"int",mode:["properties","create"],group:e("Definition"),readonly:function(e){return!e.isNew()}},{id:"minimum",label:e("Minimum"),type:"int",mode:["properties","create","edit"],group:e("Definition")},{id:"maximum",label:e("Maximum"),type:"int",mode:["properties","create","edit"],group:e("Definition")},{id:"cache",label:e("Cache"),type:"int",mode:["properties","create","edit"],group:e("Definition"),min:1},{id:"cycled",label:e("Cycled"),type:"switch",mode:["properties","create","edit"],group:e("Definition")},l.SecurityGroupSchema,{id:"acl",label:e("Privileges"),type:"text",group:e("Security"),mode:["properties"]},{id:"relacl",label:e("Privileges"),group:"security",model:l.Node.PrivilegeRoleModel.extend({privileges:["r","w","U"]}),uniqueCol:["grantee","grantor"],mode:["edit","create"],editable:!1,type:"collection",canAdd:!0,canDelete:!0,control:"unique-col-collection"},{id:"securities",label:e("Security labels"),canAdd:!0,model:l.SecLabelModel,editable:!1,type:"collection",canEdit:!1,group:"security",mode:["edit","create"],canDelete:!0,control:"unique-col-collection",min_version:90200,uniqueCol:["provider"]}],validate:function(){var t=void 0,i=this.get("minimum"),o=this.get("maximum"),l=this.get("start");if(n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))return t=e("Name cannot be empty."),this.errorModel.set("name",t),t;if(this.errorModel.unset("name"),n.isUndefined(this.get("seqowner"))||""==String(this.get("seqowner")).replace(/^\s+|\s+$/g,""))return t=e("Owner cannot be empty."),this.errorModel.set("seqowner",t),t;if(this.errorModel.unset("seqowner"),n.isUndefined(this.get("schema"))||""==String(this.get("schema")).replace(/^\s+|\s+$/g,""))return t=e("Schema cannot be empty."),this.errorModel.set("schema",t),t;if(this.errorModel.unset("schema"),!this.isNew()){if(n.isUndefined(this.get("current_value"))||""==String(this.get("current_value")).replace(/^\s+|\s+$/g,""))return t=e("Current value cannot be empty."),this.errorModel.set("current_value",t),t;if(this.errorModel.unset("current_value"),n.isUndefined(this.get("increment"))||""==String(this.get("increment")).replace(/^\s+|\s+$/g,""))return t=e("Increment value cannot be empty."),this.errorModel.set("increment",t),t;if(this.errorModel.unset("increment"),n.isUndefined(this.get("minimum"))||""==String(this.get("minimum")).replace(/^\s+|\s+$/g,""))return t=e("Minimum value cannot be empty."),this.errorModel.set("minimum",t),t;if(this.errorModel.unset("minimum"),n.isUndefined(this.get("maximum"))||""==String(this.get("maximum")).replace(/^\s+|\s+$/g,""))return t=e("Maximum value cannot be empty."),this.errorModel.set("maximum",t),t;if(this.errorModel.unset("maximum"),n.isUndefined(this.get("cache"))||""==String(this.get("cache")).replace(/^\s+|\s+$/g,""))return t=e("Cache value cannot be empty."),this.errorModel.set("cache",t),t;this.errorModel.unset("cache")}var a=e("Minimum value must be less than maximum value."),r=e("Start value cannot be less than minimum value."),s=e("Start value cannot be greater than maximum value.");return n.isEmpty(i)||n.isEmpty(o)?null:0==i&&0==o||parseInt(i,10)>=parseInt(o,10)?(this.errorModel.set("minimum",a),a):(this.errorModel.unset("minimum"),l&&i&&parseInt(l)<parseInt(i)?(this.errorModel.set("start",r),r):(this.errorModel.unset("start"),l&&o&&parseInt(l)>parseInt(o)?(this.errorModel.set("start",s),s):(this.errorModel.unset("start"),null)))}})})),l.Nodes.sequence}.apply(t,n))||(e.exports=o)},268:function(e,t,i){"use strict";var n,o;i(16),i(11),i(5),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(13),i(64),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r,s){return l.Nodes["coll-synonym"]||(o.Browser.Nodes["coll-synonym"]=o.Browser.Collection.extend({node:"synonym",label:e("Synonyms"),type:"coll-synonym",columns:["name","owner","is_public_synonym"],canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})),l.Nodes.synonym||(o.Browser.Nodes.synonym=r.SchemaChildNode.extend({type:"synonym",dialogHelp:t("help.static",{filename:"synonym_dialog.html"}),label:e("Synonym"),collection_type:"coll-synonym",hasSQL:!0,hasDepends:!0,parent_type:["schema","catalog"],Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_synonym_on_coll",node:"coll-synonym",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Synonym..."),icon:"wcTabIcon icon-synonym",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_synonym",node:"synonym",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Synonym..."),icon:"wcTabIcon icon-synonym",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_synonym",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Synonym..."),icon:"wcTabIcon icon-synonym",data:{action:"create",check:!0},enable:"canCreate"}]))},model:o.Browser.Node.Model.extend({isNew:function(){return!this.fetchFromServer},idAttribute:"name",initialize:function(e,t){var i=0===n.size(e);if(i){var a=l.serverInfo[t.node_info.server._id].user,r=t.node_info.schema;this.set({owner:a.name,synobjschema:r._label,schema:r._label,targettype:"r"},{silent:!0})}else this.fetchFromServer=!0;o.Browser.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchema",readonly:function(e){return!e.isNew()}},{id:"owner",label:e("Owner"),cell:"string",type:"text",mode:["properties","create","edit"],readonly:!0,control:"node-list-by-name",node:"role",visible:!1},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["properties","create","edit"],readonly:function(e){return!e.isNew()},node:"schema",control:"node-list-by-name",cache_node:"database",cache_level:"database"},{id:"targettype",label:e("Target type"),cell:"string",disabled:"inSchema",group:e("Definition"),select2:{width:"50%",allowClear:!1},options:function(){return[{label:e("Function"),value:"f"},{label:e("Package"),value:"P"},{label:e("Procedure"),value:"p"},{label:e("Public Synonym"),value:"s"},{label:e("Sequence"),value:"S"},{label:e("Table"),value:"r"},{label:e("View"),value:"v"}]},control:"select2"},{id:"synobjschema",label:e("Target schema"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Definition"),deps:["targettype"],select2:{allowClear:!1},control:"node-list-by-name",node:"schema",filter:function(e){return e&&-1==n.indexOf(["pg_catalog","sys","dbo","pgagent","information_schema","dbms_job_procedure"],e.label)},disabled:function(e){return!!e.inSchema.apply(this,[e])||!!("s"==e.get("targettype"))&&(e.set("synobjschema","public",{silent:!0}),!0)}},{id:"synobjname",label:e("Target object"),cell:"string",type:"text",disabled:"inSchema",group:e("Definition"),deps:["targettype","synobjschema"],control:"node-ajax-options",options:function(e){var t=e.model.get("targettype"),n=e.model.get("synobjschema"),o=[],l=e.field.get("schema_node"),r=l.generate_url.apply(l,[null,"get_target_objects",e.field.get("node_data"),!1,e.field.get("node_info")]);return i.ajax({type:"GET",timeout:3e4,url:r,cache:!1,async:!1,data:{trgTyp:t,trgSchema:n}}).done((function(e){return o=e.data})).fail((function(e,t,i){a.pgRespErrorNotify(e,i)})),o}},{id:"is_public_synonym",label:e("Public synonym?"),type:"switch",mode:["properties"],cell:"switch",options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"ternary",size:"mini"}}],validate:function(){var t=void 0;return this.errorModel.clear(),n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(t=e("Name cannot be empty."),this.errorModel.set("name",t)):n.isUndefined(this.get("synobjschema"))||""==String(this.get("synobjschema")).replace(/^\s+|\s+$/g,"")?(t=e("Target schema cannot be empty."),this.errorModel.set("synobjschema",t)):(n.isUndefined(this.get("synobjname"))||""==String(this.get("synobjname")).replace(/^\s+|\s+$/g,""))&&(t=e("Target object cannot be empty."),this.errorModel.set("synobjname",t)),null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;var n=this.getTreeNodeHierarchy(t),o=n.server;return(!o||"pg"!==o.server_type)&&null==n.catalog}})),l.Nodes.synonym}.apply(t,n))||(e.exports=o)},269:function(e,t,i){"use strict";var n,o;i(8),i(11),i(5),i(59),i(9),i(7),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(30),i(64),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r,s,d){l.Nodes["coll-type"]||(l.Nodes["coll-type"]=l.Collection.extend({node:"type",label:e("Types"),type:"coll-type",columns:["name","typeowner","description"],canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema}));var c=r.IntegerCell.extend({initialize:function(){r.NumberCell.prototype.initialize.apply(this,arguments),r.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){this.$el.empty();var e=this.model,t=this.column,i=this.column.get("editable");return(n.isFunction(i)?!!i.apply(t,[e]):!!i)?this.$el.addClass("editable"):this.$el.removeClass("editable"),this.delegateEvents(),this},remove:r.Extension.DependentCell.prototype.remove}),p=r.Extension.NodeAjaxOptionsCell.extend({initialize:function(){r.Extension.NodeAjaxOptionsCell.prototype.initialize.apply(this,arguments),r.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){var e=this.model,t=this.column,i=this.column.get("editable"),o=this.$el.find("select").first();return(n.isFunction(i)?!!i.apply(t,[e]):!!i)?(this.$el.addClass("editable"),o.prop("disabled",!1)):(this.$el.removeClass("editable"),o.prop("disabled",!0)),this.delegateEvents(),this},remove:r.Extension.DependentCell.prototype.remove}),u=a.CompositeModel=l.Node.Model.extend({idAttribute:"attnum",defaults:{attnum:void 0,member_name:void 0,type:void 0,tlength:void 0,is_tlength:!1,precision:void 0,is_precision:!1,collation:void 0,min_val:void 0,max_val:void 0},type_options:void 0,subtypes:void 0,schema:[{id:"member_name",label:e("Member Name"),type:"text",disabled:!1,editable:!0},{id:"type",label:e("Type"),control:"node-ajax-options",type:"text",url:"get_types",disabled:!1,node:"type",cache_node:"domain",editable:!0,cell:"node-ajax-options",select2:{allowClear:!1},transform:function(e,t){return t.model.type_options=e,e}},{id:"tlength",label:e("Length/Precision"),deps:["type"],type:"text",disabled:!1,cell:c,editable:function(e){var t=e.get("type");return e.type_options&&n.each(e.type_options,(function(i){t==i.value&&(i.length?(e.set("is_tlength",!0,{silent:!0}),e.set("min_val",i.min_val,{silent:!0}),e.set("max_val",i.max_val,{silent:!0})):e.set("is_tlength",!1,{silent:!0}))})),e.get("is_tlength")}},{id:"precision",label:e("Scale"),deps:["type"],type:"text",disabled:!1,cell:c,editable:function(e){var t=e.get("type");return e.type_options&&n.each(e.type_options,(function(i){t==i.value&&(i.precision?(e.set("is_precision",!0,{silent:!0}),e.set("min_val",i.min_val,{silent:!0}),e.set("max_val",i.max_val,{silent:!0})):e.set("is_precision",!1,{silent:!0}))})),e.get("is_precision")}},{id:"collation",label:e("Collation"),cell:p,deps:["type"],select2:{allowClear:!1},control:"node-ajax-options",editable:function(e){var t=e.get("type"),i=!1;return e.type_options&&n.each(e.type_options,(function(e){t==e.value&&e.is_collatable&&(i=!0)})),i&&setTimeout((function(){e.set("collspcname","",{silent:!0})}),10),i},type:"text",disabled:!1,url:"get_collations",node:"type"}],validate:function(){var t=null;if(this.errorModel.clear(),n.isUndefined(this.get("member_name"))||n.isNull(this.get("member_name"))||""==String(this.get("member_name")).replace(/^\s+|\s+$/g,""))return t=e("Please specify the value for member name."),this.errorModel.set("member_name",t),t;if(n.isUndefined(this.get("type"))||n.isNull(this.get("type"))||""==String(this.get("type")).replace(/^\s+|\s+$/g,""))return t=e("Please specify the type."),this.errorModel.set("type",t),t;if(this.get("is_tlength")&&!n.isUndefined(this.get("tlength"))){if(this.get("tlength")<this.get("min_val")&&(t=e("Length/Precision should not be less than %s",this.get("min_val"))),this.get("tlength")>this.get("max_val")&&(t=e("Length/Precision should not be greater than %s",this.get("max_val"))),t)return this.errorModel.set("tlength",t),t}else if(this.get("is_precision")&&!n.isUndefined(this.get("precision"))&&(this.get("precision")<this.get("min_val")&&(t=e("Scale should not be less than %s",this.get("min_val"))),this.get("precision")>this.get("max_val")&&(t=e("Scale should not be greater than %s",this.get("max_val"))),t))return this.errorModel.set("precision",t),t;return null}}),m=a.EnumModel=l.Node.Model.extend({defaults:{label:void 0},schema:[{id:"label",label:e("Label"),type:"text",disabled:!1,cellHeaderClasses:"width_percent_99",editable:function(e){return n.isUndefined(e.get("label"))}}],validate:function(){return null}});return l.Nodes.type||(l.Nodes.type=s.SchemaChildNode.extend({type:"type",sqlAlterHelp:"sql-altertype.html",sqlCreateHelp:"sql-createtype.html",dialogHelp:t("help.static",{filename:"type_dialog.html"}),label:e("Type"),collection_type:"coll-type",hasSQL:!0,hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_type_on_coll",node:"coll-type",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Type..."),icon:"wcTabIcon icon-type",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_type",node:"type",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Type..."),icon:"wcTabIcon icon-type",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_type",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Type..."),icon:"wcTabIcon icon-type",data:{action:"create",check:!1},enable:"canCreate"}]))},ext_funcs:void 0,model:l.Node.Model.extend({defaults:{name:void 0,oid:void 0,is_sys_type:!1,typtype:void 0},initialize:function(e,t){if(0===n.size(e)){var i=l.serverInfo[t.node_info.server._id].user,o=t.node_info.schema;this.set({typeowner:i.name,schema:o._label},{silent:!0})}l.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"schemaCheck"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"typeowner",label:e("Owner"),cell:"string",control:"node-list-by-name",type:"text",mode:["properties","create","edit"],node:"role",disabled:"inSchema",select2:{allowClear:!1}},{id:"schema",label:e("Schema"),cell:"string",type:"text",mode:["create","edit"],node:"schema",disabled:"schemaCheck",filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database",control:"node-list-by-name",select2:{allowClear:!1}},{id:"typtype",label:e("Type"),mode:["create","edit"],disabled:"inSchema",readonly:"inEditMode",group:e("Definition"),select2:{allowClear:!1},options:function(){return[{label:"Composite",value:"c"},{label:"Enumeration",value:"e"},{label:"External",value:"b"},{label:"Range",value:"r"},{label:"Shell",value:"p"}]},control:a.Select2Control.extend({render:function(){return a.Select2Control.prototype.render.apply(this,arguments),this.model.isNew()&&this.model.set({typtype:"c"}),this}})},{id:"composite",label:e("Composite Type"),model:u,editable:!0,type:"collection",group:e("Definition"),mode:["edit","create"],control:"unique-col-collection",uniqueCol:["member_name"],canAdd:!0,canEdit:!1,canDelete:!0,disabled:"inSchema",deps:["typtype"],visible:function(e){return"c"===e.get("typtype")}},{id:"enum",label:e("Enumeration type"),model:m,editable:!0,type:"collection",group:e("Definition"),mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:function(e){return!!e.isNew()},disabled:"inSchema",deps:["typtype"],control:"unique-col-collection",uniqueCol:["label"],visible:function(e){return"e"===e.get("typtype")}},{type:"nested",control:"plain-fieldset",group:e("Definition"),mode:["edit","create"],visible:function(e){return"r"===e.get("typtype")},deps:["typtype"],label:"",schema:[{id:"typname",label:e("Subtype"),cell:"string",control:"node-ajax-options",select2:{allowClear:!0,placeholder:"",width:"100%"},url:"get_stypes",type:"text",mode:["properties","create","edit"],group:e("Range Type"),disabled:"inSchema",readonly:"inEditMode",transform:function(e,t){return t.model.subtypes=e,e}},{id:"opcname",label:e("Subtype operator class"),cell:"string",mode:["properties","create","edit"],group:e("Range Type"),disabled:"inSchema",readonly:"inEditMode",deps:["typname"],control:"select",options:function(){var e=this.model.get("typname"),t=this,o=[];if(!n.isUndefined(e)&&""!=e){var l=this.field.get("schema_node"),a=l.generate_url.apply(l,[null,"get_subopclass",this.field.get("node_data"),!1,this.field.get("node_info")]);i.ajax({async:!1,url:a,cache:!1,data:{typname:e}}).done((function(e){o=e.data})).fail((function(){t.model.trigger("pgadmin:view:fetch:error",t.model,t.field)}))}return o}},{id:"collname",label:e("Collation"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Range Type"),deps:["typname"],control:"node-ajax-options",url:"get_collations",select2:{allowClear:!0,placeholder:"",width:"100%"},disabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;if(!e.isNew())return!0;var t=e.get("typname"),i=void 0;return n.isUndefined(t)||n.each(e.subtypes,(function(e){t===e.label&&(i=e.is_collate)})),!i}},{id:"rngcanonical",label:e("Canonical function"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Range Type"),disabled:"inSchema",readonly:"inEditMode",deps:["name","typname"],control:"select",options:function(){var e=this.model.get("name"),t=this,o=[];if(!n.isUndefined(e)&&""!=e){var l=this.field.get("schema_node"),a=l.generate_url.apply(l,[null,"get_canonical",this.field.get("node_data"),!1,this.field.get("node_info")]);i.ajax({async:!1,url:a,cache:!1,data:{name:e}}).done((function(e){o=e.data})).fail((function(){t.model.trigger("pgadmin:view:fetch:error",t.model,t.field)}))}return o}},{id:"rngsubdiff",label:e("Subtype diff function"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Range Type"),disabled:"inSchema",readonly:"inEditMode",deps:["opcname"],control:"select",options:function(){var e=this.model.get("typname"),t=this.model.get("opcname"),o=this,l=[];if(!n.isUndefined(e)&&""!=e&&!n.isUndefined(t)&&""!=t){var a=this.field.get("schema_node"),r=a.generate_url.apply(a,[null,"get_stypediff",this.field.get("node_data"),!1,this.field.get("node_info")]);i.ajax({async:!1,url:r,cache:!1,data:{typname:e,opcname:t}}).done((function(e){l=e.data})).fail((function(){o.model.trigger("pgadmin:view:fetch:error",o.model,o.field)}))}return l}}]},{type:"nested",control:"tab",group:e("Definition"),label:e("External Type"),deps:["typtype"],mode:["create","edit"],tabPanelExtraClasses:"inline-tab-panel-padded",visible:function(e){return"b"===e.get("typtype")},schema:[{id:"spacer_ctrl",group:e("Required"),mode:["edit","create"],type:"spacer"},{id:"typinput",label:e("Input function"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Required"),disabled:"inSchema",readonly:"inEditMode",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typoutput",label:e("Output function"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Required"),disabled:"inSchema",readonly:"inEditMode",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"spacer_ctrl_optional_1",group:e("Optional-1"),mode:["edit","create"],type:"spacer"},{id:"typreceive",label:e("Receive function"),cell:"string",type:"text",group:e("Optional-1"),mode:["properties","create","edit"],disabled:"inSchema",readonly:"inEditMode",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typsend",label:e("Send function"),cell:"string",group:e("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchema",readonly:"inEditMode",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typmodin",label:e("Typmod in function"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Optional-1"),disabled:"inSchema",readonly:"inEditMode",control:"node-ajax-options",url:"get_external_functions",select2:{allowClear:!0,placeholder:"",width:"100%"},transform:function(e){var t=[{label:"",value:""}];return n.each(e,(function(e){"typmodin"!==e.cbtype&&"all"!==e.cbtype||t.push(e)})),t}},{id:"typmodout",label:e("Typmod out function"),cell:"string",group:e("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchema",readonly:"inEditMode",control:"node-ajax-options",url:"get_external_functions",select2:{allowClear:!0,placeholder:"",width:"100%"},transform:function(e){var t=[{label:"",value:""}];return n.each(e,(function(e){"typmodout"!==e.cbtype&&"all"!==e.cbtype||t.push(e)})),t}},{id:"typlen",label:e("Internal length"),cell:"integer",group:e("Optional-1"),type:"int",mode:["properties","create","edit"],disabled:"inSchema",readonly:"inEditMode"},{id:"variable",label:e("Variable?"),cell:"switch",group:e("Optional-1"),type:"switch",mode:["create","edit"],disabled:"inSchema",readonly:"inEditMode"},{id:"typdefault",label:e("Default?"),cell:"string",group:e("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchema",readonly:"inEditMode"},{id:"typanalyze",label:e("Analyze function"),cell:"string",group:e("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchema",readonly:"inEditMode",control:"node-ajax-options",url:"get_external_functions",transform:"external_func_combo",select2:{allowClear:!0,placeholder:"",width:"100%"}},{id:"typcategory",label:e("Category type"),cell:"string",group:e("Optional-1"),type:"text",mode:["properties","create","edit"],disabled:"inSchema",readonly:"inEditMode",control:"select2",select2:{allowClear:!0,placeholder:"",width:"100%"},options:[{label:"",value:""},{label:"Array types",value:"A"},{label:"Boolean types",value:"B"},{label:"Composite types",value:"C"},{label:"Date/time types",value:"D"},{label:"Enum types",value:"E"},{label:"Geometric types",value:"G"},{label:"Network address types",value:"I"},{label:"Numeric types",value:"N"},{label:"Pseudo-types",value:"P"},{label:"String types",value:"S"},{label:"Timespan types",value:"T"},{label:"User-defined types",value:"U"},{label:"Bit-string types",value:"V"},{label:"unknown type",value:"X"}]},{id:"typispreferred",label:e("Preferred?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchema",readonly:"inEditMode",group:e("Optional-1")},{id:"spacer_ctrl_optional_2",group:e("Optional-2"),mode:["edit","create"],type:"spacer"},{id:"element",label:e("Element type"),cell:"string",control:"node-ajax-options",group:e("Optional-2"),type:"text",mode:["properties","create","edit"],disabled:"inSchema",readonly:"inEditMode",url:"get_types"},{id:"typdelim",label:e("Delimiter"),cell:"string",type:"text",mode:["properties","create","edit"],group:e("Optional-2"),disabled:"inSchema",readonly:"inEditMode"},{id:"typalign",label:e("Alignment type"),cell:"string",group:e("Optional-2"),type:"text",mode:["properties","create","edit"],disabled:"inSchema",readonly:"inEditMode",control:"select2",select2:{allowClear:!0,placeholder:"",width:"100%"},options:[{label:"",value:""},{label:"char",value:"c"},{label:"int2",value:"s"},{label:"int4",value:"i"},{label:"double",value:"d"}]},{id:"typstorage",label:e("Storage type"),type:"text",mode:["properties","create","edit"],group:e("Optional-2"),cell:"string",disabled:"inSchema",readonly:"inEditMode",control:"select2",select2:{allowClear:!0,placeholder:"",width:"100%"},options:[{label:"",value:""},{label:"PLAIN",value:"p"},{label:"EXTERNAL",value:"e"},{label:"MAIN",value:"m"},{label:"EXTENDED",value:"x"}]},{id:"typbyval",label:e("Passed by value?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchema",readonly:"inEditMode",group:e("Optional-2")},{id:"is_collatable",label:e("Collatable?"),cell:"switch",min_version:90100,group:e("Optional-2"),type:"switch",mode:["properties","create","edit"],disabled:"inSchema",readonly:"inEditMode"}]},{id:"alias",label:e("Alias"),cell:"string",type:"text",mode:["properties"],disabled:"inSchema"},l.SecurityGroupSchema,{id:"type_acl",label:e("Privileges"),cell:"string",type:"text",mode:["properties"],group:"security",disabled:"inSchema"},{id:"member_list",label:e("Members"),cell:"string",type:"text",mode:["properties"],group:e("Definition"),disabled:"inSchema",visible:function(e){return"c"===e.get("typtype")}},{id:"enum_list",label:e("Labels"),cell:"string",type:"text",mode:["properties"],group:e("Definition"),disabled:"inSchema",visible:function(e){return"e"===e.get("typtype")}},{id:"is_sys_type",label:e("System type?"),cell:"switch",type:"switch",mode:["properties"],disabled:"inSchema"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"},{id:"typacl",label:e("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:l.Node.PrivilegeRoleModel.extend({privileges:["U"]}),mode:["edit","create"],canDelete:!0,uniqueCol:["grantee"],deps:["typtype"],canAdd:function(e){if("p"===e.get("typtype")){var t=e.get("typacl");t.length>0&&t.reset()}return!("p"===e.get("typtype"))}},{id:"seclabels",label:e("Security labels"),model:l.SecLabelModel,editable:!1,type:"collection",group:"security",mode:["edit","create"],min_version:90100,canEdit:!1,canDelete:!0,control:"unique-col-collection",deps:["typtype"],canAdd:function(e){if("p"===e.get("typtype")){var t=e.get("seclabels");t.length>0&&t.reset()}return!("p"===e.get("typtype"))}}],validate:function(){var t;if(this.errorModel.clear(),n.isUndefined(this.get("name"))||n.isNull(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))return t=e("Name cannot be empty."),this.errorModel.set("name",t),t;if(n.isUndefined(this.get("schema"))||n.isNull(this.get("schema"))||""==String(this.get("schema")).replace(/^\s+|\s+$/g,""))return t=e("Schema cannot be empty."),this.errorModel.set("schema",t),t;if(n.isUndefined(this.get("typtype"))||n.isNull(this.get("typtype"))||""==String(this.get("typtype")).replace(/^\s+|\s+$/g,""))return t=e("Type cannot be empty."),this.errorModel.set("typtype",t),t;if("r"==this.get("typtype")&&(n.isUndefined(this.get("typname"))||n.isNull(this.get("typname"))||""==String(this.get("typname")).replace(/^\s+|\s+$/g,"")))return t=e("Subtype name cannot be empty."),this.errorModel.set("typname",t),t;if("b"==this.get("typtype")){if(n.isUndefined(this.get("typinput"))||n.isNull(this.get("typinput"))||""==String(this.get("typinput")).replace(/^\s+|\s+$/g,""))return t=e("Input function cannot be empty."),this.errorModel.set("typinput",t),t;if(n.isUndefined(this.get("typoutput"))||n.isNull(this.get("typoutput"))||""==String(this.get("typoutput")).replace(/^\s+|\s+$/g,""))return t=e("Output function cannot be empty."),this.errorModel.set("typoutput",t),t}return null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inEditMode:function(e){return!e.isNew()},schemaCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()&&"p"===e.get("typtype")},external_func_combo:function(e){var t=[];return n.each(e,(function(e){"all"==e.cbtype&&t.push(e)})),t}})})),l.Nodes.type}.apply(t,n))||(e.exports=o)},270:function(e,t,i){"use strict";var n,o;i(161),i(8),i(16),i(5),i(59),i(9),i(7),n=[i(2),i(6),i(0),i(1),i(14),i(3),i(10),i(13),i(18),i(30),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r,s,d,c){a.Nodes["coll-index"]||(l.Browser.Nodes["coll-index"]=l.Browser.Collection.extend({node:"index",label:e("Indexes"),type:"coll-index",columns:["name","description"],hasStatistics:!0,statsPrettifyFields:[e("Size"),e("Index size")],canDrop:c.isTreeItemOfChildOfSchema,canDropCascade:c.isTreeItemOfChildOfSchema}));var p=d.Extension.NodeAjaxOptionsCell.extend({initialize:function(){d.Extension.NodeAjaxOptionsCell.prototype.initialize.apply(this,arguments),d.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){var e=this.model,t=this.column,i=this.column.get("editable"),o=this.$el.find("select").first();return(n.isFunction(i)?!!i.apply(t,[e]):!!i)?(this.$el.addClass("editable"),o.prop("disabled",!1)):(this.$el.removeClass("editable"),o.prop("disabled",!0)),this.delegateEvents(),this},remove:d.Extension.DependentCell.prototype.remove}),u=l.Browser.Node.Model.extend({defaults:{colname:void 0,collspcname:void 0,op_class:void 0,sort_order:!1,nulls:!1,is_sort_nulls_applicable:!0},schema:[{id:"colname",label:e("Column"),cell:"node-list-by-name",type:"text",disabled:"inSchema",readonly:"isEditMode",editable:function(e){return!(e instanceof o.Collection)&&!e.inSchemaWithModelCheck.apply(this,arguments)},control:"node-list-by-name",node:"column"},{id:"collspcname",label:e("Collation"),cell:p,type:"text",disabled:"inSchema",readonly:"isEditMode",editable:function(e){return!(e instanceof o.Collection)&&!e.inSchemaWithModelCheck.apply(this,arguments)},control:"node-ajax-options",url:"get_collations",node:"index",url_jump_after_node:"schema"},{id:"op_class",label:e("Operator class"),cell:p,tags:!0,type:"text",disabled:"checkAccessMethod",editable:function(e){return!(e instanceof o.Collection)&&(!e.inSchemaWithModelCheck.apply(this,arguments)&&!e.checkAccessMethod.apply(this,arguments))},control:"node-ajax-options",url:"get_op_class",node:"index",url_jump_after_node:"schema",deps:["amname"],transform:function(e,t){var i=t.model.top.get("amname"),o=e.btree;return n.isUndefined(i)?o:(n.each(e,(function(e,t){i===t&&(o=e)})),o)}},{id:"sort_order",label:e("Sort order"),cell:d.Extension.TableChildSwitchCell,type:"switch",editable:function(e){return!(e instanceof o.Collection)&&(!e.inSchemaWithModelCheck.apply(this,arguments)&&("btree"===e.top.get("amname")?(e.set("is_sort_nulls_applicable",!0),!0):(e.set("is_sort_nulls_applicable",!1),!1)))},deps:["amname"],options:{onText:"DESC",offText:"ASC"}},{id:"nulls",label:e("NULLs"),cell:d.Extension.TableChildSwitchCell,type:"switch",editable:function(e){return!(e instanceof o.Collection)&&(!e.inSchemaWithModelCheck.apply(this,arguments)&&("btree"===e.top.get("amname")?(e.set("is_sort_nulls_applicable",!0),!0):(e.set("is_sort_nulls_applicable",!1),!1)))},deps:["amname","sort_order"],options:{onText:"FIRST",offText:"LAST"}}],validate:function(){if(this.errorModel.clear(),n.isUndefined(this.get("colname"))||""==String(this.get("colname")).replace(/^\s+|\s+$/g,"")){var t=e("Column Name cannot be empty.");return this.errorModel.set("colname",t),t}},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},isEditMode:function(e){return!e.top.isNew()},inSchemaWithModelCheck:function(e){return!(e.top.node_info&&"schema"in e.top.node_info)||!e.top.isNew()},checkAccessMethod:function(e){var t=e.top;return n.isUndefined(t.get("amname"))||n.isNull(t.get("amname"))||""==String(t.get("amname")).replace(/^\s+|\s+$/g,"")||"btree"===t.get("amname")?1==e.get("sort_order")&&0==e.previous("sort_order")&&setTimeout((function(){e.set("nulls",!0)}),10):e.set("is_sort_nulls_applicable",!1),!1}});return a.Nodes.index||(l.Browser.Nodes.index=a.Node.extend({parent_type:["table","view","mview","partition"],collection_type:["coll-table","coll-view"],sqlAlterHelp:"sql-alterindex.html",sqlCreateHelp:"sql-createindex.html",dialogHelp:t("help.static",{filename:"index_dialog.html"}),type:"index",label:e("Index"),hasSQL:!0,hasDepends:!0,hasStatistics:!0,width:a.stdW.md+"px",statsPrettifyFields:[e("Size"),e("Index size")],url_jump_after_node:"schema",Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_index_on_coll",node:"coll-index",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_index",node:"index",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_index_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_index_onPartition",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_index_onMatView",node:"mview",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Index..."),icon:"wcTabIcon icon-index",data:{action:"create",check:!0},enable:"canCreate"}]))},canDrop:c.isTreeItemOfChildOfSchema,canDropCascade:c.isTreeItemOfChildOfSchema,model:l.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,nspname:void 0,tabname:void 0,spcname:void 0,amname:"btree"},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:e("OID"),cell:"string",type:"int",readonly:!0,mode:["properties"]},{id:"spcname",label:e("Tablespace"),cell:"string",control:"node-list-by-name",node:"tablespace",select2:{allowClear:!0},type:"text",mode:["properties","create","edit"],disabled:"inSchema",filter:function(e){return!e||!e.label.match(/pg_global/)}},{id:"amname",label:e("Access Method"),cell:"string",type:"text",mode:["properties","create","edit"],disabled:"inSchema",readonly:"isEditMode",url:"get_access_methods",url_jump_after_node:"schema",group:e("Definition"),select2:{allowClear:!0},control:s.NodeAjaxOptionsControl.extend({onChange:function(){s.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var t=this,i=t.model.get("amname"),n=t.model.previous("amname");if(i!=n&&0!==t.model.get("columns").length){var o=e("Changing access method will clear columns collection");r.confirm(o,(function(){for(var e=t.model.get("columns"),i=e.length-1;i>=0;i--)e.remove(e.models[i])}),(function(){setTimeout((function(){t.model.set("amname",n)}),10)}))}}})},{id:"columns_csv",label:e("Columns"),cell:"string",type:"text",disabled:"inSchema",mode:["properties"],group:e("Definition")},{id:"include",label:e("Include columns"),type:"array",group:e("Definition"),editable:!1,canDelete:!0,canAdd:!0,mode:["properties"],disabled:"inSchema",readonly:"isEditMode",visible:function(e){return!n.isUndefined(e.node_info)&&!n.isUndefined(e.node_info.server)&&!n.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=11e4},control:s.MultiSelectAjaxControl.extend({defaults:n.extend({},s.NodeListByNameControl.prototype.defaults,{select2:{allowClear:!1,width:"style",multiple:!0,placeholder:e("Select the column(s)")}})}),transform:function(e){var t=[];return e&&n.isArray(e)&&n.each(e,(function(e){t.push({label:e.label,value:e.label,image:"icon-column"})})),t},node:"column"},{id:"fillfactor",label:e("Fill factor"),cell:"string",type:"int",disabled:"inSchema",mode:["create","edit","properties"],min:10,max:100,group:e("Definition")},{id:"indisunique",label:e("Unique?"),cell:"string",type:"switch",disabled:"inSchema",readonly:"isEditMode",group:e("Definition")},{id:"indisclustered",label:e("Clustered?"),cell:"string",type:"switch",disabled:"inSchema",group:e("Definition")},{id:"indisvalid",label:e("Valid?"),cell:"string",type:"switch",mode:["properties"],group:e("Definition")},{id:"indisprimary",label:e("Primary?"),cell:"string",type:"switch",mode:["properties"],group:e("Definition")},{id:"is_sys_idx",label:e("System index?"),cell:"string",type:"switch",mode:["properties"]},{id:"isconcurrent",label:e("Concurrent build?"),cell:"string",type:"switch",disabled:"inSchema",readonly:"isEditMode",mode:["create","edit"],group:e("Definition")},{id:"indconstraint",label:e("Constraint"),cell:"string",type:"text",disabled:"inSchema",readonly:"isEditMode",mode:["create","edit"],control:"sql-field",visible:!0,group:e("Definition")},{id:"columns",label:e("Columns"),type:"collection",deps:["amname"],group:e("Definition"),model:u,mode:["edit","create"],canAdd:function(e){return!!e.isNew()},canEdit:!1,canDelete:function(e){return!!e.isNew()},control:"unique-col-collection",uniqueCol:["colname"],columns:["colname","op_class","sort_order","nulls","collspcname"]},{id:"include",label:e("Include columns"),type:"array",group:e("Definition"),editable:!1,canDelete:!0,canAdd:!0,mode:["edit","create"],disabled:"inSchema",readonly:"isEditMode",visible:function(e){return!n.isUndefined(e.node_info)&&!n.isUndefined(e.node_info.server)&&!n.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=11e4},control:s.MultiSelectAjaxControl.extend({defaults:n.extend({},s.NodeListByNameControl.prototype.defaults,{select2:{allowClear:!1,width:"style",multiple:!0,placeholder:e("Select the column(s)")}})}),transform:function(e){var t=[];return e&&n.isArray(e)&&n.each(e,(function(e){t.push({label:e.label,value:e.label,image:"icon-column"})})),t},node:"column"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function(t){var i;if(t&&0==t.length)return this.errorModel.clear(),null;if(this.errorModel.clear(),n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))return i=e("Name cannot be empty."),this.errorModel.set("name",i),i;if(n.isUndefined(this.get("amname"))||""==String(this.get("amname")).replace(/^\s+|\s+$/g,""))return i=e("Access method cannot be empty."),this.errorModel.set("amname",i),i;var o=this.get("columns");if(o&&o.length>0){if(!n.every(o.pluck("colname")))return i=e("You must specify column name."),this.errorModel.set("columns",i),i}else if(o)return i=e("You must specify at least one column."),this.errorModel.set("columns",i),i;return null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},isEditMode:function(e){return!e.isNew()},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},inSchemaWithColumnCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()&&!(!n.isUndefined(e.get("attnum"))&&e.get("attnum")>=1)}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var o=a.tree,l=t,r=e,s=[],d=!1,c=!1,p=this.getTreeNodeHierarchy(l).server.version;l;){if(!d&&n.indexOf(["table","partition"],r._type)>-1&&(d=!0,"is_partitioned"in r&&r.is_partitioned&&p<11e4&&(c=!0)),n.indexOf(["schema"],r._type)>-1)return!c;s.push(r._type),r=(l=o.hasParent(l)?o.parent(l):null)?o.itemData(l):null}return!(n.indexOf(s,"catalog")>-1)&&!c}})),a.Nodes.index}.apply(t,n))||(e.exports=o)},271:function(e,t,i){"use strict";var n,o;i(16),i(11),i(41),i(5),i(9),i(7),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(13),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r,s){return l.Nodes["coll-trigger"]||(o.Browser.Nodes["coll-trigger"]=o.Browser.Collection.extend({node:"trigger",label:e("Triggers"),type:"coll-trigger",columns:["name","description"],canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})),l.Nodes.trigger||(o.Browser.Nodes.trigger=l.Node.extend({parent_type:["table","view","partition"],collection_type:["coll-table","coll-view"],type:"trigger",label:e("Trigger"),hasSQL:!0,hasDepends:!0,width:l.stdW.sm+"px",sqlAlterHelp:"sql-altertrigger.html",sqlCreateHelp:"sql-createtrigger.html",dialogHelp:t("help.static",{filename:"trigger_dialog.html"}),url_jump_after_node:"schema",Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_trigger_on_coll",node:"coll-trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger",node:"trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_trigger_onPartition",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"enable_trigger",node:"trigger",module:this,applies:["object","context"],callback:"enable_trigger",category:"connect",priority:3,label:e("Enable trigger"),icon:"fa fa-check",enable:"canCreate_with_trigger_enable"},{name:"disable_trigger",node:"trigger",module:this,applies:["object","context"],callback:"disable_trigger",category:"drop",priority:3,label:e("Disable trigger"),icon:"fa fa-times",enable:"canCreate_with_trigger_disable"},{name:"create_trigger_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Trigger..."),icon:"wcTabIcon icon-trigger",data:{action:"create",check:!0},enable:"canCreate"}]))},callbacks:{enable_trigger:function(e){var t=e||{},n=l.tree,o=t.item||n.selected(),a=o&&1==o.length?n.itemData(o):void 0;if(!a)return!1;var s=a;i.ajax({url:this.generate_url(o,"enable",a,!0),type:"PUT",data:{is_enable_trigger:"O"},dataType:"json"}).done((function(e){1==e.success&&(r.success(e.info),n.removeIcon(o),s.icon="icon-trigger",n.addIcon(o,{icon:s.icon}),n.unload(o),n.setInode(!1),n.deselect(o),setTimeout((function(){n.select(o)}),10))})).fail((function(e,t,i){r.pgRespErrorNotify(e,i),n.unload(o)}))},disable_trigger:function(t){var n=t||{},o=l.tree,a=n.item||o.selected(),s=a&&1==a.length?o.itemData(a):void 0;if(!s)return!1;var d=s;i.ajax({url:this.generate_url(a,"enable",s,!0),type:"PUT",data:{is_enable_trigger:"D"},dataType:"json"}).done((function(e){1==e.success&&(r.success(e.info),o.removeIcon(a),d.icon="icon-trigger-bad",o.addIcon(a,{icon:d.icon}),o.unload(a),o.setInode(!1),o.deselect(a),setTimeout((function(){o.select(a)}),10))})).fail((function(t,i,n){r.pgRespErrorNotify(t,n,e("Disable trigger failed")),o.unload(a)}))}},canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema,model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,is_row_trigger:!0,fires:"BEFORE"},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:e("OID"),cell:"string",type:"int",mode:["properties"]},{id:"is_enable_trigger",label:e("Trigger enabled?"),mode:["edit","properties"],group:e("Definition"),disabled:function(){return!(!this.node_info||!("catalog"in this.node_info||"view"in this.node_info))},options:[{label:"Enable",value:"O"},{label:"Enable Replica",value:"R"},{label:"Enable Always",value:"A"},{label:"Disable",value:"D"}],control:"select2",select2:{allowClear:!1,width:"100%"}},{id:"is_row_trigger",label:e("Row trigger?"),type:"switch",group:e("Definition"),mode:["create","edit","properties"],deps:["is_constraint_trigger"],disabled:function(e){if(n.has(e,"node_info")&&n.has(e.node_info,"table")&&n.has(e.node_info.table,"is_partitioned")&&e.node_info.table.is_partitioned&&e.node_info.server.version<11e4)return setTimeout((function(){e.set("is_row_trigger",!1)}),10),!0;var t=e.get("is_constraint_trigger");if(e.inSchemaWithModelCheck.apply(this,[e])){var i=e.get("is_row_trigger");return!(!n.isUndefined(i)&&"ppas"==e.node_info.server.server_type)}return!n.isUndefined(t)&&!0===t&&(setTimeout((function(){e.set("is_row_trigger",!0)}),10),!0)}},{id:"is_constraint_trigger",label:e("Constraint trigger?"),type:"switch",mode:["create","edit","properties"],group:e("Definition"),disabled:function(e){return n.has(e,"node_info")&&n.has(e.node_info,"table")&&n.has(e.node_info.table,"is_partitioned")&&e.node_info.table.is_partitioned||-1!=n.indexOf(Object.keys(e.node_info),"view")?(setTimeout((function(){e.set("is_constraint_trigger",!1)}),10),!0):e.inSchemaWithModelCheck.apply(this,[e])}},{id:"tgdeferrable",label:e("Deferrable?"),type:"switch",group:e("Definition"),mode:["create","edit","properties"],deps:["is_constraint_trigger"],disabled:function(e){var t=e.get("is_constraint_trigger");return!!e.inSchemaWithModelCheck.apply(this,[e])||!(!n.isUndefined(t)&&!0===t)&&(e.get("tgdeferrable")&&setTimeout((function(){e.set("tgdeferrable",!1)}),10),!0)}},{id:"tginitdeferred",label:e("Deferred?"),type:"switch",group:e("Definition"),mode:["create","edit","properties"],deps:["tgdeferrable","is_constraint_trigger"],disabled:function(e){var t=e.get("tgdeferrable");return!!e.inSchemaWithModelCheck.apply(this,[e])||!(!n.isUndefined(t)&&t)&&(e.get("tginitdeferred")&&setTimeout((function(){e.set("tginitdeferred",!1)}),10),!e.get("is_constraint_trigger"))}},{id:"tfunction",label:e("Trigger function"),type:"text",disabled:"inSchemaWithModelCheck",mode:["create","edit","properties"],group:e("Definition"),control:"node-ajax-options",url:"get_triggerfunctions",url_jump_after_node:"schema",cache_node:"trigger_function"},{id:"tgargs",label:e("Arguments"),cell:"string",group:e("Definition"),type:"text",mode:["create","edit","properties"],deps:["tfunction"],disabled:function(e){var t=e.get("tfunction"),i=e.node_info.server.server_type;return!!e.inSchemaWithModelCheck.apply(this,[e])||"ppas"===i&&!n.isUndefined(t)&&"Inline EDB-SPL"===t&&(e.set("tgargs",void 0),!0)}},{id:"fires",label:e("Fires"),deps:["is_constraint_trigger"],mode:["create","edit","properties"],group:e("Events"),options:function(e){return-1!=n.indexOf(Object.keys(e.model.node_info),"table")?[{label:"BEFORE",value:"BEFORE"},{label:"AFTER",value:"AFTER"}]:[{label:"BEFORE",value:"BEFORE"},{label:"AFTER",value:"AFTER"},{label:"INSTEAD OF",value:"INSTEAD OF"}]},control:"select2",select2:{allowClear:!1,width:"100%"},disabled:function(e){var t=e.get("is_constraint_trigger");if(e.inSchemaWithModelCheck.apply(this,[e])){var i=e.get("fires");return!(!n.isUndefined(i)&&"ppas"==e.node_info.server.server_type)}return!n.isUndefined(t)&&!0===t&&(setTimeout((function(){e.set("fires","AFTER")}),10),!0)}},{type:"nested",control:"fieldset",mode:["create","edit","properties"],label:e("Events"),group:e("Events"),contentClass:"row",schema:[{id:"evnt_insert",label:e("INSERT"),type:"switch",mode:["create","edit","properties"],group:e("Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_insert");return!(!n.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchemaWithModelCheck.apply(this,[e])}},{id:"evnt_update",label:e("UPDATE"),type:"switch",mode:["create","edit","properties"],group:e("Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_update");return!(!n.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchemaWithModelCheck.apply(this,[e])}},{id:"evnt_delete",label:e("DELETE"),type:"switch",mode:["create","edit","properties"],group:e("Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_delete");return!(!n.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchemaWithModelCheck.apply(this,[e])}},{id:"evnt_truncate",label:e("TRUNCATE"),type:"switch",group:e("Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("is_constraint_trigger"),i=e.get("is_row_trigger"),o=e.node_info.server.server_type;return!!e.inSchemaWithModelCheck.apply(this,[e])||!("ppas"===o&&!n.isUndefined(t)&&!n.isUndefined(i)&&!1===t&&!1===i)}}]},{id:"whenclause",label:e("When"),type:"text",disabled:"inSchemaWithModelCheck",mode:["create","edit","properties"],control:"sql-field",visible:!0,group:e("Events")},{id:"columns",label:e("Columns"),url:"nodes",control:"node-list-by-name",cache_node:"column",type:"array",select2:{multiple:!0},deps:["evnt_update"],node:"column",group:e("Events"),disabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;if(!e.isNew())return!0;var t=e.get("evnt_update");return!(!n.isUndefined(t)&&t)}},{id:"tgoldtable",label:e("Old table"),type:"text",group:e("Transition"),cell:"string",mode:["create","edit","properties"],deps:["fires","is_constraint_trigger","evnt_insert","evnt_update","evnt_delete","columns"],disabled:"disableTransition"},{id:"tgnewtable",label:e("New table"),type:"text",group:e("Transition"),cell:"string",mode:["create","edit","properties"],deps:["fires","is_constraint_trigger","evnt_insert","evnt_update","evnt_delete","columns"],disabled:"disableTransition"},{id:"prosrc",label:e("Code"),group:e("Code"),type:"text",mode:["create","edit"],deps:["tfunction"],tabPanelCodeClass:"sql-code-control",control:a.SqlCodeControl,visible:!0,disabled:function(e){var t=e.get("tfunction");return!("ppas"===e.node_info.server.server_type&&!n.isUndefined(t)&&"Inline EDB-SPL"===t)}},{id:"is_sys_trigger",label:e("System trigger?"),cell:"string",type:"switch",disabled:"inSchemaWithModelCheck",mode:["properties"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function(t){var i;return this.errorModel.clear(),t&&0==t.length?null:n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(i=e("Name cannot be empty."),this.errorModel.set("name",i),i):n.isUndefined(this.get("tfunction"))||""==String(this.get("tfunction")).replace(/^\s+|\s+$/g,"")?(i=e("Trigger function cannot be empty."),this.errorModel.set("tfunction",i),i):this.get("evnt_truncate")||this.get("evnt_delete")||this.get("evnt_update")||this.get("evnt_insert")?n.isUndefined(this.get("tfunction"))||"Inline EDB-SPL"!==this.get("tfunction")||!n.isUndefined(this.get("prosrc"))&&""!=String(this.get("prosrc")).replace(/^\s+|\s+$/g,"")?null:(i=e("Trigger code cannot be empty."),this.errorModel.set("prosrc",i),i):(i=e("Specify at least one event."),this.errorModel.set("evnt_truncate"," "),this.errorModel.set("evnt_delete"," "),this.errorModel.set("evnt_update"," "),this.errorModel.set("evnt_insert",i),i)},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},inSchemaWithColumnCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()&&!(!n.isUndefined(e.get("attnum"))&&e.get("attnum")>=1)},disableTransition:function(e){var t=!0,i=null,o=this.name,l=0;return-1==n.indexOf(Object.keys(e.node_info),"table")||e.node_info.server.version<1e5||("tgoldtable"==o?i="evnt_delete":"tgnewtable"==o&&(i="evnt_insert"),e.get("evnt_insert")&&l++,e.get("evnt_update")&&l++,e.get("evnt_delete")&&l++,e.get("is_constraint_trigger")||"AFTER"!=e.get("fires")||!e.get("evnt_update")&&!e.get(i)||1!=l||(t=!!(e.get("evnt_update")&&n.size(e.get("columns"))>=1&&""!=e.get("columns")[0])),t&&setTimeout((function(){e.get(o)&&e.set(o,null)}),10),t)}}),canCreate:s.isTreeItemOfChildOfSchema,canCreate_with_trigger_enable:function(e,t,i){return!("view"in this.getTreeNodeHierarchy(t))&&("icon-trigger-bad"===e.icon&&this.canCreate.apply(this,[e,t,i]))},canCreate_with_trigger_disable:function(e,t,i){return!("view"in this.getTreeNodeHierarchy(t))&&("icon-trigger"===e.icon&&this.canCreate.apply(this,[e,t,i]))}})),l.Nodes.trigger}.apply(t,n))||(e.exports=o)},272:function(e,t,i){"use strict";var n,o;n=[i(2),i(0),i(1),i(3),i(10),i(25)],void 0===(o=function(e,t,i,n,o){return o.Nodes["coll-catalog_object_column"]||(n.Browser.Nodes["coll-catalog_object_column"]=n.Browser.Collection.extend({node:"catalog_object_column",label:e("catalog_object_column"),type:"coll-catalog_object_column",columns:["attname","attnum","cltype","description"],canDrop:!1,canDropCascade:!1})),o.Nodes.catalog_object_column||(n.Browser.Nodes.catalog_object_column=n.Browser.Node.extend({parent_type:"catalog_object",type:"catalog_object_column",label:e("catalog_object_column"),hasSQL:!1,hasScriptTypes:[],hasDepends:!0,Init:function(){this.initialized||(this.initialized=!0)},model:n.Browser.Node.Model.extend({defaults:{attname:void 0,attowner:void 0,atttypid:void 0,attnum:void 0,cltype:void 0,collspcname:void 0,attacl:void 0,description:void 0},schema:[{id:"attname",label:e("Column"),cell:"string",type:"text",readonly:!0},{id:"attowner",label:e("Owner"),cell:"string",type:"text",readonly:!0},{id:"attnum",label:e("Position"),cell:"string",type:"text",readonly:!0},{id:"cltype",label:e("Data type"),cell:"string",group:e("Definition"),type:"text",readonly:!0},{id:"collspcname",label:e("Collation"),cell:"string",group:e("Definition"),type:"text",readonly:!0},{id:"attacl",label:e("Privileges"),cell:"string",group:e("Security"),type:"text",readonly:!0},{id:"description",label:e("Comment"),cell:"string",type:"multiline",readonly:!0}]})})),o.Nodes.catalog_object_column}.apply(t,n))||(e.exports=o)},273:function(e,t,i){"use strict";var n,o;i(11),i(5),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(64),i(45),i(67),i(198)],void 0===(o=function(e,t,i,n,o,l,a,r,s){return l.Nodes["coll-view"]||(l.Nodes["coll-view"]=l.Collection.extend({node:"view",label:e("Views"),type:"coll-view",columns:["name","owner"],canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})),l.Nodes.view||(l.Nodes.view=r.SchemaChildNode.extend({type:"view",sqlAlterHelp:"sql-alterview.html",sqlCreateHelp:"sql-createview.html",dialogHelp:t("help.static",{filename:"view_dialog.html"}),label:e("View"),hasSQL:!0,hasDepends:!0,hasScriptTypes:["create","select","insert"],collection_type:"coll-view",Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_view_on_coll",node:"coll-view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("View..."),icon:"wcTabIcon icon-view",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_view",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:e("View..."),icon:"wcTabIcon icon-view",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_view",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:17,label:e("View..."),icon:"wcTabIcon icon-view",data:{action:"create",check:!1},enable:"canCreate"}]))},model:l.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){if(0===n.size(e)){var i=t.node_info.schema._label||"public",o=l.serverInfo[t.node_info.server._id].user;this.set({schema:i,owner:o.name},{silent:!0})}l.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:"notInSchema"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",control:"node-list-by-name",node:"role",disabled:"notInSchema",select2:{allowClear:!1}},{id:"schema",label:e("Schema"),cell:"string",first_empty:!1,control:"node-list-by-name",type:"text",cache_level:"database",node:"schema",disabled:"notInSchema",mode:["create","edit"],select2:{allowClear:!1},cache_node:"database"},{id:"system_view",label:e("System view?"),cell:"string",type:"switch",mode:["properties"]},{id:"acl",label:e("Privileges"),mode:["properties"],type:"text",group:e("Security")},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",disabled:"notInSchema"},{id:"security_barrier",label:e("Security barrier?"),type:"switch",min_version:"90200",group:e("Definition"),disabled:"notInSchema"},{id:"check_option",label:e("Check options"),control:"select2",group:e("Definition"),type:"text",min_version:"90400",mode:["properties","create","edit"],select2:{allowClear:!1},disabled:"notInSchema",options:[{label:e("No"),value:"no"},{label:e("Local"),value:"local"},{label:e("Cascaded"),value:"cascaded"}]},{id:"definition",label:e("Code"),cell:"string",type:"text",mode:["create","edit"],group:e("Code"),tabPanelCodeClass:"sql-code-control",control:a.SqlCodeControl,disabled:"notInSchema"},l.SecurityGroupSchema,{id:"datacl",label:e("Privileges"),type:"collection",model:l.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),uniqueCol:["grantee"],editable:!1,group:"security",mode:["edit","create"],canAdd:!0,canDelete:!0,control:"unique-col-collection",disabled:"notInSchema"},{id:"seclabels",label:e("Security labels"),model:l.SecLabelModel,editable:!1,type:"collection",canEdit:!1,group:"security",canDelete:!0,mode:["edit","create"],canAdd:!0,disabled:"notInSchema",control:"unique-col-collection",uniqueCol:["provider"]}],validate:function(){var t,i={},o=this.get("name"),l=this.get("definition");return n.isUndefined(o)||n.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(i.name=e("Please specify name."),t=t||i.name,this.errorModel.set("name",t),t):(this.errorModel.unset("name"),n.isUndefined(l)||n.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")?(i.definition=e("Please enter view code."),t=t||i.definition,this.errorModel.set("definition",t),t):(this.errorModel.unset("definition"),null))},notInSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)}})})),l.Nodes.view}.apply(t,n))||(e.exports=o)},274:function(e,t,i){"use strict";var n,o;i(16),i(11),i(5),i(9),n=[i(2),i(6),i(0),i(1),i(3),i(13),i(10),i(18),i(64),i(45),i(67)],void 0===(o=function(e,t,i,n,o,l,a,r,s,d){return a.Nodes["coll-mview"]||(a.Nodes["coll-mview"]=a.Collection.extend({node:"mview",label:e("Materialized Views"),type:"coll-mview",columns:["name","owner"],canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema})),a.Nodes.mview||(a.Nodes.mview=s.SchemaChildNode.extend({type:"mview",sqlAlterHelp:"sql-altermaterializedview.html",sqlCreateHelp:"sql-creatematerializedview.html",dialogHelp:t("help.static",{filename:"materialized_view_dialog.html"}),label:e("Materialized View"),hasSQL:!0,hasDepends:!0,hasScriptTypes:["create","select"],collection_type:"coll-mview",Init:function(){this.initialized||(this.initialized=!0,o.Browser.add_menu_category("refresh_mview",e("Refresh View"),18,""),a.add_menus([{name:"create_mview_on_coll",node:"coll-mview",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,icon:"wcTabIcon icon-mview",data:{action:"create",check:!0},enable:"canCreate",label:e("Materialized View...")},{name:"create_mview",node:"mview",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,icon:"wcTabIcon icon-mview",data:{action:"create",check:!0},enable:"canCreate",label:e("Materialized View...")},{name:"create_mview",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:18,icon:"wcTabIcon icon-mview",data:{action:"create",check:!1},enable:"canCreate",label:e("Materialized View...")},{name:"refresh_mview_data",node:"mview",module:this,priority:1,callback:"refresh_mview",category:"refresh_mview",applies:["object","context"],label:e("With data"),data:{concurrent:!1,with_data:!0},icon:"fa fa-recycle"},{name:"refresh_mview_nodata",node:"mview",callback:"refresh_mview",priority:2,module:this,category:"refresh_mview",applies:["object","context"],label:e("With no data"),data:{concurrent:!1,with_data:!1},icon:"fa fa-refresh"},{name:"refresh_mview_concurrent",node:"mview",module:this,category:"refresh_mview",enable:"is_version_supported",data:{concurrent:!0,with_data:!0},priority:3,applies:["object","context"],callback:"refresh_mview",label:e("With data (concurrently)"),icon:"fa fa-recycle"},{name:"refresh_mview_concurrent_nodata",node:"mview",module:this,category:"refresh_mview",enable:"is_version_supported",data:{concurrent:!0,with_data:!1},priority:4,applies:["object","context"],callback:"refresh_mview",label:e("With no data (concurrently)"),icon:"fa fa-refresh"}]))},model:a.Node.Model.extend({idAttribute:"oid",initialize:function(e,t){if(0===n.size(e)){var i=t.node_info.schema._label||"public",o=a.serverInfo[t.node_info.server._id].user;this.set({schema:i,owner:o.name},{silent:!0})}a.Node.Model.prototype.initialize.apply(this,arguments)},defaults:{spcname:void 0,toast_autovacuum_enabled:!1,autovacuum_enabled:!1,warn_text:void 0},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"owner",label:e("Owner"),cell:"string",control:"node-list-by-name",select2:{allowClear:!1},node:"role",disabled:"inSchema"},{id:"schema",label:e("Schema"),cell:"string",first_empty:!1,control:"node-list-by-name",type:"text",cache_level:"database",node:"schema",mode:["create","edit"],cache_node:"database",disabled:"inSchema",select2:{allowClear:!1}},{id:"system_view",label:e("System view?"),cell:"string",type:"switch",mode:["properties"]},a.SecurityGroupSchema,{id:"acl",label:e("Privileges"),mode:["properties"],type:"text",group:e("Security")},{id:"comment",label:e("Comment"),cell:"string",type:"multiline"},{id:"definition",label:e("Definition"),cell:"string",type:"text",mode:["create","edit"],group:e("Definition"),tabPanelCodeClass:"sql-code-control",control:r.SqlCodeControl.extend({onChange:function(){r.SqlCodeControl.prototype.onChange.apply(this,arguments),this.model&&this.model.changed&&this.model.origSessAttrs&&this.model.changed.definition!=this.model.origSessAttrs.definition?this.model.warn_text=e("Updating the definition will drop and re-create the materialized view. It may result in loss of information about its dependent objects. Do you want to continue?"):this.model.warn_text=void 0}})},{id:"with_data",label:e("With data?"),group:e("Storage"),mode:["edit","create"],type:"switch"},{id:"spcname",label:e("Tablespace"),cell:"string",type:"text",group:e("Storage"),first_empty:!1,control:"node-list-by-name",node:"tablespace",select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label}},{id:"fillfactor",label:e("Fill factor"),group:e("Storage"),mode:["edit","create"],type:"int",min:10,max:100},{type:"nested",control:"tab",id:"materialization",label:e("Parameter"),mode:["edit","create"],group:e("Parameter"),schema:r.VacuumSettingsSchema},{id:"datacl",label:e("Privileges"),type:"collection",model:a.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),uniqueCol:["grantee"],editable:!1,group:"security",canAdd:!0,canDelete:!0,mode:["edit","create"],control:"unique-col-collection"},{id:"seclabels",label:e("Security labels"),model:a.SecLabelModel,editable:!1,type:"collection",canEdit:!1,group:"security",canDelete:!0,mode:["edit","create"],canAdd:!0,control:"unique-col-collection",uniqueCol:["provider"]}],validate:function(t){var i,o={},l=this.get("name"),a=this.get("definition");return-1!=n.indexOf(t,"autovacuum_enabled")||-1!=n.indexOf(t,"toast_autovacuum_enabled")?null:n.isUndefined(l)||n.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")?(o.name=e("Please specify name."),i=i||o.name,this.errorModel.set("name",i),i):(this.errorModel.unset("name"),n.isUndefined(a)||n.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(o.definition=e("Please enter view definition."),i=i||o.definition,this.errorModel.set("definition",i),i):(this.errorModel.unset("definition"),null))},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)}}),refresh_mview:function(t){var n=t||{},o=a.tree,r=n.item||o.selected(),s=r&&1==r.length?o.itemData(r):void 0;if(!s)return!1;i.ajax({url:this.generate_url(r,"refresh_data",s,!0),type:"PUT",data:{concurrent:t.concurrent,with_data:t.with_data},dataType:"json"}).done((function(t){1==t.success?l.success(e("View refreshed successfully")):l.alert(e("Error refreshing view"),t.data.result)})).fail((function(t,i,n){l.pgRespErrorNotify(t,n,e("Error refreshing view"))}))},is_version_supported:function(e,t){var i=o.Browser.tree,n=t||i.selected(),l=e||(n&&1==n.length?i.itemData(n):void 0),a=this||l&&o.Browser.Nodes[l._type];return a.getTreeNodeHierarchy.apply(a,[n]).server.version>=90400}})),a.Nodes.mview}.apply(t,n))||(e.exports=o)},275:function(e,t,i){"use strict";var n,o;i(28),i(38),i(21),i(34),i(95),i(15),i(11),i(35),i(5),i(59),i(9),i(7),n=[i(276),i(2),i(6),i(0),i(1),i(3),i(10),i(13),i(18),i(30),i(277),i(64),i(45),i(25),i(457),i(458),i(199)],void 0===(o=function(e,t,i,n,o,l,a,r,s,d,c,p,u){return a.Nodes["coll-table"]||(a.Nodes["coll-table"]=a.Collection.extend({node:"table",label:t("Tables"),type:"coll-table",columns:["name","relowner","is_partitioned","description"],hasStatistics:!0,statsPrettifyFields:[t("Size"),t("Indexes size"),t("Table size"),t("TOAST table size"),t("Tuple length"),t("Dead tuple length"),t("Free space")],canDrop:u.isTreeItemOfChildOfSchema,canDropCascade:u.isTreeItemOfChildOfSchema})),a.Nodes.table||(a.Nodes.table=p.SchemaChildNode.extend({type:"table",label:t("Table"),collection_type:"coll-table",hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[t("Size"),t("Indexes size"),t("Table size"),t("TOAST table size"),t("Tuple length"),t("Dead tuple length"),t("Free space")],sqlAlterHelp:"sql-altertable.html",sqlCreateHelp:"sql-createtable.html",dialogHelp:i("help.static",{filename:"table_dialog.html"}),hasScriptTypes:["create","select","insert","update","delete"],width:"650px",Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_table_on_coll",node:"coll-table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:t("Table..."),icon:"wcTabIcon icon-table",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_table",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:1,label:t("Table..."),icon:"wcTabIcon icon-table",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_table__on_schema",node:"schema",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:t("Table..."),icon:"wcTabIcon icon-table",data:{action:"create",check:!1},enable:"canCreate"},{name:"truncate_table",node:"table",module:this,applies:["object","context"],callback:"truncate_table",category:"Truncate",priority:3,label:t("Truncate"),icon:"fa fa-eraser",enable:"canCreate"},{name:"truncate_table_cascade",node:"table",module:this,applies:["object","context"],callback:"truncate_table_cascade",category:"Truncate",priority:3,label:t("Truncate Cascade"),icon:"fa fa-eraser",enable:"canCreate"},{name:"enable_all_triggers",node:"table",module:this,applies:["object","context"],callback:"enable_triggers_on_table",category:"Trigger(s)",priority:4,label:t("Enable All"),icon:"fa fa-check",enable:"canCreate_with_trigger_enable"},{name:"disable_all_triggers",node:"table",module:this,applies:["object","context"],callback:"disable_triggers_on_table",category:"Trigger(s)",priority:4,label:t("Disable All"),icon:"fa fa-times",enable:"canCreate_with_trigger_disable"},{name:"reset_table_stats",node:"table",module:this,applies:["object","context"],callback:"reset_table_stats",category:"Reset",priority:4,label:t("Reset Statistics"),icon:"fa fa-bar-chart",enable:"canCreate"},{name:"count_table_rows",node:"table",module:this,applies:["object","context"],callback:"count_table_rows",category:"Count",priority:2,label:t("Count Rows"),enable:!0}]),a.Events.on("pgadmin:browser:node:table:updated",this.onTableUpdated,this),a.Events.on("pgadmin:browser:node:type:cache_cleared",this.handle_cache,this),a.Events.on("pgadmin:browser:node:domain:cache_cleared",this.handle_cache,this))},callbacks:{enable_triggers_on_table:function(t){e.enableTriggers(a.treeMenu,r,this.generate_url.bind(this),t)},disable_triggers_on_table:function(t){e.disableTriggers(a.treeMenu,r,this.generate_url.bind(this),t)},truncate_table:function(e){this.callbacks.truncate.apply(this,[e,{cascade:!1}])},truncate_table_cascade:function(e){this.callbacks.truncate.apply(this,[e,{cascade:!0}])},truncate:function(e,i){var o=e||{},l=this,s=a.tree,d=o.item||s.selected(),c=d&&1==d.length?s.itemData(d):void 0;if(!c)return!1;r.confirm(t("Truncate Table"),t("Are you sure you want to truncate table %s?",c.label),(function(e){if(e){var t=c;n.ajax({url:l.generate_url(d,"truncate",c,!0),type:"PUT",data:i,dataType:"json"}).done((function(e){1==e.success&&(r.success(e.info),s.removeIcon(d),t.icon=t.is_partitioned?"icon-partition":"icon-table",s.addIcon(d,{icon:t.icon}),s.unload(d),s.setInode(d),s.deselect(d),setTimeout((function(){s.select(d)}),10))})).fail((function(e,t,i){r.pgRespErrorNotify(e,i),s.unload(d)}))}}),(function(){}))},reset_table_stats:function(e){var i=e||{},o=this,l=a.tree,s=i.item||l.selected(),d=s&&1==s.length?l.itemData(s):void 0;if(!d)return!1;r.confirm(t("Reset statistics"),t('Are you sure you want to reset the statistics for table "%s"?',d._label),(function(e){if(e){var t=d;n.ajax({url:o.generate_url(s,"reset",d,!0),type:"DELETE"}).done((function(e){1==e.success&&(r.success(e.info),l.removeIcon(s),t.icon=t.is_partitioned?"icon-partition":"icon-table",l.addIcon(s,{icon:t.icon}),l.unload(s),l.setInode(s),l.deselect(s),setTimeout((function(){l.select(s)}),10))})).fail((function(e,t,i){r.pgRespErrorNotify(e,i),l.unload(s)}))}}),(function(){}))},count_table_rows:function(e){var t=e||{},i=a.tree,o=t.item||i.selected(),l=o&&1==o.length?i.itemData(o):void 0;if(!l)return!1;n.ajax({url:this.generate_url(o,"count_rows",l,!0),type:"GET"}).done((function(e){r.success(e.info),l.rows_cnt=e.data.total_rows,i.unload(o),i.setInode(o),i.deselect(o),setTimeout((function(){i.select(o)}),10)})).fail((function(e,t,n){r.pgRespErrorNotify(e,n),i.unload(o)}))}},model:a.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,spcoid:void 0,spcname:void 0,relowner:void 0,relacl:void 0,relhasoids:void 0,relhassubclass:void 0,reltuples:void 0,description:void 0,conname:void 0,conkey:void 0,isrepl:void 0,triggercount:void 0,relpersistence:void 0,fillfactor:void 0,reloftype:void 0,typname:void 0,labels:void 0,providers:void 0,is_sys_table:void 0,coll_inherits:[],hastoasttable:!0,toast_autovacuum_enabled:!1,autovacuum_enabled:!1,primary_key:[],partitions:[],partition_type:"range",is_partitioned:!1},initialize:function(e,t){if(0===o.size(e)){var i=a.serverInfo[t.node_info.server._id].user,n=t.node_info.schema;this.set({relowner:i.name,schema:n._label},{silent:!0})}a.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:t("Name"),type:"text",mode:["properties","create","edit"],disabled:"inSchema"},{id:"oid",label:t("OID"),type:"text",mode:["properties"]},{id:"relowner",label:t("Owner"),type:"text",node:"role",mode:["properties","create","edit"],select2:{allowClear:!1},disabled:"inSchema",control:"node-list-by-name"},{id:"schema",label:t("Schema"),type:"text",node:"schema",control:"node-list-by-name",mode:["create","edit"],disabled:"inSchema",filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database"},{id:"spcname",label:t("Tablespace"),node:"tablespace",type:"text",control:"node-list-by-name",mode:["properties","create","edit"],filter:function(e){return!(e&&e.label.match(/pg_global/))},deps:["is_partitioned"],disabled:"inSchema"},{id:"partition",type:"group",label:t("Partitions"),mode:["edit","create"],min_version:1e5,visible:function(e){return!(!e.isNew()&&!e.get("is_partitioned"))}},{id:"is_partitioned",label:t("Partitioned table?"),cell:"switch",type:"switch",mode:["properties","create","edit"],visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},readonly:function(e){return!e.isNew()}},{id:"description",label:t("Comment"),type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"},{id:"coll_inherits",label:t("Inherited from table(s)"),url:"get_inherits",type:"array",group:t("Columns"),disabled:"checkInheritance",deps:["typname","is_partitioned"],mode:["create","edit"],first_empty:!1,select2:{multiple:!0,allowClear:!0,first_empty:!1,placeholder:t("Select to inherit from...")},transform:function(e,t){return(t||this).model.inherited_tables_list=e,e},control:s.MultiSelectAjaxControl.extend({onChange:function(){s.MultiSelectAjaxControl.prototype.onChange.apply(this,arguments);var e=this,t=e.model.get("coll_inherits")||[],i=e.model.previous("coll_inherits")||[];if(!o.isUndefined(t)){var n=void 0,l=void 0;t.length>1&&t.length>i.length?(n=o.difference(t,i),l=this.get_table_oid(n[0]),this.add_columns(l)):1==t.length&&(l=this.get_table_oid(t[0]),this.add_columns(l)),t.length>0&&t.length<i.length?(n=o.difference(i,t),this.remove_columns(n[0])):1===i.length&&t.length<1&&(n=i[0],this.remove_columns(n))}},add_columns:function(e){var t,i=(this.model.top||this.model).get("columns"),n={tid:e};t=this.model.fetch_columns_ajax.apply(this,[n]),i.set(t,{merge:!1,remove:!1})},remove_columns:function(e){var t=this.get_table_oid(e),i=this.model.get("columns");i.remove(i.where({inheritedid:t}))},get_table_oid:function(e){var t=void 0;return o.each(this.model.inherited_tables_list,(function(i){i.label===e&&(t=i.tid)})),t}})},{id:"advanced",label:t("Advanced"),type:"group",visible:c.show_advanced_tab},{id:"coll_inherits",label:t("Inherited from table(s)"),type:"text",group:"advanced",mode:["properties"]},{id:"inherited_tables_cnt",label:t("Inherited tables count"),type:"text",mode:["properties"],group:"advanced",disabled:"inSchema"},{id:"columns",label:t("Columns"),type:"collection",group:t("Columns"),model:a.Nodes.column.model,subnode:a.Nodes.column.model,mode:["create","edit"],disabled:function(e){return e.isNew()&&e.get("is_partitioned")&&setTimeout((function(){var t=e.get("columns");t.remove(t.filter((function(e){return!o.isUndefined(e.get("inheritedfrom"))})))}),10),!!(this.node_info&&"catalog"in this.node_info)},deps:["typname","is_partitioned"],canAdd:"check_grid_add_condition",canEdit:!0,canDelete:!0,canEditRow:"check_grid_row_edit_delete",canDeleteRow:"check_grid_row_edit_delete",uniqueCol:["name"],columns:["name","cltype","attlen","attprecision","attnotnull","is_primary_key"],control:s.UniqueColCollectionControl.extend({initialize:function(){s.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var e=this,t=e.model.get(e.field.get("name"));t.on("change:is_primary_key",(function(t){var i,n,l=e.model.get("primary_key"),a=t.get("name");if(t.get("is_primary_key")){if(l.length<1?(i=new l.model({},{top:e.model,collection:l,handler:l}),l.add(i)):i=l.first(),o.isUndefined(i.get("oid"))){if(0==(n=i.get("columns")).where({column:a}).length){var r=new n.model({column:a},{silent:!0,top:e.model,collection:l,handler:l});n.add(r)}n.trigger("pgadmin:multicolumn:updated",n)}}else if(l.length>0){if(i=l.first(),!o.isUndefined(i.get("oid")))return;var s=(n=i.get("columns")).where({column:a});s.length>0&&(n.remove(s),o.each(s,(function(e){e.destroy()})),0==n.length&&l.remove(l.first())),n.trigger("pgadmin:multicolumn:updated",n)}}))},remove:function(){var e=this.model.get(this.field.get("name"));e&&e.off("change:is_primary_key"),s.UniqueColCollectionControl.prototype.remove.apply(this,arguments)}}),allowMultipleEmptyRow:!1},{type:"nested",control:"tab",group:t("Constraints"),mode:["edit","create"],schema:[{id:"primary_key",label:"",model:a.Nodes.primary_key.model,subnode:a.Nodes.primary_key.model,editable:!1,type:"collection",group:t("Primary Key"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function(e){return!(e.get("is_partitioned")&&!o.isUndefined(e.top.node_info)&&!o.isUndefined(e.top.node_info.server)&&!o.isUndefined(e.top.node_info.server.version)&&e.top.node_info.server.version<11e4)||(setTimeout((function(){var t=e.get("primary_key");t.remove(t.filter((function(){return!0})))}),10),!1)},canAddRow:function(e){var t=e.get("columns");return e.get("primary_key")&&e.get("primary_key").length<1&&o.some(t.pluck("name"))}},{id:"foreign_key",label:"",model:a.Nodes.foreign_key.model,subnode:a.Nodes.foreign_key.model,editable:!1,type:"collection",group:t("Foreign Key"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",canAdd:function(e){return!(e.get("is_partitioned")&&!o.isUndefined(e.top.node_info)&&!o.isUndefined(e.top.node_info.server)&&!o.isUndefined(e.top.node_info.server.version)&&e.top.node_info.server.version<11e4)||(setTimeout((function(){var t=e.get("foreign_key");t.remove(t.filter((function(){return!0})))}),10),!1)},columns:["name","columns"],canAddRow:function(e){var t=e.get("columns");return o.some(t.pluck("name"))}},{id:"check_constraint",label:"",model:a.Nodes.check_constraint.model,subnode:a.Nodes.check_constraint.model,editable:!1,type:"collection",group:t("Check"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",canAdd:!0,columns:["name","consrc"]},{id:"unique_constraint",label:"",model:a.Nodes.unique_constraint.model,subnode:a.Nodes.unique_constraint.model,editable:!1,type:"collection",group:t("Unique"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function(e){return!(e.get("is_partitioned")&&!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version<11e4)||(setTimeout((function(){var t=e.get("unique_constraint");t.remove(t.filter((function(){return!0})))}),10),!1)},canAddRow:function(e){var t=e.get("columns");return o.some(t.pluck("name"))}},{id:"exclude_constraint",label:"",model:a.Nodes.exclusion_constraint.model,subnode:a.Nodes.exclusion_constraint.model,editable:!1,type:"collection",group:t("Exclude"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns","constraint"],canAdd:function(e){return!e.get("is_partitioned")||(setTimeout((function(){var t=e.get("exclude_constraint");t.remove(t.filter((function(){return!0})))}),10),!1)},canAddRow:function(e){var t=e.get("columns");return o.some(t.pluck("name"))}}]},{id:"typname",label:t("Of type"),type:"text",mode:["properties","create","edit"],disabled:"checkOfType",url:"get_oftype",group:t("advanced"),deps:["coll_inherits"],transform:function(e,t){return(t||this).model.of_types_tables=e,e},control:s.NodeAjaxOptionsControl.extend({onChange:function(){s.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var e=this,i=e.model.get("typname"),n=void 0,l=void 0,a=e.model.get("columns");if(o.isUndefined(i)||o.isNull(i)||""===i||0===a.length)o.isUndefined(i)||""!==i||a.remove(a.filter((function(){return!0})));else{var d=t("Remove column definitions?"),c=t("Changing 'Of type' will remove column definitions.");r.confirm(d,c,(function(){a.remove(a.filter((function(){return!0})))}),(function(){setTimeout((function(){e.model.set("typname",null)}),10)}))}o.isUndefined(i)||""===i||(l={tname:i},n=e.model.fetch_columns_ajax.apply(e,[l]),a.set(n,{merge:!1,remove:!1}))}})},{id:"fillfactor",label:t("Fill factor"),type:"int",mode:["create","edit"],min:10,max:100,group:t("advanced"),disabled:function(e){return!!e.get("is_partitioned")||e.inSchema()}},{id:"relhasoids",label:t("Has OIDs?"),cell:"switch",type:"switch",mode:["properties","create","edit"],group:t("advanced"),disabled:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=12e4||e.inSchema()}},{id:"relpersistence",label:t("Unlogged?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:t("advanced")},{id:"conname",label:t("Primary key"),cell:"string",type:"text",mode:["properties"],group:t("advanced"),disabled:"inSchema"},{id:"reltuples",label:t("Rows (estimated)"),cell:"string",type:"text",mode:["properties"],group:t("advanced"),disabled:"inSchema"},{id:"rows_cnt",label:t("Rows (counted)"),cell:"string",type:"text",mode:["properties"],group:t("advanced"),disabled:"inSchema",control:s.InputControl.extend({formatter:{fromRaw:function(e){var t=l.Browser.tree,i=t.selected(),n=i&&1==i.length?t.itemData(i):void 0;return n&&n.rows_cnt&&parseInt(n.rows_cnt,10)>0?n.rows_cnt:e},toRaw:function(e){return e}}})},{id:"relhassubclass",label:t("Inherits tables?"),cell:"switch",type:"switch",mode:["properties"],group:t("advanced"),disabled:"inSchema"},{id:"is_sys_table",label:t("System table?"),cell:"switch",type:"switch",mode:["properties"],disabled:"inSchema"},{type:"nested",control:"fieldset",label:t("Like"),group:t("advanced"),schema:[{id:"like_relation",label:t("Relation"),type:"text",mode:["create","edit"],deps:["typname"],control:"node-ajax-options",url:"get_relations",disabled:"isLikeDisable",group:t("Like")},{id:"like_default_value",label:t("With default values?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:t("Like")},{id:"like_constraints",label:t("With constraints?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:t("Like")},{id:"like_indexes",label:t("With indexes?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:t("Like")},{id:"like_storage",label:t("With storage?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:t("Like")},{id:"like_comments",label:t("With comments?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:t("Like")}]},{id:"partition_type",label:t("Partition Type"),editable:!1,type:"select2",select2:{allowClear:!1},group:"partition",deps:["is_partitioned"],options:function(){var e=[{label:t("Range"),value:"range"},{label:t("List"),value:"list"}];return!o.isUndefined(this.node_info)&&!o.isUndefined(this.node_info.server)&&!o.isUndefined(this.node_info.server.version)&&this.node_info.server.version>=11e4&&e.push({label:t("Hash"),value:"hash"}),e},mode:["create"],visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){return!e.get("is_partitioned")},readonly:function(e){return!e.isNew()}},{id:"partition_keys",label:t("Partition Keys"),model:s.PartitionKeyModel,subnode:s.PartitionKeyModel,editable:!0,type:"collection",group:"partition",mode:["create"],deps:["is_partitioned","partition_type","typname"],canEdit:!1,canDelete:!0,control:"sub-node-collection",canAdd:function(e){return!(!e.isNew()||!e.get("is_partitioned"))},canAddRow:function(e){var t=e.get("columns"),i=e.get("typname"),n=!1,l=1e3;return e.get("partition_type")&&"list"==e.get("partition_type")&&(l=1),t.length<=0&&!o.isUndefined(i)&&!o.isNull(i)&&e.of_types_tables.length>0?o.each(e.of_types_tables,(function(e){e.label==i&&e.oftype_columns.length>0&&(n=!0)})):t.length>0&&(n=o.some(t.pluck("name"))),e.get("partition_keys")&&e.get("partition_keys").length<l&&n},visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.get("partition_keys")&&e.get("partition_keys").models.length>0&&setTimeout((function(){var t=e.get("partition_keys");t.remove(t.filter((function(){return!0})))}),10)}},{id:"partition_scheme",label:t("Partition Scheme"),type:"note",group:"partition",mode:["edit"],visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.isNew()||(this.text=e.get("partition_scheme"))}},{id:"partition_key_note",label:t("Partition Keys"),type:"note",group:"partition",mode:["create"],text:["<ul><li>",t("Partition table supports two types of keys:"),"</li><li>","<strong>",t("Column: "),"</strong>",t("User can select any column from the list of available columns."),"</li><li>","<strong>",t("Expression: "),"</strong>",t("User can specify expression to create partition key."),"</li><li>","<strong>",t("Example: "),"</strong>",t("Let's say, we want to create a partition table based per year for the column 'saledate', having datatype 'date/timestamp', then we need to specify the expression as 'extract(YEAR from saledate)' as partition key."),"</li></ul>"].join(""),visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5}},{id:"partitions",label:t("Partitions"),model:s.PartitionsModel,subnode:s.PartitionsModel,editable:!0,type:"collection",group:"partition",mode:["edit","create"],deps:["is_partitioned","partition_type","typname"],canEdit:!0,canDelete:!0,customDeleteTitle:t("Detach Partition"),customDeleteMsg:t("Are you sure you wish to detach this partition?"),columns:["is_attach","partition_name","is_default","values_from","values_to","values_in","values_modulus","values_remainder"],control:s.SubNodeCollectionControl.extend({row:d.PartitionRow,initialize:function(){s.SubNodeCollectionControl.prototype.initialize.apply(this,arguments);var e=this;if(!this.model.isNew()){var i=this.field.get("schema_node"),o=this.field.get("node_info");n.ajax({url:i.generate_url.apply(i,[null,"get_attach_tables",this.field.get("node_data"),!0,o]),type:"GET",async:!1}).done((function(i){1==i.success?e.model.table_options=i.data:r.alert(t("Error fetching tables to be attached"),i.data.result)})).fail((function(e,t,i){r.pgRespErrorNotify(e,i)}))}}}),canAdd:function(e){return!!e.get("is_partitioned")},visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.isNew()&&e.get("partitions")&&e.get("partitions").models.length>0&&setTimeout((function(){var t=e.get("partitions");t.remove(t.filter((function(){return!0})))}),10)}},{id:"partition_note",label:t("Partitions"),type:"note",group:"partition",text:["<ul><li>","<strong>",t("Create a table: "),"</strong>",t("User can create multiple partitions while creating new partitioned table. Operation switch is disabled in this scenario."),"</li><li>","<strong>",t("Edit existing table: "),"</strong>",t("User can create/attach/detach multiple partitions. In attach operation user can select table from the list of suitable tables to be attached."),"</li><li>","<strong>",t("Default: "),"</strong>",t("The default partition can store rows that do not fall into any existing partition’s range or list."),"</li><li>","<strong>",t("From/To/In input: "),"</strong>",t("From/To/In input: Values for these fields must be quoted with single quote. For more than one partition key values must be comma(,) separated."),"</li><li>","<strong>",t("Example: From/To: "),"</strong>",t("Enabled for range partition. Consider partitioned table with multiple keys of type Integer, then values should be specified like '100','200'."),"</li><li>","<strong>",t("In: "),"</strong>",t("Enabled for list partition. Values must be comma(,) separated and quoted with single quote."),"</li><li>","<strong>",t("Modulus/Remainder: "),"</strong>",t("Enabled for hash partition."),"</li></ul>"].join(""),visible:function(e){return!o.isUndefined(e.node_info)&&!o.isUndefined(e.node_info.server)&&!o.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5}},{type:"nested",control:"tab",group:t("Parameters"),mode:["edit","create"],deps:["is_partitioned"],schema:s.VacuumSettingsSchema},{id:"relacl_str",label:t("Privileges"),disabled:"inSchema",type:"text",mode:["properties"],group:t("Security")},a.SecurityGroupSchema,{id:"relacl",label:t("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:a.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"seclabels",label:t("Security labels"),canEdit:!1,model:a.SecLabelModel,editable:!1,canAdd:!0,type:"collection",min_version:90100,mode:["edit","create"],group:"security",canDelete:!0,control:"unique-col-collection"},{id:"vacuum_settings_str",label:t("Storage settings"),type:"multiline",group:"advanced",mode:["properties"]}],validate:function(){var e,i=this.get("name"),n=this.get("schema"),l=this.get("relowner"),a=this.get("is_partitioned"),r=this.get("partition_keys");return o.isUndefined(i)||o.isNull(i)||""==String(i).replace(/^\s+|\s+$/g,"")?(e=t("Table name cannot be empty."),this.errorModel.set("name",e),e):(this.errorModel.unset("name"),o.isUndefined(n)||o.isNull(n)||""==String(n).replace(/^\s+|\s+$/g,"")?(e=t("Table schema cannot be empty."),this.errorModel.set("schema",e),e):(this.errorModel.unset("schema"),o.isUndefined(l)||o.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")?(e=t("Table owner cannot be empty."),this.errorModel.set("relowner",e),e):(this.errorModel.unset("relowner"),a&&this.isNew()&&!o.isNull(r)&&r.length<=0?(e=t("Please specify at least one key for partitioned table."),this.errorModel.set("partition_keys",e),e):(this.errorModel.unset("partition_keys"),null))))},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},isInheritedTable:function(e){return!e.inSchema.apply(this,[e])&&!(!o.isUndefined(e.get("coll_inherits"))&&0!=e.get("coll_inherits").length||!o.isUndefined(e.get("typname"))&&""!==String(e.get("typname")).replace(/^\s+|\s+$/g,""))},checkInheritance:function(e){return e.get("is_partitioned")?(setTimeout((function(){e.set("coll_inherits",[])}),10),!0):!(!e.inSchema.apply(this,[e])&&(o.isUndefined(e.get("typname"))||o.isNull(e.get("typname"))||""==String(e.get("typname")).replace(/^\s+|\s+$/g,"")))},isLikeDisable:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&(o.isUndefined(e.get("typname"))||o.isNull(e.get("typname"))||""==String(e.get("typname")).replace(/^\s+|\s+$/g,"")))},check_grid_add_condition:function(e){var t=!0;return e.inSchema.apply(this,[e])||o.isUndefined(e.get("typname"))||o.isNull(e.get("typname"))||""===e.get("typname")||(t=!1),t},check_grid_row_edit_delete:function(e){var t=!0;return o.isUndefined(e.get("inheritedfrom"))||o.isNull(e.get("inheritedfrom"))||""===String(e.get("inheritedfrom")).replace(/^\s+|\s+$/g,"")||(t=!1),t},checkOfType:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&(o.isUndefined(e.get("coll_inherits"))||o.isNull(e.get("coll_inherits"))||""==String(e.get("coll_inherits")).replace(/^\s+|\s+$/g,"")))},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},isTableAutoVacuumEnable:function(e){return!(!e.inSchema.apply(this,[e])&&!0===e.get("autovacuum_enabled"))},isToastTableAutoVacuumEnable:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&1==e.get("toast_autovacuum_enabled"))},fetch_columns_ajax:function(e){var t=this,i="get_columns",o=t.model.top||t.model,l=void 0,r=this.field.get("schema_node"),s=this.field.get("node_info"),d=r.generate_url.apply(r,[null,i,this.field.get("node_data"),this.field.get("url_with_id")||!1,s]),c=this.field.get("cache_level")||r.type,p=this.field.get("cache_node");return p=p&&a.Nodes[p]||r,o.trigger("pgadmin:view:fetching",o,t.field),n.ajax({async:!1,url:d,data:e}).done((function(e){l=p.cache(i,s,c,e.data)})).fail((function(){o.trigger("pgadmin:view:fetch:error",o,t.field)})),o.trigger("pgadmin:view:fetched",o,t.field),l=l&&l.data||[]}}),canCreate_with_trigger_enable:function(e,t,i){return e.tigger_count>0&&this.canCreate.apply(this,[e,t,i])},canCreate_with_trigger_disable:function(e,t,i){return e.tigger_count>0&&e.has_enable_triggers>0&&this.canCreate.apply(this,[e,t,i])},onTableUpdated:function(e,t,i){var n,r;if(i.is_partitioned&&"affected_partitions"in i){var s,d=i.affected_partitions,c=[],p=[];if("detached"in d&&d.detached.length>0){a.removeChildTreeNodesById(e,"coll-partition",o.map(d.detached,(function(e){return parseInt(e.oid)}))),s=a.findParentTreeNodeByType(e,"schema");var u=o.groupBy(d.detached,(function(e){return parseInt(e.schema_id)}));for(n in u)if(s=a.findSiblingTreeNode(s,n)){r=o.map(u[n],(function(e){return parseInt(e.oid)}));var m=a.findChildCollectionTreeNode(s,"coll-table");m&&p.push({parent:m,type:"table",treeHierarchy:l.Browser.Nodes.schema.getTreeNodeHierarchy(s),childrenIDs:o.clone(r)})}}if("attached"in d&&d.attached.length>0){s=a.findParentTreeNodeByType(e,"schema");var h=o.groupBy(d.attached,(function(e){return parseInt(e.schema_id)}));for(n in h)(s=a.findSiblingTreeNode(s,n))&&(r=o.map(h[n],(function(e){return parseInt(e.oid)})),a.removeChildTreeNodesById(s,"coll-table",r)),c=c.concat(r)}if("created"in d&&d.created.length>0&&o.each(d.created,(function(e){c.push(e.oid)})),c.length){var g=a.findChildCollectionTreeNode(e,"coll-partition");g&&p.push({parent:g,type:"partition",treeHierarchy:this.getTreeNodeHierarchy(e),childrenIDs:c})}!function e(){if(p.length){var t=p.pop();a.addChildTreeNodes(t.treeHierarchy,t.parent,t.type,t.childrenIDs,e)}}()}},handle_cache:function(){this.clear_cache.apply(this,null)}})),a.Nodes.table}.apply(t,n))||(e.exports=o)},278:function(e,t,i){"use strict";var n,o;i(38),i(16),i(21),i(95),i(11),i(5),i(59),i(9),i(7),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(13),i(18),i(30),i(45),i(22),i(25),i(199)],void 0===(o=function(e,t,i,n,o,l,a,r,s,d,c){return l.Nodes["coll-partition"]||(o.Browser.Nodes["coll-partition"]=o.Browser.Collection.extend({node:"partition",label:e("Partitions"),type:"coll-partition",columns:["name","schema","partition_value","is_partitioned","description"],canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema})),l.Nodes.partition||(o.Browser.Nodes.partition=l.Node.extend({parent_type:"table",collection_type:"coll-partition",type:"partition",label:e("Partition"),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[e("Size"),e("Indexes size"),e("Table size"),e("TOAST table size"),e("Tuple length"),e("Dead tuple length"),e("Free space")],sqlAlterHelp:"sql-altertable.html",sqlCreateHelp:"sql-createtable.html",dialogHelp:t("help.static",{filename:"table_dialog.html"}),hasScriptTypes:["create"],width:"650px",Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"truncate_table",node:"partition",module:this,applies:["object","context"],callback:"truncate_table",category:"Truncate",priority:3,label:e("Truncate"),icon:"fa fa-eraser",enable:"canCreate"},{name:"truncate_table_cascade",node:"partition",module:this,applies:["object","context"],callback:"truncate_table_cascade",category:"Truncate",priority:3,label:e("Truncate Cascade"),icon:"fa fa-eraser",enable:"canCreate"},{name:"enable_all_triggers",node:"partition",module:this,applies:["object","context"],callback:"enable_triggers_on_table",category:"Trigger(s)",priority:4,label:e("Enable All"),icon:"fa fa-check",enable:"canCreate_with_trigger_enable"},{name:"disable_all_triggers",node:"partition",module:this,applies:["object","context"],callback:"disable_triggers_on_table",category:"Trigger(s)",priority:4,label:e("Disable All"),icon:"fa fa-times",enable:"canCreate_with_trigger_disable"},{name:"reset_table_stats",node:"partition",module:this,applies:["object","context"],callback:"reset_table_stats",category:"Reset",priority:4,label:e("Reset Statistics"),icon:"fa fa-bar-chart",enable:"canCreate"},{name:"detach_partition",node:"partition",module:this,applies:["object","context"],callback:"detach_partition",priority:2,label:e("Detach Partition"),icon:"fa fa-remove"}]))},generate_url:function(e,t,i,o,a){return-1==n.indexOf(["stats","statistics","dependency","dependent","reset","get_relations","get_oftype","get_attach_tables"],t)?l.Node.generate_url.apply(this,arguments):("statistics"==t&&(t="stats"),a=n.isUndefined(e)||n.isNull(e)?a||{}:this.getTreeNodeHierarchy(e),c.sprintf("table/%s/%s/%s/%s/%s/%s",encodeURIComponent(t),encodeURIComponent(a.server_group._id),encodeURIComponent(a.server._id),encodeURIComponent(a.database._id),encodeURIComponent(a.partition.schema_id),encodeURIComponent(a.partition._id)))},canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:d.isTreeItemOfChildOfSchema,callbacks:{enable_triggers_on_table:function(e){this.callbacks.set_triggers.apply(this,[e,{enable:!0}])},disable_triggers_on_table:function(e){this.callbacks.set_triggers.apply(this,[e,{enable:!1}])},set_triggers:function(e,t){var n=e||{},o=l.tree,r=n.item||o.selected(),s=r&&1==r.length?o.itemData(r):void 0;if(!s)return!1;i.ajax({url:this.generate_url(r,"set_trigger",s,!0),type:"PUT",data:t,dataType:"json"}).done((function(e){1==e.success&&(a.success(e.info),o.unload(r),o.setInode(r),o.deselect(r),setTimeout((function(){o.select(r)}),10))})).fail((function(e,t,i){a.pgRespErrorNotify(e,i),o.unload(r)}))},truncate_table:function(e){this.callbacks.truncate.apply(this,[e,{cascade:!1}])},truncate_table_cascade:function(e){this.callbacks.truncate.apply(this,[e,{cascade:!0}])},truncate:function(t,n){var o=t||{},r=this,s=l.tree,d=o.item||s.selected(),c=d&&1==d.length?s.itemData(d):void 0;if(!c)return!1;a.confirm(e("Truncate Table"),e("Are you sure you want to truncate table %s?",c.label),(function(e){if(e){var t=c;i.ajax({url:r.generate_url(d,"truncate",c,!0),type:"PUT",data:n,dataType:"json"}).done((function(e){1==e.success&&(a.success(e.info),s.removeIcon(d),t.icon="icon-partition",s.addIcon(d,{icon:t.icon}),s.unload(d),s.setInode(d),s.deselect(d),setTimeout((function(){s.select(d)}),10))})).fail((function(e,t,i){a.pgRespErrorNotify(e,i),s.unload(d)}))}}),(function(){}))},reset_table_stats:function(t){var n=t||{},o=this,r=l.tree,s=n.item||r.selected(),d=s&&1==s.length?r.itemData(s):void 0;if(!d)return!1;a.confirm(e("Reset statistics"),e('Are you sure you want to reset the statistics for table "%s"?',d._label),(function(e){if(e){var t=d;i.ajax({url:o.generate_url(s,"reset",d,!0),type:"DELETE"}).done((function(e){1==e.success&&(a.success(e.info),r.removeIcon(s),t.icon="icon-partition",r.addIcon(s,{icon:t.icon}),r.unload(s),r.setInode(s),r.deselect(s),setTimeout((function(){r.select(s)}),10))})).fail((function(e,t,i){a.pgRespErrorNotify(e,i),r.unload(s)}))}}),(function(){}))},detach_partition:function(t){var n=t||{},o=this,r=l.tree,s=n.item||r.selected(),d=s&&1==s.length?r.itemData(s):void 0;if(!d)return!1;a.confirm(e("Detach Partition"),e("Are you sure you want to detach the partition %s?",d._label),(function(e){e&&i.ajax({url:o.generate_url(s,"detach",d,!0),type:"PUT"}).done((function(e){if(1==e.success){a.success(e.info);var t=r.next(s);t&&t.length||(t=r.prev(s))&&t.length||(t=r.parent(s),r.setInode(t,!0)),r.remove(s),t.length&&r.select(t)}})).fail((function(e,t,i){a.pgRespErrorNotify(e,i)}))}),(function(){}))}},model:l.Node.Model.extend({defaults:{name:void 0,oid:void 0,spcoid:void 0,spcname:void 0,relowner:void 0,relacl:void 0,relhasoids:void 0,relhassubclass:void 0,reltuples:void 0,description:void 0,conname:void 0,conkey:void 0,isrepl:void 0,triggercount:void 0,relpersistence:void 0,fillfactor:void 0,reloftype:void 0,typname:void 0,labels:void 0,providers:void 0,is_sys_table:void 0,coll_inherits:[],hastoasttable:!0,toast_autovacuum_enabled:!1,autovacuum_enabled:!1,primary_key:[],partitions:[],partition_type:"range",is_partitioned:!1,partition_value:void 0},initialize:function(e,t){if(0===n.size(e)){var i=l.serverInfo[t.node_info.server._id].user,o=t.node_info.schema;this.set({relowner:i.name,schema:o._label},{silent:!0})}l.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"],disabled:"inSchema"},{id:"oid",label:e("OID"),type:"text",mode:["properties"]},{id:"relowner",label:e("Owner"),type:"text",node:"role",mode:["properties","create","edit"],select2:{allowClear:!1},disabled:"inSchema",control:"node-list-by-name"},{id:"schema",label:e("Schema"),type:"text",node:"schema",control:"node-list-by-name",mode:["create","edit","properties"],disabled:"inSchema",filter:function(e){return!e||!e.label.match(/^pg_/)},cache_node:"database",cache_level:"database"},{id:"spcname",label:e("Tablespace"),node:"tablespace",type:"text",control:"node-list-by-name",disabled:"inSchema",mode:["properties","create","edit"],filter:function(e){return!(e&&e.label.match(/pg_global/))}},{id:"partition",type:"group",label:e("Partition"),mode:["edit","create"],min_version:1e5,visible:function(e){return!(!e.isNew()&&!e.get("is_partitioned"))}},{id:"is_partitioned",label:e("Partitioned table?"),cell:"switch",type:"switch",mode:["properties","create","edit"],visible:function(e){return!n.isUndefined(e.node_info)&&!n.isUndefined(e.node_info.server)&&!n.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},readonly:function(e){return!e.isNew()}},{id:"description",label:e("Comment"),type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"},{id:"partition_value",label:e("Partition Scheme"),type:"text",visible:!1},{id:"coll_inherits",label:e("Inherited from table(s)"),type:"text",group:e("Advanced"),mode:["properties"]},{id:"Columns",type:"group",label:e("Columns"),mode:["edit","create"],min_version:1e5,visible:function(){return!1}},{id:"columns",label:e("Columns"),type:"collection",group:e("Columns"),model:l.Nodes.column.model,subnode:l.Nodes.column.model,mode:["create","edit"],disabled:function(e){return e.isNew()&&e.get("is_partitioned")&&setTimeout((function(){var t=e.get("columns");t.remove(t.filter((function(e){return!n.isUndefined(e.get("inheritedfrom"))})))}),10),!!(this.node_info&&"catalog"in this.node_info)},deps:["typname","is_partitioned"],canAdd:"check_grid_add_condition",canEdit:!0,canDelete:!0,canEditRow:"check_grid_row_edit_delete",canDeleteRow:"check_grid_row_edit_delete",uniqueCol:["name"],columns:["name","cltype","attlen","attprecision","attnotnull","is_primary_key"],control:r.UniqueColCollectionControl.extend({initialize:function(){r.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var e=this,t=e.model.get(e.field.get("name"));t.on("change:is_primary_key",(function(t){var i,o,l=e.model.get("primary_key"),a=t.get("name");if(t.get("is_primary_key")){if(l.length<1?(i=new l.model({},{top:e.model,collection:l,handler:l}),l.add(i)):i=l.first(),n.isUndefined(i.get("oid"))){if(0==(o=i.get("columns")).where({column:a}).length){var r=new o.model({column:a},{silent:!0,top:e.model,collection:l,handler:l});o.add(r)}o.trigger("pgadmin:multicolumn:updated",o)}}else if(l.length>0){if(i=l.first(),!n.isUndefined(i.get("oid")))return;var s=(o=i.get("columns")).where({column:a});s.length>0&&(o.remove(s),n.each(s,(function(e){e.destroy()})),0==o.length&&setTimeout((function(){l.remove(l.first())}),10)),o.trigger("pgadmin:multicolumn:updated",o)}}))},remove:function(){var e=this.model.get(this.field.get("name"));e&&e.off("change:is_primary_key"),r.UniqueColCollectionControl.prototype.remove.apply(this,arguments)}}),allowMultipleEmptyRow:!1},{id:"inherited_tables_cnt",label:e("Inherited tables count"),type:"text",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{type:"nested",control:"tab",group:e("Constraints"),mode:["edit","create"],schema:[{id:"primary_key",label:e("Primary key"),model:l.Nodes.primary_key.model,subnode:l.Nodes.primary_key.model,editable:!1,type:"collection",group:e("Primary Key"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function(e){return!(e.get("is_partitioned")&&!n.isUndefined(e.top.node_info)&&!n.isUndefined(e.top.node_info.server)&&!n.isUndefined(e.top.node_info.server.version)&&e.top.node_info.server.version<11e4)||(setTimeout((function(){var t=e.get("primary_key");t.remove(t.filter((function(){return!0})))}),10),!1)},canAddRow:function(e){var t=e.get("columns");return e.get("primary_key")&&e.get("primary_key").length<1&&n.some(t.pluck("name"))}},{id:"foreign_key",label:e("Foreign key"),model:l.Nodes.foreign_key.model,subnode:l.Nodes.foreign_key.model,editable:!1,type:"collection",group:e("Foreign Key"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",canAdd:function(e){return!e.get("is_partitioned")||(setTimeout((function(){var t=e.get("foreign_key");t.remove(t.filter((function(){return!0})))}),10),!1)},columns:["name","columns"],canAddRow:function(e){var t=e.get("columns");return n.some(t.pluck("name"))}},{id:"check_constraint",label:e("Check constraint"),model:l.Nodes.check_constraint.model,subnode:l.Nodes.check_constraint.model,editable:!1,type:"collection",group:e("Check"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",canAdd:!0,columns:["name","consrc"]},{id:"unique_constraint",label:e("Unique Constraint"),model:l.Nodes.unique_constraint.model,subnode:l.Nodes.unique_constraint.model,editable:!1,type:"collection",group:e("Unique"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns"],canAdd:function(e){return!e.get("is_partitioned")||(setTimeout((function(){var t=e.get("unique_constraint");t.remove(t.filter((function(){return!0})))}),10),!1)},canAddRow:function(e){var t=e.get("columns");return n.some(t.pluck("name"))}},{id:"exclude_constraint",label:e("Exclude constraint"),model:l.Nodes.exclusion_constraint.model,subnode:l.Nodes.exclusion_constraint.model,editable:!1,type:"collection",group:e("Exclude"),mode:["edit","create"],canEdit:!0,canDelete:!0,deps:["is_partitioned"],control:"unique-col-collection",columns:["name","columns","constraint"],canAdd:function(e){return!e.get("is_partitioned")||(setTimeout((function(){var t=e.get("exclude_constraint");t.remove(t.filter((function(){return!0})))}),10),!1)},canAddRow:function(e){var t=e.get("columns");return n.some(t.pluck("name"))}}]},{id:"typname",label:e("Of type"),type:"text",mode:["properties","create","edit"],group:e("Advanced"),disabled:"checkOfType",url:"get_oftype",deps:["coll_inherits","is_partitioned"],transform:function(e,t){return(t||this).model.of_types_tables=e,e},control:r.NodeAjaxOptionsControl.extend({onChange:function(){r.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var t=this,i=t.model.get("typname"),o=void 0,l=void 0,s=t.model.get("columns");if(n.isUndefined(i)||""===i||0===s.length)n.isUndefined(i)||""!==i||s.reset();else{var d=e("Changing of table type will clear columns collection.");a.confirm(d,(function(e){if(!e)return this;s.reset()}))}n.isUndefined(i)||""===i||(l={tname:i},o=t.model.fetch_columns_ajax.apply(t,[l]),s.set(o,{merge:!1,remove:!1}))}})},{id:"fillfactor",label:e("Fill factor"),type:"int",mode:["create","edit"],min:10,max:100,group:e("Advanced"),disabled:function(e){return!!e.get("is_partitioned")||e.inSchema()}},{id:"relhasoids",label:e("Has OIDs?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:!0,group:e("Advanced")},{id:"relpersistence",label:e("Unlogged?"),cell:"switch",type:"switch",mode:["properties","create","edit"],disabled:"inSchemaWithModelCheck",group:e("Advanced")},{id:"conname",label:e("Primary key"),cell:"string",type:"text",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{id:"reltuples",label:e("Rows (estimated)"),cell:"string",type:"text",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{id:"rows_cnt",label:e("Rows (counted)"),cell:"string",type:"text",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{id:"relhassubclass",label:e("Inherits tables?"),cell:"switch",type:"switch",mode:["properties"],group:e("Advanced"),disabled:"inSchema"},{id:"is_sys_table",label:e("System table?"),cell:"switch",type:"switch",mode:["properties"],disabled:"inSchema"},{type:"nested",control:"fieldset",label:e("Like"),group:e("Advanced"),schema:[{id:"like_relation",label:e("Relation"),type:"text",mode:["create","edit"],deps:["typname"],control:"node-ajax-options",url:"get_relations",disabled:"isLikeDisable",group:e("Like")},{id:"like_default_value",label:e("With default values?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")},{id:"like_constraints",label:e("With constraints?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")},{id:"like_indexes",label:e("With indexes?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")},{id:"like_storage",label:e("With storage?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")},{id:"like_comments",label:e("With comments?"),type:"switch",mode:["create","edit"],deps:["typname"],disabled:"isLikeDisable",group:e("Like")}]},{id:"partition_type",label:e("Partition Type"),editable:!1,type:"select2",select2:{allowClear:!1},group:"partition",deps:["is_partitioned"],options:[{label:e("Range"),value:"range"},{label:e("List"),value:"list"}],mode:["create"],visible:function(e){return!n.isUndefined(e.node_info)&&!n.isUndefined(e.node_info.server)&&!n.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},readonly:function(e){return!e.isNew()},disabled:function(e){return!e.get("is_partitioned")}},{id:"partition_keys",label:e("Partition Keys"),model:r.PartitionKeyModel,subnode:r.PartitionKeyModel,editable:!0,type:"collection",group:"partition",mode:["create"],deps:["is_partitioned","partition_type"],canEdit:!1,canDelete:!0,control:"sub-node-collection",canAdd:function(e){return!(!e.isNew()||!e.get("is_partitioned"))},canAddRow:function(e){var t=e.get("columns"),i=1e3;return e.get("partition_type")&&"list"==e.get("partition_type")&&(i=1),e.get("partition_keys")&&e.get("partition_keys").length<i&&n.some(t.pluck("name"))},visible:function(e){return!n.isUndefined(e.node_info)&&!n.isUndefined(e.node_info.server)&&!n.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.get("partition_keys")&&e.get("partition_keys").models.length>0&&setTimeout((function(){var t=e.get("partition_keys");t.remove(t.filter((function(){return!0})))}),10)}},{id:"partition_scheme",label:e("Partition Scheme"),type:"note",group:"partition",mode:["edit"],visible:function(e){return!n.isUndefined(e.node_info)&&!n.isUndefined(e.node_info.server)&&!n.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.isNew()||(this.text=e.get("partition_scheme"))}},{id:"partitions",label:e("Partitions"),model:r.PartitionsModel,subnode:r.PartitionsModel,editable:!0,type:"collection",group:"partition",mode:["edit","create"],deps:["is_partitioned","partition_type"],canEdit:!0,canDelete:!0,customDeleteTitle:e("Detach Partition"),customDeleteMsg:e("Are you sure you wish to detach this partition?"),columns:["is_attach","partition_name","is_default","values_from","values_to","values_in","values_modulus","values_remainder"],control:r.SubNodeCollectionControl.extend({row:s.PartitionRow,initialize:function(){r.SubNodeCollectionControl.prototype.initialize.apply(this,arguments);var t=this;if(!this.model.isNew()){var n=this.field.get("schema_node"),o=this.field.get("node_info");i.ajax({url:n.generate_url.apply(n,[null,"get_attach_tables",this.field.get("node_data"),!0,o]),type:"GET",async:!1}).done((function(i){1==i.success?t.model.table_options=i.data:a.alert(e("Error fetching tables to be attached"),i.data.result)})).fail((function(t,i,n){a.pgRespErrorNotify(t,n,e("Error fetching tables to be attached"))}))}}}),canAdd:function(e){return!!e.get("is_partitioned")},visible:function(e){return!n.isUndefined(e.node_info)&&!n.isUndefined(e.node_info.server)&&!n.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5},disabled:function(e){e.isNew()&&e.get("partitions")&&e.get("partitions").models.length>0&&setTimeout((function(){var t=e.get("partitions");t.remove(t.filter((function(){return!0})))}),10)}},{id:"partition_note",label:e("Partition"),type:"note",group:"partition",text:["<ul><li>","<strong>",e("Create a table: "),"</strong>",e("User can create multiple partitions while creating new partitioned table. Operation switch is disabled in this scenario."),"</li><li>","<strong>",e("Edit existing table: "),"</strong>",e("User can create/attach/detach multiple partitions. In attach operation user can select table from the list of suitable tables to be attached."),"</li><li>","<strong>",e("Default: "),"</strong>",e("The default partition can store rows that do not fall into any existing partition’s range or list."),"</li><li>","<strong>",e("From/To/In input: "),"</strong>",e("From/To/In input: Values for these fields must be quoted with single quote. For more than one partition key values must be comma(,) separated."),"</li><li>","<strong>",e("Example: From/To: "),"</strong>",e("Enabled for range partition. Consider partitioned table with multiple keys of type Integer, then values should be specified like '100','200'."),"</li><li>","<strong>",e("In: "),"</strong>",e("Enabled for list partition. Values must be comma(,) separated and quoted with single quote."),"</li><li>","<strong>",e("Modulus/Remainder: "),"</strong>",e("Enabled for hash partition."),"</li></ul>"].join(""),visible:function(e){return!n.isUndefined(e.node_info)&&!n.isUndefined(e.node_info.server)&&!n.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=1e5}},{type:"nested",control:"tab",group:e("Parameter"),mode:["edit","create"],deps:["is_partitioned"],schema:r.VacuumSettingsSchema},{id:"relacl_str",label:e("Privileges"),disabled:"inSchema",type:"text",mode:["properties"],group:e("Security")},l.SecurityGroupSchema,{id:"relacl",label:e("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:l.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","d","D","x","t"]}),mode:["edit","create"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"seclabels",label:e("Security labels"),canEdit:!1,model:l.SecLabelModel,editable:!1,canAdd:!0,type:"collection",min_version:90100,mode:["edit","create"],group:"security",canDelete:!0,control:"unique-col-collection"},{id:"vacuum_settings_str",label:e("Storage settings"),type:"multiline",group:e("Advanced"),mode:["properties"]}],validate:function(t){var i,o=this.get("name"),l=this.get("schema"),a=this.get("relowner"),r=this.get("is_partitioned"),s=this.get("partition_keys");return!t||0!=t.length&&-1==n.indexOf(t,"autovacuum_enabled")&&-1==n.indexOf(t,"toast_autovacuum_enabled")?(this.errorModel.clear(),n.isUndefined(o)||n.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,"")?(i=e("Table name cannot be empty."),this.errorModel.set("name",i),i):n.isUndefined(l)||n.isNull(l)||""==String(l).replace(/^\s+|\s+$/g,"")?(i=e("Table schema cannot be empty."),this.errorModel.set("schema",i),i):n.isUndefined(a)||n.isNull(a)||""==String(a).replace(/^\s+|\s+$/g,"")?(i=e("Table owner cannot be empty."),this.errorModel.set("relowner",i),i):r&&this.isNew()&&!n.isNull(s)&&s.length<=0?(i=e("Please specify at least one key for partitioned table."),this.errorModel.set("partition_keys",i),i):null):null},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},isInheritedTable:function(e){return!e.inSchema.apply(this,[e])&&!(!n.isUndefined(e.get("coll_inherits"))&&0!=e.get("coll_inherits").length||!n.isUndefined(e.get("typname"))&&""!==String(e.get("typname")).replace(/^\s+|\s+$/g,""))},checkInheritance:function(e){return e.get("is_partitioned")?(setTimeout((function(){e.set("coll_inherits",[])}),10),!0):!(!e.inSchema.apply(this,[e])&&(n.isUndefined(e.get("typname"))||n.isNull(e.get("typname"))||""==String(e.get("typname")).replace(/^\s+|\s+$/g,"")))},isLikeDisable:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&(n.isUndefined(e.get("typname"))||n.isNull(e.get("typname"))||""==String(e.get("typname")).replace(/^\s+|\s+$/g,"")))},check_grid_add_condition:function(e){var t=!0;return e.inSchema.apply(this,[e])||n.isUndefined(e.get("typname"))||n.isNull(e.get("typname"))||""===e.get("typname")||(t=!1),t},check_grid_row_edit_delete:function(e){var t=!0;return n.isUndefined(e.get("inheritedfrom"))||n.isNull(e.get("inheritedfrom"))||""===String(e.get("inheritedfrom")).replace(/^\s+|\s+$/g,"")||(t=!1),t},checkOfType:function(e){return e.get("is_partitioned")?(setTimeout((function(){e.set("typname",void 0)}),10),!0):!(!e.inSchemaWithModelCheck.apply(this,[e])&&(n.isUndefined(e.get("coll_inherits"))||n.isNull(e.get("coll_inherits"))||""==String(e.get("coll_inherits")).replace(/^\s+|\s+$/g,"")))},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},isTableAutoVacuumEnable:function(e){return!(!e.inSchema.apply(this,[e])&&!0===e.get("autovacuum_enabled"))},isToastTableAutoVacuumEnable:function(e){return!(!e.inSchemaWithModelCheck.apply(this,[e])&&1==e.get("toast_autovacuum_enabled"))},fetch_columns_ajax:function(e){var t=this,n="get_columns",o=t.model.top||t.model,a=void 0,r=this.field.get("schema_node"),s=this.field.get("node_info"),d=r.generate_url.apply(r,[null,n,this.field.get("node_data"),this.field.get("url_with_id")||!1,s]),c=this.field.get("cache_level")||r.type,p=this.field.get("cache_node");return p=p&&l.Nodes.cache_node||r,o.trigger("pgadmin:view:fetching",o,t.field),i.ajax({async:!1,url:d,data:e}).done((function(e){a=p.cache(n,s,c,e.data)})).fail((function(){o.trigger("pgadmin:view:fetch:error",o,t.field)})),o.trigger("pgadmin:view:fetched",o,t.field),a=a&&a.data||[]}}),canCreate:d.isTreeItemOfChildOfSchema,canCreate_with_trigger_enable:function(e,t,i){if(this.canCreate.apply(this,[e,t,i]))return e.tigger_count>0},canCreate_with_trigger_disable:function(e,t,i){if(this.canCreate.apply(this,[e,t,i]))return e.tigger_count>0&&e.has_enable_triggers>0}})),l.Nodes.partition}.apply(t,n))||(e.exports=o)},279:function(e,t,i){"use strict";var n,o;i(5),i(9),i(7),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(13),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r,s){return l.Nodes["coll-compound_trigger"]||(o.Browser.Nodes["coll-compound_trigger"]=o.Browser.Collection.extend({node:"compound_trigger",label:e("Compound Triggers"),type:"coll-compound_trigger",columns:["name","description"],canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema})),l.Nodes.compound_trigger||(o.Browser.Nodes.compound_trigger=l.Node.extend({parent_type:["table","view","partition"],collection_type:["coll-table","coll-view"],type:"compound_trigger",label:e("Compound Trigger"),hasSQL:!0,hasDepends:!0,width:l.stdW.sm+"px",sqlAlterHelp:"sql-altertcompoundtrigger.html",sqlCreateHelp:"sql-createcompoundtrigger.html",dialogHelp:t("help.static",{filename:"compound_trigger_dialog.html"}),url_jump_after_node:"schema",Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_compound_trigger_on_coll",node:"coll-compound_trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Compound Trigger..."),icon:"wcTabIcon icon-compound_trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_compound_trigger",node:"compound_trigger",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Compound Trigger..."),icon:"wcTabIcon icon-compound_trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_compound_trigger_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Compound Trigger..."),icon:"wcTabIcon icon-compound_trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_compound_trigger_onPartition",node:"partition",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Compound Trigger..."),icon:"wcTabIcon icon-compound_trigger",data:{action:"create",check:!0},enable:"canCreate"},{name:"enable_compound_trigger",node:"compound_trigger",module:this,applies:["object","context"],callback:"enable_compound_trigger",category:"connect",priority:3,label:e("Enable compound trigger"),icon:"fa fa-check",enable:"canCreate_with_compound_trigger_enable"},{name:"disable_compound_trigger",node:"compound_trigger",module:this,applies:["object","context"],callback:"disable_compound_trigger",category:"drop",priority:3,label:e("Disable compound trigger"),icon:"fa fa-times",enable:"canCreate_with_compound_trigger_disable"},{name:"create_compound_trigger_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Compound Trigger..."),icon:"wcTabIcon icon-compound_trigger",data:{action:"create",check:!0},enable:"canCreate"}]))},callbacks:{enable_compound_trigger:function(e){var t=e||{},n=l.tree,o=t.item||n.selected(),a=o&&1==o.length?n.itemData(o):void 0;if(!a)return!1;var s=a;i.ajax({url:this.generate_url(o,"enable",a,!0),type:"PUT",data:{is_enable_trigger:"O"},dataType:"json"}).done((function(e){1==e.success&&(r.success(e.info),n.removeIcon(o),s.icon="icon-compound_trigger",n.addIcon(o,{icon:s.icon}),n.unload(o),n.setInode(!1),n.deselect(o),setTimeout((function(){n.select(o)}),10))})).fail((function(e,t,i){r.pgRespErrorNotify(e,i),n.unload(o)}))},disable_compound_trigger:function(t){var n=t||{},o=l.tree,a=n.item||o.selected(),s=a&&1==a.length?o.itemData(a):void 0;if(!s)return!1;var d=s;i.ajax({url:this.generate_url(a,"enable",s,!0),type:"PUT",data:{is_enable_trigger:"D"},dataType:"json"}).done((function(e){1==e.success&&(r.success(e.info),o.removeIcon(a),d.icon="icon-compound_trigger-bad",o.addIcon(a,{icon:d.icon}),o.unload(a),o.setInode(!1),o.deselect(a),setTimeout((function(){o.select(a)}),10))})).fail((function(t,i,n){r.pgRespErrorNotify(t,n,e("Disable compound trigger failed")),o.unload(a)}))}},canDrop:s.isTreeItemOfChildOfSchema,canDropCascade:s.isTreeItemOfChildOfSchema,model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:"inSchema"},{id:"oid",label:e("OID"),cell:"string",type:"int",mode:["properties"]},{id:"is_enable_trigger",label:e("Trigger enabled?"),mode:["edit","properties"],disabled:function(){return!(!this.node_info||!("catalog"in this.node_info||"view"in this.node_info))},options:[{label:"Enable",value:"O"},{label:"Enable Replica",value:"R"},{label:"Enable Always",value:"A"},{label:"Disable",value:"D"}],control:"select2",select2:{allowClear:!1,width:"100%"}},{type:"nested",control:"fieldset",mode:["create","edit","properties"],label:e("FOR Events"),group:e("Events"),contentClass:"row",schema:[{id:"evnt_insert",label:e("INSERT"),type:"switch",mode:["create","edit","properties"],group:e("FOR Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_insert");return!(!n.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchema.apply(this,[e])},readonly:"inEditMode"},{id:"evnt_update",label:e("UPDATE"),type:"switch",mode:["create","edit","properties"],group:e("FOR Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_update");return!(!n.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchema.apply(this,[e])},readonly:"inEditMode"},{id:"evnt_delete",label:e("DELETE"),type:"switch",mode:["create","edit","properties"],group:e("FOR Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_delete");return!(!n.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchema.apply(this,[e])},readonly:"inEditMode"},{id:"evnt_truncate",label:e("TRUNCATE"),type:"switch",mode:["create","edit","properties"],group:e("FOR Events"),extraToggleClasses:"pg-el-sm-6",controlLabelClassName:"control-label pg-el-sm-5 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-7 pg-el-12",disabled:function(e){var t=e.get("evnt_truncate");return"view"in e.node_info||!(!n.isUndefined(t)&&"ppas"==e.node_info.server.server_type)&&e.inSchema.apply(this,[e])}}],readonly:"inEditMode"},{id:"whenclause",label:e("When"),type:"text",disabled:"inSchema",readonly:"inEditMode",mode:["create","edit","properties"],control:"sql-field",visible:!0,group:e("Events")},{id:"columns",label:e("Columns"),url:"nodes",control:"node-list-by-name",cache_node:"column",type:"array",select2:{multiple:!0},deps:["evnt_update"],node:"column",group:e("Events"),disabled:function(e){if(this.node_info&&"catalog"in this.node_info)return!0;var t=e.get("evnt_update");return!(!n.isUndefined(t)&&t)},readonly:"inEditMode"},{id:"prosrc",label:e("Code"),group:e("Code"),type:"text",mode:["create","edit"],tabPanelCodeClass:"sql-code-control",control:a.SqlCodeControl,disabled:function(e){if(e.isNew()){var t=e.getCodeTemplate();setTimeout((function(){e.set("prosrc",t)}),10)}return!1}},{id:"is_sys_trigger",label:e("System trigger?"),cell:"string",type:"switch",disabled:"inSchema",mode:["properties"],readonly:"inEditMode"},{id:"description",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"inSchema"}],validate:function(t){var i;return this.errorModel.clear(),t&&0==t.length?null:n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,"")?(i=e("Name cannot be empty."),this.errorModel.set("name",i),i):this.get("evnt_truncate")||this.get("evnt_delete")||this.get("evnt_update")||this.get("evnt_insert")?n.isUndefined(this.get("prosrc"))||""==String(this.get("prosrc")).replace(/^\s+|\s+$/g,"")?(i=e("Code cannot be empty."),this.errorModel.set("prosrc",i),i):null:(i=e("Specify at least one event."),this.errorModel.set("evnt_truncate"," "),this.errorModel.set("evnt_delete"," "),this.errorModel.set("evnt_update"," "),this.errorModel.set("evnt_insert",i),i)},getCodeTemplate:function(){return e("-- Enter any global declarations below:\n\n-- BEFORE STATEMENT block. Delete if not required.\nBEFORE STATEMENT IS\n    -- Enter any local declarations here\nBEGIN\n    -- Enter any required code here\nEND;\n\n-- AFTER STATEMENT block. Delete if not required.\nAFTER STATEMENT IS\n    -- Enter any local declarations here\nBEGIN\n    -- Enter any required code here\nEND;\n\n-- BEFORE EACH ROW block. Delete if not required.\nBEFORE EACH ROW IS\n    -- Enter any local declarations here\nBEGIN\n    -- Enter any required code here\nEND;\n\n-- AFTER EACH ROW block. Delete if not required.\nAFTER EACH ROW IS\n    -- Enter any local declarations here\nBEGIN\n    -- Enter any required code here\nEND;\n\n-- INSTEAD OF EACH ROW block. Delete if not required.\nINSTEAD OF EACH ROW IS\n    -- Enter any local declarations here\nBEGIN\n    -- Enter any required code here\nEND;")},inSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inEditMode:function(e){return!e.isNew()},inSchemaWithColumnCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()&&!(!n.isUndefined(e.get("attnum"))&&e.get("attnum")>=1)}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;var n=this.getTreeNodeHierarchy(t),o=n.server;return(!o||!("pg"===o.server_type||o.version<12e4))&&null==n.catalog},canCreate_with_compound_trigger_enable:function(e,t,i){return!("view"in this.getTreeNodeHierarchy(t))&&("icon-compound_trigger-bad"===e.icon&&this.canCreate.apply(this,[e,t,i]))},canCreate_with_compound_trigger_disable:function(e,t,i){return!("view"in this.getTreeNodeHierarchy(t))&&("icon-compound_trigger"===e.icon&&this.canCreate.apply(this,[e,t,i]))}})),l.Nodes.compound_trigger}.apply(t,n))||(e.exports=o)},45:function(e,t,i){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i(19),i(26),i(27),i(17),i(4),i(31),i(12),i(23),i(44),i(20),Object.defineProperty(t,"__esModule",{value:!0}),t.childCreateMenuEnabled=function(e,t,i){if(i&&!1===i.check)return!0;var n=o.treeMenu.findNodeByDomElement(t);return!!n&&n.anyFamilyMember((function(e){return"schema"===e.getData()._type}))},t.isTreeItemOfChildOfSchema=function(e,t){var i=o.treeMenu.findNodeByDomElement(t);return!!i&&a(i)},t.isTreeNodeOfSchemaChild=a;var o=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var r=o?Object.getOwnPropertyDescriptor(e,a):null;r&&(r.get||r.set)?Object.defineProperty(i,a,r):i[a]=e[a]}i.default=e,t&&t.set(e,i);return i}(i(10));function l(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return l=function(){return e},e}function a(e){return e.anyParent((function(e){return"schema"===e.getData()._type}))}},457:function(e,t,i){"use strict";var n,o;i(16),i(11),i(35),i(5),i(9),i(7),n=[i(2),i(6),i(0),i(1),i(14),i(3),i(10),i(18),i(30),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r,s,d){a.Nodes["coll-column"]||(a.Nodes["coll-column"]=a.Collection.extend({node:"column",label:e("Columns"),type:"coll-column",columns:["name","atttypid","description"],canDrop:d.isTreeItemOfChildOfSchema,canDropCascade:!1}));var c=r.VariablesModel=a.Node.Model.extend({idAttribute:"name",defaults:{name:null,value:null},schema:[{id:"name",label:e("Name"),cell:"select2",type:"text",disabled:!1,node:"column",options:[["n_distinct","n_distinct"],["n_distinct_inherited","n_distinct_inherited"]],select2:{placeholder:"Select variable"},cellHeaderClasses:"width_percent_50"},{id:"value",label:e("Value"),type:"text",disabled:!1,cellHeaderClasses:"width_percent_50"}],validate:function(){if(n.isUndefined(this.get("value"))||n.isNull(this.get("value"))||""==String(this.get("value")).replace(/^\s+|\s+$/g,"")){var t=e("Please provide input for variable.");return this.errorModel.set("value",t),t}return this.errorModel.unset("value"),null}}),p=s.Extension.IntegerDepCell=s.IntegerCell.extend({initialize:function(){s.NumberCell.prototype.initialize.apply(this,arguments),s.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function(){this.$el.empty();var e=this.model,t=this.column,i=this.column.get("editable");return(n.isFunction(i)?!!i.apply(t,[e]):!!i)?this.$el.addClass("editable"):this.$el.removeClass("editable"),this.delegateEvents(),this},render:function(){s.NumberCell.prototype.render.apply(this,arguments);var e=this.model,t=this.column,i=this.column.get("editable"),o=n.isFunction(i)?!!i.apply(t,[e]):!!i;return o?this.$el.addClass("editable"):this.$el.removeClass("editable"),this},remove:s.Extension.DependentCell.prototype.remove});return a.Nodes.column||(a.Nodes.column=a.Node.extend({parent_type:["table","view","mview"],collection_type:["coll-table","coll-view","coll-mview"],type:"column",label:e("Column"),hasSQL:!0,sqlAlterHelp:"sql-altertable.html",sqlCreateHelp:"sql-altertable.html",dialogHelp:t("help.static",{filename:"column_dialog.html"}),canDrop:function(e,t){var i=a.treeMenu.findNodeByDomElement(t);return!!i&&i.anyParent((function(e){return"table"===e.getData()._type&&!e.anyParent((function(e){return"catalog"===e.getData()._type}))}))},hasDepends:!0,hasStatistics:!0,Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_column_on_coll",node:"coll-column",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_column",node:"column",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_column_onTable",node:"table",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:!0},enable:"canCreate"},{name:"create_column_onView",node:"view",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Column..."),icon:"wcTabIcon icon-column",data:{action:"create",check:!0},enable:"canCreate"}]))},model:a.Node.Model.extend({idAttribute:"attnum",defaults:{name:void 0,attowner:void 0,atttypid:void 0,attnum:void 0,cltype:void 0,collspcname:void 0,attacl:void 0,description:void 0,parent_tbl:void 0,min_val_attlen:void 0,min_val_attprecision:void 0,max_val_attlen:void 0,max_val_attprecision:void 0,edit_types:void 0,is_primary_key:!1,inheritedfrom:void 0,attstattarget:void 0,attnotnull:!1,attlen:null,attprecision:null,attidentity:"a",seqincrement:void 0,seqstart:void 0,seqmin:void 0,seqmax:void 0,seqcache:void 0,seqcycle:void 0,colconstype:"n",genexpr:void 0},initialize:function(e){0!==n.size(e)&&this.set({old_attidentity:this.get("attidentity")},{silent:!0}),a.Node.Model.prototype.initialize.apply(this,arguments)},schema:[{id:"name",label:e("Name"),cell:"string",type:"text",disabled:"inSchemaWithColumnCheck",cellHeaderClasses:"width_percent_30",editable:"editable_check_for_table"},{id:"is_primary_key",label:e("Primary key?"),cell:s.Extension.TableChildSwitchCell,type:"switch",deps:["name"],cellHeaderClasses:"width_percent_5",options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"ternary"},visible:function(e){return n.isUndefined(e.top.node_info.table||e.top.node_info.view||e.top.node_info.mview)},disabled:function(e){if(e.top&&(!n.isUndefined(e.top.get("oid"))&&!n.isUndefined(e.top.get("primary_key"))&&e.top.get("primary_key").length>0&&!n.isUndefined(e.top.get("primary_key").first().get("oid"))||e.top.has("is_partitioned")&&e.top.get("is_partitioned")&&e.top.node_info.server&&e.top.node_info.server.version<11e3))return!0;var t=e.get("name");return!(e.inSchemaWithColumnCheck.apply(this,[e])||!n.isUndefined(t)&&!n.isNull(t)&&""!=t)},editable:function(e){return e instanceof o.Collection||!(e.top&&!n.isUndefined(e.top.get("oid"))&&!n.isUndefined(e.top.get("primary_key"))&&e.top.get("primary_key").length>0&&!n.isUndefined(e.top.get("primary_key").first().get("oid")))&&(e.top&&!n.isUndefined(e.top.get("is_partitioned"))&&e.top.get("is_partitioned")&&e.top.node_info.server&&e.top.node_info.server.version<11e3?(setTimeout((function(){e.set("is_primary_key",!1)}),10),!1):!e.inSchemaWithColumnCheck.apply(this,[e]))}},{id:"attnum",label:e("Position"),cell:"string",type:"text",disabled:"notInSchema",mode:["properties"]},{id:"cltype",label:e("Data type"),cell:s.Extension.NodeAjaxOptionsCell,type:"text",disabled:"inSchemaWithColumnCheck",control:"node-ajax-options",url:"get_types",node:"table",cellHeaderClasses:"width_percent_30",first_empty:!0,select2:{allowClear:!1},group:e("Definition"),cache_node:"table",transform:function(e,t){var i=t||this,o=i.model;i.model.datatypes=e;var l=o.get("edit_types"),a=[];return n.isUndefined(o.top)||o.top.isNew()?o.isNew()?e:(n.each(e,(function(e){-1!=n.indexOf(l,e.value)&&a.push(e)})),a):(n.each(e,(function(e){-1!=n.indexOf(l,e.value)&&a.push(e)})),a.length>0?a:e)},editable:"editable_check_for_table"},{id:"inheritedfrom",label:e("Inherited from table"),type:"text",readonly:!0,editable:!1,cellHeaderClasses:"width_percent_10",visible:function(e){return n.isUndefined(e.top.node_info.table||e.top.node_info.view||e.top.node_info.mview)}},{id:"attlen",label:e("Length/Precision"),cell:p,deps:["cltype"],type:"int",group:e("Definition"),cellHeaderClasses:"width_percent_20",disabled:function(e){var t=e.get("cltype"),i=!0;return n.each(e.datatypes,(function(n){t==n.value&&n.length&&(e.set("min_val_attlen",n.min_val,{silent:!0}),e.set("max_val_attlen",n.max_val,{silent:!0}),i=!1)})),i&&setTimeout((function(){e.get("attlen")&&e.set("attlen",null)}),10),i},editable:function(e){if(!n.isUndefined(e.get("inheritedfrom")))return!1;if(!e.datatypes)return!0;var t=e.get("cltype"),i=!1;return n.each(e.datatypes,(function(n){t==n.value&&n.length&&(e.set("min_val_attlen",n.min_val,{silent:!0}),e.set("max_val_attlen",n.max_val,{silent:!0}),i=!0)})),!i&&setTimeout((function(){e.get("attlen")&&e.set("attlen",null,{silent:!0})}),10),i}},{id:"attprecision",label:e("Scale"),cell:p,deps:["cltype"],type:"int",group:e("Definition"),cellHeaderClasses:"width_percent_20",disabled:function(e){var t=e.get("cltype"),i=!0;return n.each(e.datatypes,(function(n){t==n.value&&n.precision&&(e.set("min_val_attprecision",0,{silent:!0}),e.set("max_val_attprecision",n.max_val,{silent:!0}),i=!1)})),i&&setTimeout((function(){e.get("attprecision")&&e.set("attprecision",null)}),10),i},editable:function(e){if(!n.isUndefined(e.get("inheritedfrom")))return!1;if(!e.datatypes)return!0;var t=e.get("cltype"),i=!1;return n.each(e.datatypes,(function(n){t==n.value&&n.precision&&(e.set("min_val_attprecision",0,{silent:!0}),e.set("max_val_attprecision",n.max_val,{silent:!0}),i=!0)})),!i&&setTimeout((function(){e.get("attprecision")&&e.set("attprecision",null)}),10),i}},{id:"collspcname",label:e("Collation"),cell:"string",type:"text",control:"node-ajax-options",url:"get_collations",group:e("Definition"),node:"collation",deps:["cltype"],disabled:function(e){var t=e.get("cltype"),i=!0;return n.each(e.datatypes,(function(e){t==e.value&&e.is_collatable&&(i=!1)})),i&&setTimeout((function(){e.get("collspcname")&&""!==e.get("collspcname")&&e.set("collspcname","")}),10),i}},{id:"attstattarget",label:e("Statistics"),cell:"string",type:"text",disabled:"inSchemaWithColumnCheck",mode:["properties","edit"],group:e("Definition")},{id:"attstorage",label:e("Storage"),group:e("Definition"),type:"text",mode:["properties","edit"],cell:"string",disabled:"inSchemaWithColumnCheck",first_empty:!0,control:"select2",select2:{placeholder:"Select storage",allowClear:!1,width:"100%"},options:[{label:"PLAIN",value:"p"},{label:"MAIN",value:"m"},{label:"EXTERNAL",value:"e"},{label:"EXTENDED",value:"x"}]},{id:"defval",label:e("Default"),cell:"string",type:"text",group:e("Constraints"),deps:["cltype","colconstype"],disabled:function(e){var t=!1;if(!e.inSchemaWithModelCheck.apply(this,[e])){var i=e.get("cltype");t="serial"==i||"bigserial"==i||"smallserial"==i}return(t=t||"n"!=e.get("colconstype"))&&e.isNew()&&setTimeout((function(){e.set("defval",void 0)}),10),t}},{id:"attnotnull",label:e("Not NULL?"),cell:"switch",type:"switch",cellHeaderClasses:"width_percent_20",group:e("Constraints"),editable:"editable_check_for_table",options:{onText:e("Yes"),offText:e("No"),onColor:"success",offColor:"ternary"},deps:["colconstype"],disabled:function(e){return"i"==e.get("colconstype")&&setTimeout((function(){e.set("attnotnull",!0)}),10),e.inSchemaWithColumnCheck(e)}},{id:"colconstype",label:e("Type"),cell:"string",type:"radioModern",controlsClassName:"pgadmin-controls col-12 col-sm-9",controlLabelClassName:"control-label col-sm-3 col-12",group:e("Constraints"),options:function(t){var i=[{label:e("NONE"),value:"n"},{label:e("IDENTITY"),value:"i"}];return t.top.node_info&&t.top.node_info.server&&t.top.node_info.server.version>=12e4&&(t.isNew()?i.push({label:e("GENERATED"),value:"g"}):i.push({label:e("GENERATED"),value:"g",disabled:!0})),i},disabled:function(e){return!e.isNew()&&"g"==e.get("colconstype")},visible:function(e){return!!(e.top.node_info&&e.top.node_info.server&&e.top.node_info.server.version>=1e5)}},{id:"attidentity",label:e("Identity"),control:"select2",cell:"select2",select2:{placeholder:"Select identity",allowClear:!1,width:"100%"},min_version:1e5,group:e("Constraints"),options:[{label:e("ALWAYS"),value:"a"},{label:e("BY DEFAULT"),value:"d"}],deps:["colconstype"],visible:"isTypeIdentity",disabled:function(e){return e.isNew()||""==e.get("attidentity")&&"i"==e.get("colconstype")&&setTimeout((function(){e.set("attidentity",e.get("old_attidentity"))}),10),!1}},{id:"seqincrement",label:e("Increment"),type:"int",mode:["properties","create","edit"],group:e("Constraints"),min:1,deps:["attidentity","colconstype"],disabled:"isIdentityColumn",visible:"isTypeIdentity"},{id:"seqstart",label:e("Start"),type:"int",mode:["properties","create"],group:e("Constraints"),disabled:function(e){if(!e.isNew())return!0;var t=e.get("attidentity");return!!(n.isUndefined(t)||n.isNull(t)||n.isEmpty(t))},deps:["attidentity","colconstype"],visible:"isTypeIdentity"},{id:"seqmin",label:e("Minimum"),type:"int",mode:["properties","create","edit"],group:e("Constraints"),deps:["attidentity","colconstype"],disabled:"isIdentityColumn",visible:"isTypeIdentity"},{id:"seqmax",label:e("Maximum"),type:"int",mode:["properties","create","edit"],group:e("Constraints"),deps:["attidentity","colconstype"],disabled:"isIdentityColumn",visible:"isTypeIdentity"},{id:"seqcache",label:e("Cache"),type:"int",mode:["properties","create","edit"],group:e("Constraints"),min:1,deps:["attidentity","colconstype"],disabled:"isIdentityColumn",visible:"isTypeIdentity"},{id:"seqcycle",label:e("Cycled"),type:"switch",mode:["properties","create","edit"],group:e("Constraints"),deps:["attidentity","colconstype"],disabled:"isIdentityColumn",visible:"isTypeIdentity"},{id:"genexpr",label:e("Expression"),type:"text",mode:["properties","create","edit"],group:e("Constraints"),min_version:12e4,deps:["colconstype"],visible:"isTypeGenerated",readonly:function(e){return!e.isNew()}},{id:"is_pk",label:e("Primary key?"),type:"switch",mode:["properties"],group:e("Definition")},{id:"is_fk",label:e("Foreign key?"),type:"switch",mode:["properties"],group:e("Definition")},{id:"is_inherited",label:e("Inherited?"),type:"switch",mode:["properties"],group:e("Definition")},{id:"tbls_inherited",label:e("Inherited from table(s)"),type:"text",mode:["properties"],deps:["is_inherited"],group:e("Definition"),visible:function(e){return!(n.isUndefined(e.get("is_inherited"))||!e.get("is_inherited"))}},{id:"is_sys_column",label:e("System column?"),cell:"string",type:"switch",mode:["properties"]},{id:"description",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],disabled:"notInSchema"},{id:"attoptions",label:e("Variables"),type:"collection",group:e("Variables"),control:"unique-col-collection",model:c,uniqueCol:["name"],mode:["edit","create"],canAdd:!0,canEdit:!1,canDelete:!0},a.SecurityGroupSchema,{id:"attacl",label:e("Privileges"),type:"collection",group:"security",control:"unique-col-collection",model:a.Node.PrivilegeRoleModel.extend({privileges:["a","r","w","x"]}),mode:["edit"],canAdd:!0,canDelete:!0,uniqueCol:["grantee"]},{id:"seclabels",label:e("Security labels"),canAdd:!0,model:a.SecLabelModel,group:"security",mode:["edit","create"],editable:!1,type:"collection",min_version:90100,canEdit:!1,canDelete:!0,control:"unique-col-collection"}],validate:function(t){var i=void 0;if(t&&0==t.length)return this.errorModel.clear(),null;if(this.errorModel.clear(),n.isUndefined(this.get("name"))||""==String(this.get("name")).replace(/^\s+|\s+$/g,""))return i=e("Column name cannot be empty."),this.errorModel.set("name",i),i;if(n.isUndefined(this.get("cltype"))||""==String(this.get("cltype")).replace(/^\s+|\s+$/g,""))return i=e("Column type cannot be empty."),this.errorModel.set("cltype",i),i;if(!n.isUndefined(this.get("cltype"))&&!n.isUndefined(this.get("attlen"))&&!n.isNull(this.get("attlen"))&&""!==this.get("attlen")&&(this.get("attlen")<this.get("min_val_attlen")&&(i=e("Length/Precision should not be less than: ")+this.get("min_val_attlen")),this.get("attlen")>this.get("max_val_attlen")&&(i=e("Length/Precision should not be greater than: ")+this.get("max_val_attlen")),i))return this.errorModel.set("attlen",i),i;if(!n.isUndefined(this.get("cltype"))&&!n.isUndefined(this.get("attprecision"))&&!n.isNull(this.get("attprecision"))&&""!==this.get("attprecision")&&(this.get("attprecision")<this.get("min_val_attprecision")&&(i=e("Scale should not be less than: ")+this.get("min_val_attprecision")),this.get("attprecision")>this.get("max_val_attprecision")&&(i=e("Scale should not be greater than: ")+this.get("max_val_attprecision")),i))return this.errorModel.set("attprecision",i),i;var o=this.get("genexpr");if("g"==this.get("colconstype")&&(n.isUndefined(o)||n.isNull(o)||""==o))return i=e("Expression value cannot be empty."),this.errorModel.set("genexpr",i),i;this.errorModel.unset("genexpr");var l=this.get("seqmin"),a=this.get("seqmax"),r=this.get("seqstart");if(!(this.isNew()||"i"!=this.get("colconstype")||"a"!=this.get("old_attidentity")&&"d"!=this.get("old_attidentity")||"a"!=this.get("attidentity")&&"d"!=this.get("attidentity"))){if(n.isUndefined(this.get("seqincrement"))||""==String(this.get("seqincrement")).replace(/^\s+|\s+$/g,""))return i=e("Increment value cannot be empty."),this.errorModel.set("seqincrement",i),i;if(this.errorModel.unset("seqincrement"),n.isUndefined(this.get("seqmin"))||""==String(this.get("seqmin")).replace(/^\s+|\s+$/g,""))return i=e("Minimum value cannot be empty."),this.errorModel.set("seqmin",i),i;if(this.errorModel.unset("seqmin"),n.isUndefined(this.get("seqmax"))||""==String(this.get("seqmax")).replace(/^\s+|\s+$/g,""))return i=e("Maximum value cannot be empty."),this.errorModel.set("seqmax",i),i;if(this.errorModel.unset("seqmax"),n.isUndefined(this.get("seqcache"))||""==String(this.get("seqcache")).replace(/^\s+|\s+$/g,""))return i=e("Cache value cannot be empty."),this.errorModel.set("seqcache",i),i;this.errorModel.unset("seqcache")}var s=e("Minimum value must be less than maximum value."),d=e("Start value cannot be less than minimum value."),c=e("Start value cannot be greater than maximum value.");return n.isEmpty(l)||n.isEmpty(a)?null:0==l&&0==a||parseInt(l,10)>=parseInt(a,10)?(this.errorModel.set("seqmin",s),s):(this.errorModel.unset("seqmin"),r&&l&&parseInt(r)<parseInt(l)?(this.errorModel.set("seqstart",d),d):(this.errorModel.unset("seqstart"),r&&a&&parseInt(r)>parseInt(a)?(this.errorModel.set("seqstart",c),c):(this.errorModel.unset("seqstart"),null)))},isIdentityColumn:function(e){var t=e.get("attidentity");return!!(n.isUndefined(t)||n.isNull(t)||n.isEmpty(t))},isTypeIdentity:function(e){var t=e.get("colconstype");return!n.isUndefined(t)&&!n.isNull(t)&&"i"==t},isTypeGenerated:function(e){var t=e.get("colconstype");return!n.isUndefined(t)&&!n.isNull(t)&&"g"==t},notInSchema:function(){return!!(this.node_info&&"catalog"in this.node_info)},inSchemaWithModelCheck:function(e){return!(this.node_info&&"schema"in this.node_info)||!e.isNew()},inSchemaWithColumnCheck:function(e){var t=this.node_info||e.node_info||e.top.node_info;return!!(t&&("view"in t||"mview"in t)&&this&&n.has(this,"name")&&"defval"!=this.name)||(!(t&&"schema"in t)||(!n.isUndefined(e.get("inheritedfrom"))||!e.isNew()&&!(!n.isUndefined(e.get("attnum"))&&e.get("attnum")>0)))},editable_check_for_table:function(e){return e instanceof o.Collection?!e.model.prototype.inSchemaWithColumnCheck.apply(this,[e.top]):!e.inSchemaWithColumnCheck.apply(this,[e])}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var o=a.tree,l=t,r=e,s=[];l;){if(n.indexOf(["schema"],r._type)>-1)return!0;if(n.indexOf(["view","coll-view","mview","coll-mview"],r._type)>-1){s.push(r._type);break}s.push(r._type),r=(l=o.hasParent(l)?o.parent(l):null)?o.itemData(l):null}return!(n.indexOf(s,"catalog")>-1||n.indexOf(s,"coll-view")>-1||n.indexOf(s,"coll-mview")>-1||n.indexOf(s,"mview")>-1||n.indexOf(s,"view")>-1)}})),a.Nodes.column}.apply(t,n))||(e.exports=o)},458:function(e,t,i){"use strict";var n,o;n=[i(2),i(0),i(1),i(3),i(10),i(25),i(459),i(460),i(461),i(462),i(463)],void 0===(o=function(e,t,i,n,o){return o.Nodes["coll-constraints"]||(n.Browser.Nodes["coll-constraints"]=n.Browser.Collection.extend({node:"constraints",label:e("Constraints"),type:"coll-constraints",columns:["name","comment"],canDrop:!1,canDropCascade:!1})),o.Nodes.constraints||(n.Browser.Nodes.constraints=o.Node.extend({type:"constraints",label:e("Constraints"),collection_type:"coll-constraints",parent_type:["table","partition"],url_jump_after_node:"schema",Init:function(){this.initialized||(this.initialized=!0,o.add_menus([]))},model:n.Browser.Node.Model.extend({defaults:{name:void 0,oid:void 0,comment:void 0},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"]},{id:"oid",label:e("Oid"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"]}]})})),o.Nodes.constraints}.apply(t,n))||(e.exports=o)},459:function(e,t,i){"use strict";var n,o;i(16),i(34),i(47),i(32),i(12),i(5),i(43),i(9),i(29),i(7),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(30),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r){return l.Nodes.unique_constraint||(o.Browser.Nodes.unique_constraint=l.Node.extend({type:"unique_constraint",label:e("Unique constraint"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:t("help.static",{filename:"unique_constraint_dialog.html"}),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[e("Index size")],parent_type:["table","partition"],canDrop:!0,canDropCascade:!0,url_jump_after_node:"schema",Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_unique_constraint_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Unique constraint"),icon:"wcTabIcon icon-unique_constraint",data:{action:"create",check:!0},enable:"canCreate"}]))},canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var o=l.tree,a=t,r=e,s=[],d=!1,c=!1,p=this.getTreeNodeHierarchy(a).server.version;a;){if(d||"table"!=r._type&&"partition"!=r._type||(d=!0,"is_partitioned"in r&&r.is_partitioned&&p<11e4&&(c=!0)),n.indexOf(["schema"],r._type)>-1)return!c;s.push(r._type),r=(a=o.hasParent(a)?o.parent(a):null)?o.itemData(a):null}return!(n.indexOf(s,"catalog")>-1)&&!c},model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,comment:void 0,spcname:void 0,index:void 0,fillfactor:void 0,condeferrable:void 0,condeferred:void 0,columns:[],include:[]},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"],editable:!0,cellHeaderClasses:"width_percent_40"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"],editable:!1,cellHeaderClasses:"width_percent_20"},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout((function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)}),10),!0)}},{id:"columns",label:e("Columns"),type:"collection",group:e("Definition"),editable:!1,cell:r.StringCell.extend({initialize:function(){r.StringCell.prototype.initialize.apply(this,arguments);var e=this,t=this.model.get("columns");if(n.isUndefined(e.model.get("oid"))){var i=e.model.top.get("columns");e.listenTo(i,"remove",e.removeColumn),e.listenTo(i,"change:name",e.resetColOptions)}t.on("pgadmin:multicolumn:updated",(function(){e.render.apply(e)})),e.listenTo(t,"add",e.render),e.listenTo(t,"remove",e.render)},removeColumn:function(e){var t=this,i=t.model.get("columns").where({column:e.get("name")});t.model.get("columns").remove(i),setTimeout((function(){t.render()}),10);setTimeout((function(){var e=t.model.top.get("unique_constraint"),i=[];e.each((function(e){0==e.get("columns").length&&i.push(e)})),e.remove(i)}),100)},resetColOptions:function(e){var t=this,i=t.model.get("columns").where({column:e.previous("name")});i.length>0&&i[0].set({column:e.get("name")},{silent:!0}),setTimeout((function(){t.render()}),10)},formatter:{fromRaw:function(e){return e.pluck("column").toString()},toRaw:function(e){return e}},render:function(){return r.StringCell.prototype.render.apply(this,arguments)},remove:function(){var e=this.model.top.get("columns"),t=this.model.get("columns");t&&t.off("pgadmin:multicolumn:updated"),this.stopListening(e,"remove",self.removeColumn),this.stopListening(e,"change:name",self.resetColOptions),r.StringCell.prototype.remove.apply(this,arguments)}}),canDelete:!0,canAdd:!0,control:a.MultiSelectAjaxControl.extend({defaults:n.extend({},a.NodeListByNameControl.prototype.defaults,{select2:{multiple:!0,allowClear:!0,width:"style",placeholder:e("Select the column(s)")}}),keyPathAccessor:function(e,t){var i=e;if(n.isArray(i))return n.map(i,(function(e){return e.column}));t=t.split(".");for(var o=0;o<t.length;o++){if(n.isNull(i))return null;n.isEmpty(t[o])||(n.isUndefined(i[t[o]])||(i=i[t[o]]))}return n.isObject(i)&&!n.isArray(i)?null:i},initialize:function(){var e=this;if(this.model.handler){if(a.Select2Control.prototype.initialize.apply(this,arguments),n.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}else a.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments);e.model.get("columns").on("pgadmin:multicolumn:updated",(function(){e.render.apply(e)}))},resetColOptions:function(){var e=this;setTimeout((function(){e.custom_options(),e.render.apply(e)}),50)},custom_options:function(){var e=this.model.top.get("columns"),t=[];e.length>0&&n.each(e.models,(function(e){var i=e.get("name");n.isUndefined(i)||n.isNull(i)||t.push({label:i,value:i,image:"icon-column"})})),this.field.set("options",t)},onChange:function(){var e=this,t=this.model,i=this.field.get("name").split(".").shift(),o=this.getValueFromDOM(),l=t.get(i),a=[];this.stopListening(this.model,"change:"+i,this.render),l.each((function(e){var t=e.get("column"),i=n.indexOf(o,t);i>-1?o.splice(i,1):a.push(t)})),n.each(o,(function(t){var i=new(e.field.get("model"))({column:t},{silent:!0,top:e.model.top,collection:l,handler:l});l.add(i)})),n.each(a,(function(e){l.remove(l.where({column:e}))})),this.listenTo(this.model,"change:"+i,this.render)},remove:function(){if(this.model.handler){var e=this,t=e.model.top.get("columns");e.stopListening(t,"remove",e.resetColOptions),e.stopListening(t,"change:name",e.resetColOptions),e.model.get("columns").off("pgadmin:multicolumn:updated"),a.Select2Control.prototype.remove.apply(this,arguments)}else a.MultiSelectAjaxControl.prototype.remove.apply(this,arguments)}}),deps:["index"],node:"column",model:l.Node.Model.extend({defaults:{column:void 0},validate:function(){return null}}),transform:function(e){var t=[];return e&&n.isArray(e)&&n.each(e,(function(e){t.push({label:e.label,value:e.label,image:"icon-column"})})),t},select2:{allowClear:!1},readonly:function(e){return!n.has(e,"top")||n.isUndefined(e.top)||e.top.isNew()?!e.isNew()||void 0:!n.isUndefined(e.get("oid"))},disabled:function(e){var t=e.get("index");return!n.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)}},{id:"include",label:e("Include columns"),type:"array",group:e("Definition"),editable:!1,canDelete:!0,canAdd:!0,mode:["properties","create","edit"],visible:function(e){return e=e.top,!n.isUndefined(e.node_info)&&!n.isUndefined(e.node_info.server)&&!n.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=11e4},control:a.MultiSelectAjaxControl.extend({defaults:n.extend({},a.NodeListByNameControl.prototype.defaults,{select2:{allowClear:!1,width:"style",multiple:!0,placeholder:e("Select the column(s)")}}),initialize:function(){var e=this;if(this.model.handler){if(a.Select2Control.prototype.initialize.apply(this,arguments),n.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}else a.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments)},resetColOptions:function(){var e=this;setTimeout((function(){e.custom_options(),e.render.apply(e)}),50)},custom_options:function(){var e=this.model.top.get("columns"),t=[];e.length>0&&n.each(e.models,(function(e){var i=e.get("name");n.isUndefined(i)||n.isNull(i)||t.push({label:i,value:i,image:"icon-column"})})),this.field.set("options",t)}}),deps:["index"],node:"column",readonly:function(e){return!n.has(e,"top")||n.isUndefined(e.top)||e.top.isNew()?!e.isNew()||void 0:!n.isUndefined(e.get("oid"))},disabled:function(e){var t=e.get("index");return!n.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)}},{id:"spcname",label:e("Tablespace"),type:"text",group:e("Definition"),control:"node-list-by-name",node:"tablespace",deps:["index"],select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label},disabled:function(e){var t=(e=e.top||e).get("index");return!n.isUndefined(t)&&""!=t&&(setTimeout((function(){e.set("spcname","")}),10),!0)}},{id:"index",label:e("Index"),type:"text",group:e("Definition"),control:a.NodeListByNameControl.extend({initialize:function(){n.isUndefined(this.model.top)?a.NodeListByNameControl.prototype.initialize.apply(this,arguments):a.Control.prototype.initialize.apply(this,arguments)}}),select2:{allowClear:!0},node:"index",readonly:function(e){return!(!n.has(e,"top")||n.isUndefined(e.top)||e.top.isNew())||!e.isNew()},visible:function(e){return!n.isUndefined(e.top.node_info.table)}},{id:"fillfactor",label:e("Fill factor"),deps:["index"],type:"int",group:e("Definition"),allowNull:!0,disabled:function(e){var t=e.get("index");return!n.isUndefined(t)&&""!=t&&(setTimeout((function(){e.set("fillfactor",null)}),10),!0)}},{id:"condeferrable",label:e("Deferrable?"),type:"switch",group:e("Definition"),deps:["index"],readonly:function(e){return!n.has(e,"top")||n.isUndefined(e.top)||e.top.isNew()?!e.isNew()||void 0:!n.isUndefined(e.get("oid"))},disabled:function(e){var t=e.get("index");return!n.isUndefined(t)&&""!=t&&(setTimeout((function(){e.get("condeferrable")&&e.set("condeferrable",!1)}),10),!0)}},{id:"condeferred",label:e("Deferred?"),type:"switch",group:e("Definition"),deps:["condeferrable"],readonly:function(e){return!n.has(e,"top")||n.isUndefined(e.top)||e.top.isNew()?!e.isNew()||void 0:!n.isUndefined(e.get("oid"))},disabled:function(e){return 1!=e.get("condeferrable")&&(setTimeout((function(){e.get("condeferred")&&e.set("condeferred",!1)}),10),!0)}}],validate:function(){this.errorModel.clear(),n.has(this,"top")&&this.top.errorModel.clear();var t=this.get("columns"),i=this.get("index");if((n.isUndefined(i)||""==String(i).replace(/^\s+|\s+$/g,""))&&(n.isUndefined(t)||n.isNull(t)||t.length<1)){var o=e("Please specify columns for %s",e("Unique constraint"));return this.errorModel.set("columns",o),o}return null}})})),l.Nodes.unique_constraint}.apply(t,n))||(e.exports=o)},460:function(e,t,i){"use strict";var n,o;i(16),i(5),i(9),i(7),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(13),i(45),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r){return l.Nodes.check_constraint||(o.Browser.Nodes.check_constraint=l.Node.extend({type:"check_constraint",label:e("Check"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:t("help.static",{filename:"check_dialog.html"}),hasSQL:!0,hasDepends:!0,parent_type:["table","partition"],url_jump_after_node:"schema",Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_check_constraint_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:5,label:e("Check..."),icon:"wcTabIcon icon-check_constraint",data:{action:"create",check:!0},enable:"canCreate"},{name:"validate_check_constraint",node:"check_constraint",module:this,applies:["object","context"],callback:"validate_check_constraint",category:"validate",priority:4,label:e("Validate check constraint"),icon:"fa fa-link",enable:"is_not_valid",data:{action:"edit",check:!0}}]))},is_not_valid:function(e,t,i){return!!this.canCreate(e,t,i)&&(e&&!e.valid)},callbacks:{validate_check_constraint:function(e){var t=e||{},n=l.tree,o=t.item||n.selected(),r=o&&1==o.length?n.itemData(o):void 0;if(!r)return!1;var s=r;return i.ajax({url:this.generate_url(o,"validate",r,!0),type:"GET"}).done((function(e){1==e.success&&(a.success(e.info),n.removeIcon(o),s.valid=!0,s.icon="icon-check_constraint",n.addIcon(o,{icon:s.icon}),setTimeout((function(){n.deselect(o)}),10),setTimeout((function(){n.select(o)}),100))})).fail((function(e,t,i){a.pgRespErrorNotify(e,i),n.unload(o)})),!1}},canDrop:r.isTreeItemOfChildOfSchema,model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,description:void 0,consrc:void 0,connoinherit:void 0,convalidated:!0},schema:[{id:"name",label:e("Name"),type:"text",cell:"string",readonly:"isReadonly"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:e("Comment"),type:"multiline",cell:"string",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout((function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)}),10),!0)}},{id:"consrc",label:e("Check"),type:"multiline",cell:"string",group:e("Definition"),mode:["properties","create","edit"],readonly:"isReadonly",editable:!1},{id:"connoinherit",label:e("No inherit?"),type:"switch",cell:"boolean",group:e("Definition"),mode:["properties","create","edit"],min_version:90200,disabled:function(e){return!!(n.has(e,"top")&&!n.isUndefined(e.top)&&e.top.get("is_partitioned")||n.has(e,"node_info")&&n.has(e.node_info,"table")&&n.has(e.node_info.table,"is_partitioned")&&e.node_info.table.is_partitioned)&&(setTimeout((function(){e.set("connoinherit",!1)}),10),!0)},readonly:"isReadonly"},{id:"convalidated",label:e("Don't validate?"),type:"switch",cell:"boolean",group:e("Definition"),min_version:90200,disabled:function(e){return!!(n.isFunction(e.isNew)&&!e.isNew()||n.has(e,"handler")&&!n.isUndefined(e.handler)&&!n.isUndefined(e.get("oid")))&&!e.get("convalidated")},mode:["properties","create","edit"]}],validate:function(){var t,i={};return(n.isUndefined(this.get("consrc"))||""==String(this.get("consrc")).replace(/^\s+|\s+$/g,""))&&(i.consrc=e("Check cannot be empty."),t=t||i.consrc),this.errorModel.clear().set(i),n.size(i)?(this.trigger("on-status",{msg:t}),t):null},isReadonly:function(e){return n.has(e,"handler")&&!n.isUndefined(e.handler)&&!n.isUndefined(e.get("oid"))||n.isFunction(e.isNew)&&!e.isNew()}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var o=l.tree,a=t,r=e,s=[];a;){if(n.indexOf(["schema"],r._type)>-1)return!0;s.push(r._type),r=(a=o.hasParent(a)?o.parent(a):null)?o.itemData(a):null}return!(n.indexOf(s,"catalog")>-1)}})),l.Nodes.check_constraint}.apply(t,n))||(e.exports=o)},461:function(e,t,i){"use strict";var n,o;i(28),i(8),i(16),i(21),i(36),i(15),i(11),i(5),i(9),i(7),i(37),n=[i(2),i(6),i(0),i(1),i(14),i(3),i(10),i(13),i(18),i(30),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r,s,d){var c=function(e){if(!e.id)return e.text;var t=i(e.element).data("image");return t?i('<span><span class="wcTabIcon '+t+'"/>'+e.text+"</span>"):e.text},p=n.template(["<div class=\"<%=Backform.controlsClassName%> <%=extraClasses.join(' ')%>\">",'  <select class="pgadmin-node-select form-control" name="<%=name%>" style="width:100%;" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> >','    <%=select2.first_empty ? " <option></option>" : ""%>',"    <% for (var i=0; i < options.length; i++) { %>","    <% var option = options[i]; %>",'    <option <% if (option.image) { %> data-image=<%= option.image %> <% } %> value=<%= formatter.fromRaw(option.value) %> <%=option.value === rawValue ? "selected=\'selected\'" : "" %>><%-option.label%></option>',"    <% } %>","  </select>","</div>"].join("\n")),u=a.Node.Model.extend({defaults:{local_column:void 0,references:void 0,referenced:void 0},schema:[{id:"local_column",label:e("Local"),type:"text",editable:!1,cellHeaderClasses:"width_percent_50",cell:"string",headerCell:d.Extension.CustomHeaderCell},{id:"referenced",label:e("Referenced"),type:"text",editable:!1,cell:"string",cellHeaderClasses:"width_percent_50",headerCell:d.Extension.CustomHeaderCell}]}),m=s.ForeignKeyColumnControl=s.UniqueColCollectionControl.extend({initialize:function(){s.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var t=this,l="foreign_key",a=[{id:"local_column",label:"",type:"text",node:"column",control:s.NodeListByNameControl.extend({initialize:function(){if(t.model.handler){if(s.Select2Control.prototype.initialize.apply(this,arguments),n.isUndefined(t.model.get("oid"))){var e=t.model.top.get("columns");this.listenTo(e,"remove",this.removeColumn),this.listenTo(e,"change:name",this.resetColOptions)}this.custom_options()}else s.NodeListByNameControl.prototype.initialize.apply(this,arguments)},removeColumn:function(){var e=this;setTimeout((function(){e.custom_options(),e.render.apply(e)}),50)},resetColOptions:function(e){var i=this;e.previous("name")==t.headerData.get("local_column")&&(t.headerData.set({local_column:e.get("name")}),t.headerDataChanged()),setTimeout((function(){i.custom_options(),i.render.apply(i)}),50)},custom_options:function(){var e=t.model.top.get("columns"),i=[];e.length>0&&n.each(e.models,(function(e){var t=e.get("name");n.isUndefined(t)||n.isNull(t)||i.push({label:t,value:t,image:"icon-column"})})),this.field.set("options",i)},template:p,remove:function(){if(t.model.handler){var e=t.model.top.get("columns");this.stopListening(e,"remove",this.removeColumn),this.stopListening(e,"change:name",this.resetColOptions),s.Select2Control.prototype.remove.apply(this,arguments)}else s.NodeListByNameControl.prototype.remove.apply(this,arguments)}}),select2:{allowClear:!1,width:"style",placeholder:e("Select column"),first_empty:!n.isUndefined(t.model.get("oid"))},version_compatible:t.field.get("version_compatible"),readonly:function(){return!n.isUndefined(t.model.get("oid"))}},{id:"references",label:"",type:"text",cache_level:"server",select2:{allowClear:!1,width:"style",placeholder:"Select foreign table"},first_empty:!0,control:s.NodeListByNameControl.extend({formatter:s.ControlFormatter,template:p}),url:"all_tables",node:"table",version_compatible:t.field.get("version_compatible"),readonly:function(){return!n.isUndefined(t.model.get("oid"))},transform:function(e){var t=[];return n.each(e,(function(e){t.push({value:e.value,image:"icon-table",label:e.label})})),t}},{id:"referenced",label:"",type:"text",cache_level:"server",transform:function(e){var t=[];return n.each(e,(function(e){t.push({value:e.name,image:"icon-column",label:e.name})})),t},control:s.Select2Control.extend({formatter:s.ControlFormatter,template:p,render:function(){var e=this,t=e.field.get("url")||e.defaults.url,o=e.model,l=o.get("references");if(o.set(e.field.get("name"),null,{silent:!0}),!t||n.isUndefined(l)||n.isNull(l)||""==l)e.field.set("options",[]);else{var a=this.field.get("schema_node"),r=this.field.get("node_info"),d=a.generate_url.apply(a,[null,t,this.field.get("node_data"),this.field.get("url_with_id")||!1,r]),c=[];this.field.get("version_compatible")&&(o.trigger("pgadmin:view:fetching",o,e.field),i.ajax({async:!1,data:{tid:l},url:d}).done((function(e){c=e.data})).fail((function(){o.trigger("pgadmin:view:fetch:error",o,e.field)})),o.trigger("pgadmin:view:fetched",o,e.field));var p=this.field.get("transform")||e.defaults.transform;p&&n.isFunction(p)?e.field.set("options",p.bind(e,c)):e.field.set("options",c)}return s.Select2Control.prototype.render.apply(this,arguments),this}}),url:"get_columns",select2:{allowClear:!1,width:"style",placeholder:e("Select column"),templateResult:c,templateSelection:c},deps:["references"],node:"table",version_compatible:t.field.get("version_compatible"),readonly:function(){return!n.isUndefined(t.model.get("oid"))}}],r={local_column:null,references:null,referenced:null},d=["local_column","references","referenced"];if(!t.model.isNew()&&n.isUndefined(t.model.handler)||n.has(t.model,"handler")&&!n.isUndefined(t.model.handler)&&!n.isUndefined(t.model.get("oid"))){var u=t.collection.first();u&&(r.references=u.get("references"))}t.headerData=new(o.Model.extend({defaults:r,schema:a}))({});var m=s.generateViewSchema(t.field.get("node_info"),t.headerData,"create",l,t.field.get("node_data")),h=[];n.each(m,(function(e){h=h.concat(e.fields)})),t.headerFields=new s.Fields(h),t.gridSchema=s.generateGridColumnsFromModel(t.field.get("node_info"),t.field.get("model"),"edit",d,t.field.get("schema_node")),t.controls=[],t.listenTo(t.headerData,"change",t.headerDataChanged),t.listenTo(t.headerData,"select2",t.headerDataChanged),t.listenTo(t.collection,"add",t.onAddorRemoveColumns),t.listenTo(t.collection,"remove",t.onAddorRemoveColumns)},generateHeader:function(t){var o=['<div class="subnode-header-form">'," <div>",'  <div class="row">','   <div class="col-md-4">','    <label class="control-label"><%-column_label%></label>',"   </div>",'   <div class="col-md-6" header="local_column"></div>',"  </div>",'  <div class="row">','   <div class="col-md-4">','    <label class="control-label"><%-references_label%></label>',"   </div>",'   <div class="col-md-6" header="references"></div>',"  </div>",'  <div class="row">','   <div class="col-md-4">','    <label class="control-label"><%-referenced_label%></label>',"   </div>",'   <div class="col-md-6" header="referenced"></div>',"  </div>"," </div>","</div>"].join("\n");n.extend(t,{column_label:e("Local column"),references_label:e("References"),referenced_label:e("Referencing")});var l=this,a=n.template(o),r=i(a(t)),s=this.controls;return this.headerFields.each((function(e){var t=new(e.get("control"))({field:e,model:l.headerData});r.find('div[header="'+e.get("name")+'"]').append(t.render().$el),s.push(t)})),"properties"==t.mode&&r.html(""),l.$header=r,r},events:n.extend({},s.UniqueColCollectionControl.prototype.events,{"click button.add":"addColumns"}),showGridControl:function(e){var t=this,o=n.template(['<div class="subnode-header">','  <label class="control-label pg-el-sm-10"><%-label%></label>','  <button class="btn btn-sm-sq btn-secondary add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> title="'+n("Add new row")+'"></button>',"</div>"].join("\n")),l=i("<div class='pgadmin-control-group backgrid form-group col-12 object subnode'></div>").append("properties"!==e.mode?o({label:e.label,canAdd:e.canAdd}):"");t.grid&&t.grid.remove(),l.append(t.generateHeader(e));var a=n.clone(this.gridSchema);0==e.disabled&&e.canDelete&&a.columns.unshift({name:"pg-backform-delete",label:"",cell:d.Extension.DeleteCell,editable:!1,cell_priority:-1});var r=t.grid=new d.Grid({columns:a.columns,collection:t.collection,className:"backgrid table-bordered table-noouter-border table-hover"});return t.$grid=r.render().$el,l.append(t.$grid),setTimeout((function(){t.headerData.set({local_column:t.$header.find('div[header="local_column"] select option:first').val(),referenced:t.$header.find('div[header="referenced"] select option:first').val(),references:t.$header.find('div[header="references"] select option:first').val()},{silent:!0})}),10),"properties"===e.mode&&l.find(".subnode-header-form").removeClass("subnode-header-form"),t.$gridBody=l,l},headerDataChanged:function(){var e,t=this.headerData.toJSON(),i=!1,o=["local_column","referenced"];this.$header&&(this.control_data.canAdd?this.collection.each((function(l){i||n.each(o,(function(o){i||(e=l.get(o),i=(n.isUndefined(e)||n.isNull(e))&&(n.isUndefined(t[o])||n.isNull(t[o]))||e==t[o])}))})):i=!0,this.$gridBody.find("button.add").prop("disabled",i))},addColumns:function(e){e.preventDefault();var t=this.headerData.get("local_column"),n=this.headerData.get("referenced");if(!t||""==t||!n||""==n)return!1;var o=new(this.field.get("model"))(this.headerData.toJSON()),l=this.model.get(this.field.get("name"));l.add(o);var a=l.indexOf(o);if(a>-1){this.$grid.find(".new").removeClass("new");var r=this.grid.body.rows[a].$el;r.addClass("new"),i(r).pgMakeVisible("backform-tab")}return!1},onAddorRemoveColumns:function(){var e=this;setTimeout((function(){e.collection.length>0?e.$header.find('div[header="references"] select').prop("disabled",!0):e.$header.find('div[header="references"] select').prop("disabled",!1),e.collection.trigger("pgadmin:columns:updated",e.collection),e.headerDataChanged(),(!n.has(e.model,"handler")||n.has(e.model,"handler")&&n.isUndefined(e.model.handler)||n.has(e.model,"handler")&&!n.isUndefined(e.model.handler)&&!n.isUndefined(e.model.handler.get("oid")))&&e.getCoveringIndex()}),10)},getCoveringIndex:function(){var e=this,t=e.model,n=[],o=null;if(e.collection.each((function(e){n.push(e.get("local_column"))})),n.length>0){var l=this.field.get("schema_node"),a=this.field.get("node_info"),r=l.generate_url.apply(l,[null,"get_coveringindex",this.field.get("node_data"),this.field.get("url_with_id")||!1,a,"schema"]);this.field.get("version_compatible")&&(t.trigger("pgadmin:view:fetching",t,e.field),i.ajax({async:!1,data:{cols:JSON.stringify(n)},url:r}).done((function(e){o=e.data})).fail((function(){t.trigger("pgadmin:view:fetch:error",t,e.field)})),t.trigger("pgadmin:view:fetched",t,e.field))}o?(t.set("hasindex",!0),t.set("autoindex",!1),t.set("coveringindex",o)):(t.set("coveringindex",null),t.set("autoindex",!0),t.set("hasindex",!1))},remove:function(){this.stopListening(this.headerData,"change",this.headerDataChanged),this.listenTo(this.headerData,"select2",this.headerDataChanged),this.listenTo(this.collection,"remove",this.onRemoveVariable),n.each(this.controls,(function(e){e.remove()})),m.__super__.remove.apply(this,arguments),delete this.headerData}});return a.Nodes.foreign_key||(l.Browser.Nodes.foreign_key=a.Node.extend({type:"foreign_key",label:e("Foreign key"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:t("help.static",{filename:"foreign_key_dialog.html"}),hasSQL:!0,parent_type:["table","partition"],canDrop:!0,canDropCascade:!0,hasDepends:!0,url_jump_after_node:"schema",Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_foreign_key_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Foreign key..."),icon:"wcTabIcon icon-foreign_key",data:{action:"create",check:!0},enable:"canCreate"},{name:"validate_foreign_key",node:"foreign_key",module:this,applies:["object","context"],callback:"validate_foreign_key",category:"validate",priority:4,label:e("Validate foreign key"),icon:"fa fa-link",enable:"is_not_valid"}]))},is_not_valid:function(e){return e&&!e.valid},callbacks:{validate_foreign_key:function(e){var t=e||{},n=a.tree,o=t.item||n.selected(),l=o&&1==o.length?n.itemData(o):void 0;if(!l)return!1;var s=l;return i.ajax({url:this.generate_url(o,"validate",l,!0),type:"GET"}).done((function(e){1==e.success&&(r.success(e.info),n.removeIcon(o),s.valid=!0,s.icon="icon-foreign_key",n.addIcon(o,{icon:s.icon}),setTimeout((function(){n.deselect(o)}),10),setTimeout((function(){n.select(o)}),100))})).fail((function(e,t,i){r.pgRespErrorNotify(e,i),n.unload(o)})),!1}},model:l.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,comment:void 0,condeferrable:void 0,condeferred:void 0,confmatchtype:void 0,convalidated:void 0,columns:void 0,confupdtype:"a",confdeltype:"a",autoindex:!0,coveringindex:void 0,hasindex:void 0},toJSON:function(){var e=l.Browser.Node.Model.prototype.toJSON.apply(this,arguments);return delete e.hasindex,e},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"],editable:!0,headerCell:d.Extension.CustomHeaderCell,cellHeaderClasses:"width_percent_50"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout((function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)}),10),!0)}},{id:"condeferrable",label:e("Deferrable?"),type:"switch",group:e("Definition"),readonly:function(e){return n.has(e,"handler")&&!n.isUndefined(e.handler)?!n.isUndefined(e.get("oid")):!e.isNew()}},{id:"condeferred",label:e("Deferred?"),type:"switch",group:e("Definition"),deps:["condeferrable"],disabled:function(e){return 1!=e.get("condeferrable")&&(setTimeout((function(){e.get("condeferred")&&e.set("condeferred",!1)}),10),!0)},readonly:function(e){return n.has(e,"handler")&&!n.isUndefined(e.handler)?!n.isUndefined(e.get("oid")):!e.isNew()}},{id:"confmatchtype",label:e("Match type"),type:"switch",group:e("Definition"),options:{onText:"FULL",offText:"SIMPLE",width:"80"},readonly:function(e){return n.has(e,"handler")&&!n.isUndefined(e.handler)?!n.isUndefined(e.get("oid")):!e.isNew()}},{id:"convalidated",label:e("Validated?"),type:"switch",group:e("Definition"),options:{onText:e("Yes"),offText:e("No")},readonly:function(e){return n.has(e,"handler")&&!n.isUndefined(e.handler)?!(n.isUndefined(e.get("oid"))||!e.get("convalidated")):!(e.isNew()||!e.get("convalidated"))}},{id:"autoindex",label:e("Auto FK index?"),type:"switch",group:e("Definition"),deps:["name","hasindex"],options:{onText:e("Yes"),offText:e("No")},disabled:function(e){var t=e.get("coveringindex"),i=e.get("autoindex"),o=function(){var i=e.get("name"),o="fki_"+e.previous("name");if(e.get("hasindex"))return!0;if(!e.get("autoindex")||n.isUndefined(i)||n.isNull(i)||""==i||!n.isUndefined(t)&&!n.isNull(t)&&""!=t&&t!=o)return!1;var l="fki_"+i;return e.set("coveringindex",l),!1};return n.has(e,"handler")&&!n.isUndefined(e.handler)?n.isUndefined(e.get("oid"))&&n.isUndefined(e.handler.get("oid"))?(setTimeout((function(){e.get("autoindex")&&e.set("autoindex",!1)}),10),!0):o():!(e.isNew()||!i||n.isUndefined(t)||n.isNull(t)||""==t||!e.get("hasindex"))||o()}},{id:"coveringindex",label:e("Covering index"),type:"text",mode:["properties","create","edit"],group:e("Definition"),deps:["autoindex","hasindex"],disabled:function(e){var t=e.get("coveringindex");return!(e.isNew()||!e.get("autoindex")||n.isUndefined(t)||!n.isNull(t)||""!=t)||(!!e.get("hasindex")||(e.get("autoindex")?(setTimeout((function(){var t=e.get("name"),i="fki_"+t;!e.get("autoindex")||n.isUndefined(t)||n.isNull(t)||""==t||e.set("coveringindex",i)})),!1):(setTimeout((function(){e.set("coveringindex",null)})),!0)))},readonly:function(e){return n.has(e,"handler")&&!n.isUndefined(e.handler)?!n.isUndefined(e.get("oid")):!e.isNew()}},{id:"columns",label:e("Columns"),type:"collection",group:e("Columns"),node:"foreign_key",editable:!1,headerCell:d.Extension.CustomHeaderCell,cellHeaderClasses:"width_percent_50",cell:d.StringCell.extend({initialize:function(){d.StringCell.prototype.initialize.apply(this,arguments);var e=this,t=this.model.get("columns");if(n.isUndefined(e.model.get("oid"))){var i=e.model.top.get("columns");e.listenTo(i,"remove",e.removeColumn),e.listenTo(i,"change:name",e.resetColOptions)}e.model.get("columns").on("pgadmin:columns:updated",(function(){e.render.apply(e)})),e.listenTo(t,"add",e.render),e.listenTo(t,"remove",e.render)},removeColumn:function(e){var t=this,i=t.model.get("columns").where({local_column:e.get("name")});t.model.get("columns").remove(i),setTimeout((function(){t.render()}),10),setTimeout((function(){var e=t.model.top.get("foreign_key"),i=[];e.each((function(e){0==e.get("columns").length&&i.push(e)})),e.remove(i)}),100)},resetColOptions:function(e){var t=this,i=t.model.get("columns").where({local_column:e.previous("name")});i.length>0&&i[0].set({local_column:e.get("name")}),setTimeout((function(){t.render()}),10)},formatter:{fromRaw:function(e){var t=[],i=[];return e.length>0?(e.each((function(e){t.push(e.get("local_column")),i.push(e.get("referenced"))})),"("+t.join(", ")+") -> ("+i.join(", ")+")"):""},toRaw:function(e){return e}},render:function(){return d.StringCell.prototype.render.apply(this,arguments)},remove:function(){var e=this.model.top.get("columns");this.stopListening(e,"remove",self.removeColumn),this.stopListening(e,"change:name",self.resetColOptions),d.StringCell.prototype.remove.apply(this,arguments)}}),canAdd:function(e){return e.isNew()},canDelete:!0,control:m,model:u,readonly:function(e){return n.has(e,"handler")&&!n.isUndefined(e.handler)?!n.isUndefined(e.get("oid")):!e.isNew()}},{id:"confupdtype",label:e("On update"),type:"select2",group:e("Action"),mode:["edit","create"],select2:{width:"50%",allowClear:!1},options:[{label:"NO ACTION",value:"a"},{label:"RESTRICT",value:"r"},{label:"CASCADE",value:"c"},{label:"SET NULL",value:"n"},{label:"SET DEFAULT",value:"d"}],readonly:function(e){return n.has(e,"handler")&&!n.isUndefined(e.handler)?!n.isUndefined(e.get("oid")):!e.isNew()}},{id:"confdeltype",label:e("On delete"),type:"select2",group:e("Action"),mode:["edit","create"],select2:{width:"50%",allowClear:!1},options:[{label:"NO ACTION",value:"a"},{label:"RESTRICT",value:"r"},{label:"CASCADE",value:"c"},{label:"SET NULL",value:"n"},{label:"SET DEFAULT",value:"d"}],readonly:function(e){return n.has(e,"handler")&&!n.isUndefined(e.handler)?!n.isUndefined(e.get("oid")):!e.isNew()}}],validate:function(){var t,i=this.get("columns");if(this.errorModel.clear(),n.isUndefined(i)||n.isNull(i)||i.length<1)return t=e("Please specify columns for Foreign key."),this.errorModel.set("columns",t),t;var o=this.get("coveringindex");return this.get("autoindex")&&(n.isUndefined(o)||n.isNull(o)||""==String(o).replace(/^\s+|\s+$/g,""))?(t=e("Please specify covering index name."),this.errorModel.set("coveringindex",t),t):null}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var o=a.tree,l=t,r=e,s=[],d=!1,c=!1,p=this.getTreeNodeHierarchy(l).server.version;l;){if(d||"table"!=r._type&&"partition"!=r._type||(d=!0,"is_partitioned"in r&&r.is_partitioned&&p<11e4&&(c=!0)),n.indexOf(["schema"],r._type)>-1)return!c;s.push(r._type),r=(l=o.hasParent(l)?o.parent(l):null)?o.itemData(l):null}return!(n.indexOf(s,"catalog")>-1)&&!c}})),a.Nodes.foreign_key}.apply(t,n))||(e.exports=o)},462:function(e,t,i){"use strict";var n,o;i(28),i(8),i(16),i(21),i(36),i(32),i(15),i(11),i(12),i(43),i(7),i(37),n=[i(2),i(6),i(0),i(1),i(14),i(3),i(10),i(48),i(18),i(30),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r,s,d){var c=a.Node.Model.extend({defaults:{column:void 0,oper_class:void 0,order:!1,nulls_order:!1,operator:void 0,col_type:void 0,is_sort_nulls_applicable:!0},toJSON:function(){var e=a.Node.Model.prototype.toJSON.apply(this,arguments);return delete e.col_type,e},schema:[{id:"column",label:e("Column"),type:"text",editable:!1,cell:"string"},{id:"oper_class",label:e("Operator class"),type:"text",node:"table",url:"get_oper_class",first_empty:!0,editable:function(e){return e instanceof o.Collection||!(n.has(e.collection,"handler")&&!n.isUndefined(e.collection.handler)&&!n.isUndefined(e.collection.handler.get("oid")))&&!(n.has(e.collection,"handler")&&!n.isUndefined(e.collection.handler)&&!n.isUndefined(e.collection.handler.get("amname"))&&"btree"!=e.collection.handler.get("amname"))},select2:{allowClear:!0,width:"style",tags:!0,placeholder:e("Select the operator class")},cell:d.Extension.Select2Cell.extend({initialize:function(){d.Extension.Select2Cell.prototype.initialize.apply(this,arguments);var e=this,t=e.column.get("url")||e.defaults.url,o=e.model,l=e.model.collection.handler.get("amname");if(t&&("btree"==l||n.isUndefined(l)||n.isNull(l)||""==l)){setTimeout((function(){o.set("order",!0),o.set("nulls_order",!0)}),10);var a=this.column.get("schema_node"),r=o.top||o,s=this.column.get("node_info"),c=a.generate_url.apply(a,[null,t,this.column.get("node_data"),this.column.get("url_with_id")||!1,s]),p=[];l="btree",this.column.get("version_compatible")&&(r.trigger("pgadmin:view:fetching",o,e.column),i.ajax({async:!1,data:{indextype:l},url:c}).done((function(t){p=t.data,e.column.set("options",p)})).fail((function(){r.trigger("pgadmin:view:fetch:error",o,e.column)})),r.trigger("pgadmin:view:fetched",o,e.column))}else e.column.set("options",[])}})},{id:"order",label:e("DESC"),type:"switch",options:{onText:"ASC",offText:"DESC"},editable:function(e){return e instanceof o.Collection||!(n.has(e.collection,"handler")&&!n.isUndefined(e.collection.handler)&&!n.isUndefined(e.collection.handler.get("oid")))&&("btree"===e.top.get("amname")?(e.set("is_sort_nulls_applicable",!0),!0):(e.set("is_sort_nulls_applicable",!1),!1))}},{id:"nulls_order",label:e("NULLs order"),type:"switch",options:{onText:"FIRST",offText:"LAST"},editable:function(e){return e instanceof o.Collection||!(n.has(e.collection,"handler")&&!n.isUndefined(e.collection.handler)&&!n.isUndefined(e.collection.handler.get("oid")))&&("btree"===e.top.get("amname")?(e.set("is_sort_nulls_applicable",!0),!0):(e.set("is_sort_nulls_applicable",!1),!1))}},{id:"operator",label:e("Operator"),type:"text",node:"table",url:"get_operator",editable:function(e){return e instanceof o.Collection||!(n.has(e.collection,"handler")&&!n.isUndefined(e.collection.handler)&&!n.isUndefined(e.collection.handler.get("oid")))},select2:{allowClear:!1,width:"style"},cell:d.Extension.Select2Cell.extend({initialize:function(){d.Extension.Select2Cell.prototype.initialize.apply(this,arguments);var e=this,t=e.column.get("url")||e.defaults.url,o=e.model,l=e.model.get("col_type");if(e.column.set("options",[]),t&&!n.isUndefined(l)&&!n.isNull(l)&&""!=l){var a=this.column.get("schema_node"),r=o.top||o,s=this.column.get("node_info"),c=a.generate_url.apply(a,[null,t,this.column.get("node_data"),this.column.get("url_with_id")||!1,s]),p=[];this.column.get("version_compatible")&&(r.trigger("pgadmin:view:fetching",o,e.column),i.ajax({async:!1,data:{col_type:l},url:c}).done((function(t){p=t.data,e.column.set("options",p)})).fail((function(){r.trigger("pgadmin:view:fetch:error",o,e.column)})),r.trigger("pgadmin:view:fetched",o,e.column))}}})}],validate:function(){this.errorModel.clear();var t=this.get("operator"),i=this.get("column");if(n.isUndefined(t)||n.isNull(t)){var o=e("Please specify operator for column: ")+i;return this.errorModel.set("operator",o),o}return null}}),p=s.ExclusionConstraintColumnControl=s.UniqueColCollectionControl.extend({initialize:function(){s.UniqueColCollectionControl.prototype.initialize.apply(this,arguments);var e=this,t="exclusion_constraint",i=[{id:"column",label:"",type:"text",node:"column",control:s.NodeListByNameControl.extend({initialize:function(){if(e.model.handler){if(s.Select2Control.prototype.initialize.apply(this,arguments),n.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");this.listenTo(t,"remove",this.removeColumn),this.listenTo(t,"change:name",this.resetColOptions),this.listenTo(t,"change:cltype",this.resetColOptions)}this.custom_options()}else s.NodeListByNameControl.prototype.initialize.apply(this,arguments)},removeColumn:function(){var e=this;setTimeout((function(){e.custom_options(),e.render.apply(e)}),50)},resetColOptions:function(t){var i=this;t.previous("name")==e.headerData.get("column")&&(e.headerData.set({column:t.get("name")}),e.headerDataChanged()),setTimeout((function(){i.custom_options(),i.render.apply(i)}),50)},custom_options:function(){var t=e.model.top.get("columns"),i=[],o=[];t.length>0&&n.each(t.models,(function(e){var t=e.get("name");n.isUndefined(t)||n.isNull(t)||(i.push({label:t,value:t,image:"icon-column"}),o.push({name:t,type:e.get("cltype")}))})),this.field.set("options",i),e.field.set("col_types",o)},remove:function(){if(e.model.handler){var t=e.model.top.get("columns");this.stopListening(t,"remove",this.removeColumn),this.stopListening(t,"change:name",this.resetColOptions),this.stopListening(t,"change:cltype",this.resetColOptions),s.Select2Control.prototype.remove.apply(this,arguments)}else s.NodeListByNameControl.prototype.remove.apply(this,arguments)},template:n.template(["<div class=\"<%=Backform.controlsClassName%> <%=extraClasses.join(' ')%>\">",'  <select class="pgadmin-node-select form-control" name="<%=name%>" style="width:100%;" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> >',"    <% for (var i=0; i < options.length; i++) { %>","    <% var option = options[i]; %>",'    <option <% if (option.image) { %> data-image=<%= option.image %> <% } %> value=<%= formatter.fromRaw(option.value) %> <%=option.value === rawValue ? "selected=\'selected\'" : "" %>><%-option.label%></option>',"    <% } %>","  </select>","</div>"].join("\n"))}),transform:function(t){var i=this,o=i.field.get("schema_node"),l=[],a=[],r=i.field.get("filter")||function(){return!0};return r=r.bind(i),n.each(t,(function(e){if(r(e)){var t=n.isFunction(o.node_label)?o.node_label.apply(o,[e,i.model,i]):e.label,s=n.isFunction(o.node_image)?o.node_image.apply(o,[e,i.model,i]):o.node_image||"icon-"+o.type;l.push({value:e.label,image:s,label:t}),a.push({name:e.label,type:e.datatype})}})),e.field.set("col_types",a),l},canAdd:function(e){return!(n.has(e,"handler")&&!n.isUndefined(e.handler)&&!n.isUndefined(e.get("oid"))||n.isFunction(e.isNew)&&!e.isNew())},select2:{allowClear:!1,width:"style",placeholder:"Select column"},first_empty:!e.model.isNew(),readonly:function(){return!n.isUndefined(e.model.get("oid"))}}],l={column:null},a=["column","oper_class","order","nulls_order","operator"];e.headerData=new(o.Model.extend({defaults:l,schema:i}))({});var r=s.generateViewSchema(e.field.get("node_info"),e.headerData,"create",t,e.field.get("node_data")),d=[];n.each(r,(function(e){d=d.concat(e.fields)})),e.headerFields=new s.Fields(d),e.gridSchema=s.generateGridColumnsFromModel(e.field.get("node_info"),e.field.get("model"),"edit",a,e.field.get("schema_node")),e.controls=[],e.listenTo(e.headerData,"change",e.headerDataChanged),e.listenTo(e.headerData,"select2",e.headerDataChanged),e.listenTo(e.collection,"add",e.onAddorRemoveColumns),e.listenTo(e.collection,"remove",e.onAddorRemoveColumns)},generateHeader:function(t){var o=['<div class="subnode-header-form">'," <div>",'  <div class="row">','   <div class="col-4">','    <label class="control-label"><%-column_label%></label>',"   </div>",'   <div class="col-4" header="column"></div>',"  </div>"," </div>","</div>"].join("\n");n.extend(t,{column_label:e("Column")});var l=this,a=n.template(o),r=i(a(t)),s=this.controls;return this.headerFields.each((function(e){var t=new(e.get("control"))({field:e,model:l.headerData});r.find('div[header="'+e.get("name")+'"]').append(t.render().$el),s.push(t)})),"properties"==t.mode&&r.html(""),l.$header=r,r},events:n.extend({},s.UniqueColCollectionControl.prototype.events,{"click button.add":"addColumns"}),showGridControl:function(e){var t=this,o=n.template(['<div class="subnode-header">','  <label class="control-label pg-el-sm-10"><%-label%></label>','  <button class="btn btn-sm-sq btn-secondary add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> title="'+n("Add new row")+'"></button>',"</div>"].join("\n")),l=i("<div class='pgadmin-control-group backgrid form-group col-12 object subnode'></div>").append("properties"!==e.mode?o({label:e.label,canAdd:e.canAdd}):"");l.append(t.generateHeader(e));var a=n.clone(this.gridSchema.columns);0==e.disabled&&e.canDelete&&a.unshift({name:"pg-backform-delete",label:"",cell:d.Extension.DeleteCell,editable:!1,cell_priority:-1}),t.grid&&(t.grid.remove(),t.grid.null);var r=t.grid=new d.Grid({columns:a,collection:t.collection,className:"backgrid table-bordered table-noouter-border table-hover"});return t.$grid=r.render().$el,l.append(t.$grid),setTimeout((function(){t.headerData.set({column:t.$header.find('div[header="column"] select').val()},{silent:!0})}),10),"properties"===e.mode&&l.find(".subnode-header-form").removeClass("subnode-header-form"),t.$gridBody=l,l},headerDataChanged:function(){var e,t=this.headerData.toJSON(),i=!1,o=["column"];this.$header&&(this.control_data.canAdd?this.collection.each((function(l){i||n.each(o,(function(o){i||(e=l.get(o),i=(n.isUndefined(e)||n.isNull(e))&&(n.isUndefined(t[o])||n.isNull(t[o]))||e==t[o])}))})):i=!0,this.$gridBody.find("button.add").prop("disabled",i))},addColumns:function(e){e.preventDefault();var t=this.headerData.get("column");if(!t||""==t)return!1;for(var n=this.model.get(this.field.get("name")),o=new(this.field.get("model"))(this.headerData.toJSON(),{silent:!0,top:this.model.top,collection:n,handler:n}),l=this.field.get("col_types")||[],a=0;a<l.length;a++){var r=l[a];if(r.name==o.get("column")){o.set({col_type:r.type});break}}n.add(o);var s=n.indexOf(o);if(s>-1){this.$grid.find(".new").removeClass("new");var d=this.grid.body.rows[s].$el;d.addClass("new"),i(d).pgMakeVisible("backform-tab")}return!1},onAddorRemoveColumns:function(){var e=this;setTimeout((function(){e.collection.trigger("pgadmin:columns:updated",e.collection),e.headerDataChanged()}),10)},remove:function(){this.stopListening(this.headerData,"change",this.headerDataChanged),this.listenTo(this.headerData,"select2",this.headerDataChanged),this.listenTo(this.collection,"remove",this.onAddorRemoveColumns),n.each(this.controls,(function(e){e.remove()})),p.__super__.remove.apply(this,arguments),delete this.headerData}});return a.Nodes.exclusion_constraint||(l.Browser.Nodes.exclusion_constraint=a.Node.extend({type:"exclusion_constraint",label:e("Exclusion constraint"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:t("help.static",{filename:"exclusion_constraint_dialog.html"}),hasSQL:!0,parent_type:["table","partition"],canDrop:!0,canDropCascade:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[e("Index size")],url_jump_after_node:"schema",Init:function(){this.initialized||(this.initialized=!0,a.add_menus([{name:"create_exclusion_constraint_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Exclusion constraint..."),icon:"wcTabIcon icon-exclusion_constraint",data:{action:"create",check:!0},enable:"canCreate"}]))},is_not_valid:function(e){return e&&!e.valid},model:l.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,comment:void 0,spcname:void 0,amname:"gist",fillfactor:void 0,condeferrable:void 0,condeferred:void 0,columns:[],include:[]},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"],editable:!0},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"]},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout((function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)}),10),!0)}},{id:"spcname",label:e("Tablespace"),type:"text",group:e("Definition"),control:"node-list-by-name",node:"tablespace",select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label}},{id:"amname",label:e("Access method"),type:"text",group:e("Definition"),url:"get_access_methods",node:"table",control:s.NodeAjaxOptionsControl.extend({onChange:function(){s.NodeAjaxOptionsControl.prototype.onChange.apply(this,arguments);var t=this,i=t.model.get("amname"),n=t.model.previous("amname"),o=t.model.get("columns");if(o.length>0&&i!=n){var l=e("Changing access method will clear columns collection");r.confirm(l,(function(){o.each((function(e){o.remove(e)})),setTimeout((function(){o.trigger("pgadmin:columns:updated",o)}),10)}),(function(){setTimeout((function(){t.model.set("amname",n)}),10)}))}}}),select2:{allowClear:!0},readonly:function(e){return n.has(e,"handler")&&!n.isUndefined(e.handler)&&!n.isUndefined(e.get("oid"))||n.isFunction(e.isNew)&&!e.isNew()}},{id:"fillfactor",label:e("Fill factor"),type:"int",group:e("Definition"),allowNull:!0},{id:"condeferrable",label:e("Deferrable?"),type:"switch",group:e("Definition"),deps:["index"],readonly:function(e){return n.has(e,"handler")&&!n.isUndefined(e.handler)&&!n.isUndefined(e.get("oid"))||n.isFunction(e.isNew)&&!e.isNew()}},{id:"condeferred",label:e("Deferred?"),type:"switch",group:e("Definition"),deps:["condeferrable"],disabled:function(e){return 1!=e.get("condeferrable")&&(setTimeout((function(){e.get("condeferred")&&e.set("condeferred",!1)}),10),!0)},readonly:function(e){if(n.has(e,"handler")&&!n.isUndefined(e.handler)&&!n.isUndefined(e.get("oid"))||n.isFunction(e.isNew)&&!e.isNew())return!0}},{id:"indconstraint",label:e("Constraint"),cell:"string",type:"multiline",mode:["create","edit","properties"],editable:!1,group:e("Definition"),readonly:function(e){return n.has(e,"handler")&&!n.isUndefined(e.handler)&&!n.isUndefined(e.get("oid"))||n.isFunction(e.isNew)&&!e.isNew()}},{id:"columns",label:e("Columns"),type:"collection",group:e("Columns"),deps:["amname"],canDelete:!0,editable:!1,canAdd:function(e){return!(n.has(e,"handler")&&!n.isUndefined(e.handler)&&!n.isUndefined(e.get("oid"))||n.isFunction(e.isNew)&&!e.isNew())},control:p,model:c,readonly:function(e){return n.has(e,"handler")&&!n.isUndefined(e.handler)&&!n.isUndefined(e.get("oid"))||n.isFunction(e.isNew)&&!e.isNew()},cell:d.StringCell.extend({initialize:function(){d.StringCell.prototype.initialize.apply(this,arguments);var e=this;if(n.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.removeColumn),e.listenTo(t,"change:name",e.resetColOptions),e.listenTo(t,"change:cltype",e.removeColumnWithType)}this.model.get("columns").on("pgadmin:columns:updated",(function(){e.render.apply(e)}))},removeColumnWithType:function(e){var t=this,i=t.model.get("columns"),n=i.where({col_type:e.previous("cltype")});i.remove(n),setTimeout((function(){t.render()}),10),setTimeout((function(){var e=t.model.top.get("exclude_constraint"),i=[];e.each((function(e){0==e.get("columns").length&&i.push(e)})),e.remove(i)}),100)},removeColumn:function(e){var t=this,i=t.model.get("columns").where({column:e.get("name")});t.model.get("columns").remove(i),setTimeout((function(){t.render()}),10),setTimeout((function(){var e=t.model.top.get("exclude_constraint"),i=[];e.each((function(e){0==e.get("columns").length&&i.push(e)})),e.remove(i)}),100)},resetColOptions:function(e){var t=this,i=t.model.get("columns").where({column:e.previous("name")});i.length>0&&i[0].set({column:e.get("name")}),setTimeout((function(){t.render()}),10)},formatter:{fromRaw:function(e){return e.pluck("column").toString()},toRaw:function(e){return e}},render:function(){return d.StringCell.prototype.render.apply(this,arguments)},remove:function(){var e=this.model.top.get("columns"),t=this.model.get("columns");t&&t.off("pgadmin:columns:updated"),this.stopListening(e,"remove",self.removeColumn),this.stopListening(e,"change:name",self.resetColOptions),this.stopListening(e,"change:cltype",self.removeColumnWithType),d.StringCell.prototype.remove.apply(this,arguments)}})},{id:"include",label:e("Include columns"),type:"array",group:e("Columns"),editable:!1,canDelete:!0,canAdd:!0,mode:["properties","create","edit"],visible:function(e){return e=e.top,!n.isUndefined(e.node_info)&&!n.isUndefined(e.node_info.server)&&!n.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=11e4},control:s.MultiSelectAjaxControl.extend({defaults:n.extend({},s.NodeListByNameControl.prototype.defaults,{select2:{allowClear:!1,width:"style",multiple:!0,placeholder:e("Select the column(s)")}}),initialize:function(){var e=this;if(this.model.handler){if(s.Select2Control.prototype.initialize.apply(this,arguments),n.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}else s.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments)},resetColOptions:function(){var e=this;setTimeout((function(){e.custom_options(),e.render.apply(e)}),50)},custom_options:function(){var e=this.model.top.get("columns"),t=[];e.length>0&&n.each(e.models,(function(e){var i=e.get("name");n.isUndefined(i)||n.isNull(i)||t.push({label:i,value:i,image:"icon-column"})})),this.field.set("options",t)}}),deps:["index"],node:"column",disabled:function(e){var t=e.get("index");return!n.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)},readonly:function(e){return!n.has(e,"top")||n.isUndefined(e.top)||e.top.isNew()?!e.isNew():!n.isUndefined(e.get("oid"))}}],validate:function(){this.errorModel.clear();var t,i=this.get("columns"),o=this.get("name");return n.isUndefined(o)||n.isNull(o)||o.length<1?(t=e("Please specify name for exclusion constraint."),this.errorModel.set("name",t),t):n.isUndefined(i)||n.isNull(i)||i.length<1?(t=e("Please specify columns for exclusion constraint."),this.errorModel.set("columns",t),t):null}}),canCreate:function(e,t,i){if(i&&0==i.check)return!0;for(var o=a.tree,l=t,r=e,s=[],d=!1,c=!1;l;){if(d||"table"!=r._type&&"partition"!=r._type||(d=!0,"is_partitioned"in r&&r.is_partitioned&&(c=!0)),n.indexOf(["schema"],r._type)>-1)return!c;s.push(r._type),r=(l=o.hasParent(l)?o.parent(l):null)?o.itemData(l):null}return!(n.indexOf(s,"catalog")>-1)&&!c}})),a.Nodes.exclusion_constraint}.apply(t,n))||(e.exports=o)},463:function(e,t,i){"use strict";var n,o;i(16),i(34),i(47),i(32),i(12),i(5),i(43),i(9),i(29),i(7),n=[i(2),i(6),i(0),i(1),i(3),i(10),i(18),i(30),i(25)],void 0===(o=function(e,t,i,n,o,l,a,r){return l.Nodes.primary_key||(o.Browser.Nodes.primary_key=l.Node.extend({type:"primary_key",label:e("Primary key"),collection_type:"coll-constraints",sqlAlterHelp:"ddl-alter.html",sqlCreateHelp:"ddl-constraints.html",dialogHelp:t("help.static",{filename:"primary_key_dialog.html"}),hasSQL:!0,hasDepends:!0,hasStatistics:!0,statsPrettifyFields:[e("Index size")],parent_type:["table","partition"],canDrop:!0,canDropCascade:!0,url_jump_after_node:"schema",Init:function(){this.initialized||(this.initialized=!0,l.add_menus([{name:"create_primary_key_on_coll",node:"coll-constraints",module:this,applies:["object","context"],callback:"show_obj_properties",category:"create",priority:4,label:e("Primary key"),icon:"wcTabIcon icon-primary_key",data:{action:"create",check:!0},enable:"canCreate"}]))},canCreate:function(e,t,o){if(o&&0==o.check)return!0;for(var a=l.tree,r=t,s=e,d=[],c=!1,p=!1,u=this.getTreeNodeHierarchy(r).server.version;r;){if(c||"table"!=s._type&&"partition"!=s._type||(c=!0,"is_partitioned"in s&&s.is_partitioned&&u<11e4&&(p=!0)),n.indexOf(["schema"],s._type)>-1){if(p)return!1;var m=a.children(arguments[1],!1),h=!1;return n.each(m,(function(e){o=l.tree.itemData(i(e)),h||"primary_key"!=o._type||(h=!0)})),!h}d.push(s._type),s=(r=a.hasParent(r)?a.parent(r):null)?a.itemData(r):null}return!(n.indexOf(d,"catalog")>-1)&&!p},model:o.Browser.Node.Model.extend({idAttribute:"oid",defaults:{name:void 0,oid:void 0,comment:void 0,spcname:void 0,index:void 0,fillfactor:void 0,condeferrable:void 0,condeferred:void 0,columns:[],include:[]},schema:[{id:"name",label:e("Name"),type:"text",mode:["properties","create","edit"],editable:!0,cellHeaderClasses:"width_percent_40"},{id:"oid",label:e("OID"),cell:"string",type:"text",mode:["properties"],editable:!1,cellHeaderClasses:"width_percent_20"},{id:"comment",label:e("Comment"),cell:"string",type:"multiline",mode:["properties","create","edit"],deps:["name"],disabled:function(e){var t=e.get("name");return(!t||""==t)&&(setTimeout((function(){e.get("comment")&&""!==e.get("comment")&&e.set("comment",null)}),10),!0)}},{id:"columns",label:e("Columns"),type:"collection",group:e("Definition"),editable:!1,cell:r.StringCell.extend({initialize:function(){r.StringCell.prototype.initialize.apply(this,arguments);var e=this,t=this.model.get("columns");if(n.isUndefined(e.model.get("oid"))){var i=e.model.top.get("columns");e.listenTo(i,"remove",e.removeColumn),e.listenTo(i,"change:name",e.resetColOptions)}t.on("pgadmin:multicolumn:updated",(function(){e.render.apply(e)})),e.listenTo(t,"add",e.render),e.listenTo(t,"remove",e.render)},removeColumn:function(e){var t=this,i=t.model.get("columns").where({column:e.get("name")});t.model.get("columns").remove(i),setTimeout((function(){t.render()}),10);setTimeout((function(){var e=t.model.top.get("primary_key"),i=[];e.each((function(e){0==e.get("columns").length&&i.push(e)})),e.remove(i)}),100)},resetColOptions:function(e){var t=this,i=t.model.get("columns").where({column:e.previous("name")});i.length>0&&i[0].set({column:e.get("name")},{silent:!0}),setTimeout((function(){t.render()}),10)},formatter:{fromRaw:function(e){return e.pluck("column").toString()},toRaw:function(e){return e}},render:function(){return r.StringCell.prototype.render.apply(this,arguments)},remove:function(){var e=this.model.top.get("columns"),t=this.model.get("columns");t&&t.off("pgadmin:multicolumn:updated"),this.stopListening(e,"remove",self.removeColumn),this.stopListening(e,"change:name",self.resetColOptions),r.StringCell.prototype.remove.apply(this,arguments)}}),canDelete:!0,canAdd:!0,control:a.MultiSelectAjaxControl.extend({defaults:n.extend({},a.NodeListByNameControl.prototype.defaults,{select2:{multiple:!0,allowClear:!0,width:"style",placeholder:e("Select the column(s)")}}),keyPathAccessor:function(e,t){var i=e;if(n.isArray(i))return n.map(i,(function(e){return e.column}));t=t.split(".");for(var o=0;o<t.length;o++){if(n.isNull(i))return null;n.isEmpty(t[o])||(n.isUndefined(i[t[o]])||(i=i[t[o]]))}return n.isObject(i)&&!n.isArray(i)?null:i},initialize:function(){var e=this;if(this.model.handler){if(a.Select2Control.prototype.initialize.apply(this,arguments),n.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}else a.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments);e.model.get("columns").on("pgadmin:multicolumn:updated",(function(){e.render.apply(e)}))},resetColOptions:function(){var e=this;setTimeout((function(){e.custom_options(),e.render.apply(e)}),50)},custom_options:function(){var e=this.model.top.get("columns"),t=[];e.length>0&&n.each(e.models,(function(e){var i=e.get("name");n.isUndefined(i)||n.isNull(i)||t.push({label:i,value:i,image:"icon-column"})})),this.field.set("options",t)},onChange:function(){var e=this,t=this.model,i=this.field.get("name").split(".").shift(),o=this.getValueFromDOM(),l=t.get(i),a=[];this.stopListening(this.model,"change:"+i,this.render),l.each((function(e){var t=e.get("column"),i=n.indexOf(o,t);i>-1?o.splice(i,1):a.push(t)})),n.each(o,(function(t){var i=new(e.field.get("model"))({column:t},{silent:!0,top:e.model.top,collection:l,handler:l});l.add(i)})),n.each(a,(function(e){l.remove(l.where({column:e}))})),this.listenTo(this.model,"change:"+i,this.render)},remove:function(){if(this.model.handler){var e=this,t=e.model.top.get("columns");e.stopListening(t,"remove",e.resetColOptions),e.stopListening(t,"change:name",e.resetColOptions),e.model.get("columns").off("pgadmin:multicolumn:updated"),a.Select2Control.prototype.remove.apply(this,arguments)}else a.MultiSelectAjaxControl.prototype.remove.apply(this,arguments)}}),deps:["index"],node:"column",model:l.Node.Model.extend({defaults:{column:void 0},validate:function(){return null}}),transform:function(e){var t=[];return e&&n.isArray(e)&&n.each(e,(function(e){t.push({label:e.label,value:e.label,image:"icon-column"})})),t},select2:{allowClear:!1},readonly:function(e){return!n.has(e,"top")||n.isUndefined(e.top)||e.top.isNew()?!e.isNew()||void 0:!n.isUndefined(e.get("oid"))},disabled:function(e){var t=e.get("index");return!n.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)}},{id:"include",label:e("Include columns"),type:"array",group:e("Definition"),editable:!1,canDelete:!0,canAdd:!0,mode:["properties","create","edit"],visible:function(e){return e=e.top,!n.isUndefined(e.node_info)&&!n.isUndefined(e.node_info.server)&&!n.isUndefined(e.node_info.server.version)&&e.node_info.server.version>=11e4},control:a.MultiSelectAjaxControl.extend({defaults:n.extend({},a.NodeListByNameControl.prototype.defaults,{select2:{allowClear:!1,width:"style",multiple:!0,placeholder:e("Select the column(s)")}}),initialize:function(){var e=this;if(this.model.handler){if(a.Select2Control.prototype.initialize.apply(this,arguments),n.isUndefined(e.model.get("oid"))){var t=e.model.top.get("columns");e.listenTo(t,"remove",e.resetColOptions),e.listenTo(t,"change:name",e.resetColOptions)}e.custom_options()}else a.MultiSelectAjaxControl.prototype.initialize.apply(this,arguments)},resetColOptions:function(){var e=this;setTimeout((function(){e.custom_options(),e.render.apply(e)}),50)},custom_options:function(){var e=this.model.top.get("columns"),t=[];e.length>0&&n.each(e.models,(function(e){var i=e.get("name");n.isUndefined(i)||n.isNull(i)||t.push({label:i,value:i,image:"icon-column"})})),this.field.set("options",t)}}),deps:["index"],node:"column",readonly:function(e){return!n.has(e,"top")||n.isUndefined(e.top)||e.top.isNew()?!e.isNew()||void 0:!n.isUndefined(e.get("oid"))},disabled:function(e){var t=e.get("index");return!n.isUndefined(t)&&""!=t&&(e.get("columns").reset(),!0)}},{id:"spcname",label:e("Tablespace"),type:"text",group:e("Definition"),control:"node-list-by-name",node:"tablespace",deps:["index"],select2:{allowClear:!1},filter:function(e){return"pg_global"!=e.label},disabled:function(e){var t=(e=e.top||e).get("index");return!n.isUndefined(t)&&""!=t&&(setTimeout((function(){e.set("spcname","")}),10),!0)}},{id:"index",label:e("Index"),mode:["create"],type:"text",group:e("Definition"),control:a.NodeListByNameControl.extend({initialize:function(){a.NodeListByNameControl.prototype.initialize.apply(this,arguments)}}),select2:{allowClear:!0},node:"index",readonly:function(e){return!(!n.has(e,"top")||n.isUndefined(e.top)||e.top.isNew())||!e.isNew()},visible:function(e){return!n.isUndefined(e.top.node_info.table)}},{id:"fillfactor",label:e("Fill factor"),deps:["index"],type:"int",group:e("Definition"),allowNull:!0,disabled:function(e){var t=e.get("index");return!n.isUndefined(t)&&""!=t&&(setTimeout((function(){e.set("fillfactor",null)}),10),!0)}},{id:"condeferrable",label:e("Deferrable?"),type:"switch",group:e("Definition"),deps:["index"],readonly:function(e){return!n.has(e,"top")||n.isUndefined(e.top)||e.top.isNew()?!e.isNew()||void 0:!n.isUndefined(e.get("oid"))},disabled:function(e){var t=e.get("index");return!n.isUndefined(t)&&""!=t&&(setTimeout((function(){e.get("condeferrable")&&e.set("condeferrable",!1)}),10),!0)}},{id:"condeferred",label:e("Deferred?"),type:"switch",group:e("Definition"),deps:["condeferrable"],readonly:function(e){return!n.has(e,"top")||n.isUndefined(e.top)||e.top.isNew()?!e.isNew()||void 0:!n.isUndefined(e.get("oid"))},disabled:function(e){return 1!=e.get("condeferrable")&&(setTimeout((function(){e.get("condeferred")&&e.set("condeferred",!1)}),10),!0)}}],validate:function(){this.errorModel.clear(),n.has(this,"top")&&this.top.errorModel.clear();var t=this.get("columns"),i=this.get("index");if((n.isUndefined(i)||""==String(i).replace(/^\s+|\s+$/g,""))&&(n.isUndefined(t)||n.isNull(t)||t.length<1)){var o=e("Please specify columns for %s",e("Primary key"));return this.errorModel.set("columns",o),o}return null}})})),l.Nodes.primary_key}.apply(t,n))||(e.exports=o)},64:function(e,t,i){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i(19),i(26),i(27),i(17),i(4),i(31),i(12),i(23),i(44),i(20),Object.defineProperty(t,"__esModule",{value:!0}),t.SchemaChildNode=void 0;var o=r(i(81)),l=r(i(45));function a(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return a=function(){return e},e}function r(e){if(e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var r=o?Object.getOwnPropertyDescriptor(e,l):null;r&&(r.get||r.set)?Object.defineProperty(i,l,r):i[l]=e[l]}return i.default=e,t&&t.set(e,i),i}var s=o.extend({parent_type:["schema","catalog"],canDrop:l.isTreeItemOfChildOfSchema,canDropCascade:l.isTreeItemOfChildOfSchema,canCreate:l.childCreateMenuEnabled},!1);t.SchemaChildNode=s}}]);